<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Cozeå·¥ä½œæµåˆ†æ | SwimmingLiu&#39;s Blog</title>
<meta name="keywords" content="Java">
<meta name="description" content="Cozeå·¥ä½œæµ-QA

å·¥ä½œæµå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªå¤§æ¿å—ï¼šå·¥ä½œæµç®¡ç†Â (å‰åç«¯äº¤äº’-ç”»å¸ƒå­˜å‚¨)ã€å·¥ä½œæµæ ¡éªŒã€å·¥ä½œæµæ‰§è¡Œ
å·¥ä½œæµç®¡ç†

å¯¹äºå‰ç«¯æ¥è®²ï¼Œå·¥ä½œæµå°±æ˜¯ä¸€å¼ canvasç”»å¸ƒã€‚ç”¨æˆ·å¯ä»¥åœ¨ç”»å¸ƒä¸­ï¼Œåˆ›å»ºä¸åŒåŠŸèƒ½çš„èŠ‚ç‚¹ã€‚

èŠ‚ç‚¹ç±»å‹å¯ä»¥åˆ†ä¸ºï¼šå¼€å§‹å’Œç»“æŸèŠ‚ç‚¹Â ï¼ˆé»˜è®¤ï¼‰ã€LLMèŠ‚ç‚¹ã€å­å·¥ä½œæµÂ (åµŒå¥—)ã€æ’ä»¶Â (å¤–éƒ¨å·¥å…·-ä¾‹å¦‚MCPã€OCR)ã€ä¸šåŠ¡é€»è¾‘èŠ‚ç‚¹Â (é€‰æ‹©ã€å¾ªç¯ã€åˆ†ç±»ã€æ‰¹å¤„ç†(å¹¶å‘)ã€å˜é‡èšåˆ)ã€æ•°æ®åº“èŠ‚ç‚¹(SQLã€CRUD)ã€çŸ¥è¯†åº“èŠ‚ç‚¹(RAGã€å¢åˆ ã€å˜é‡èµ‹å€¼)ã€å›¾åƒå¤„ç†èŠ‚ç‚¹ã€éŸ³è§†é¢‘å¤„ç†èŠ‚ç‚¹ã€ç»„ä»¶(JSONåºåˆ—åŒ–ã€HTTPè¯·æ±‚)ã€å®šæ—¶è§¦å‘å™¨èŠ‚ç‚¹(å®šæ—¶è§¦å‘ä»»åŠ¡)
1.1Â å¦‚ä½•ä»ç”»å¸ƒè½¬æˆä¸€ä¸ªç±»ï¼Ÿ
å‰ç«¯çš„ç”»å¸ƒé‡‡ç”¨DSLÂ (JSON)Â å½¢å¼å­˜å‚¨ï¼Œæ¯æ¬¡æ›´æ–°ç”»å¸ƒéƒ½æ˜¯å°†DSLä¼ ç»™åç«¯ã€‚DSLçš„åç«¯ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸»è¦åŒ…å«èŠ‚ç‚¹Â (node)ã€Â è¾¹Â (edge)ã€Â ç‰ˆæœ¬
type Canvas struct {
	Nodes    []*Node `json:&#34;nodes&#34;`
	Edges    []*Edge `json:&#34;edges&#34;`
	Versions any     `json:&#34;versions&#34;`
}
1.1.1Â èŠ‚ç‚¹æ•°æ®
ç”»å¸ƒä¸­çš„èŠ‚ç‚¹ä¼šè½¬æ¢ä¸ºåç«¯ä¸­Â backend/domain/workflow/entity/vo/canvas.goÂ ä¸­çš„Â NodeÂ ç»“æ„ä½“ï¼ŒÂ åç«¯å­˜å‚¨çš„ç»“æ„ä½“å¦‚ä¸‹
// Node å·¥ä½œæµèŠ‚ç‚¹çš„å®Œæ•´å®šä¹‰
// èŠ‚ç‚¹æ˜¯å·¥ä½œæµçš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½æˆ–æ“ä½œ
type Node struct {
    // èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåœ¨ç”»å¸ƒä¸­å®šä½å’Œå¼•ç”¨èŠ‚ç‚¹
	ID      string    `json:&#34;id&#34;` 
    // èŠ‚ç‚¹ç±»å‹ï¼Œå†³å®šèŠ‚ç‚¹çš„åŠŸèƒ½å’Œè¡Œä¸ºï¼ˆå¦‚LLMã€APIè°ƒç”¨ã€æ¡ä»¶åˆ¤æ–­ç­‰ï¼‰
	Type    BlockType `json:&#34;type&#34;`
    // èŠ‚ç‚¹çš„å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒ…å«å‰ç«¯æ˜¾ç¤ºç›¸å…³çš„é…ç½® (å‰ç«¯çš„ä¸€äº›extendInfo)
	Meta    any       `json:&#34;meta&#34;`
    // èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®ï¼ŒåŒ…å«è¾“å…¥è¾“å‡ºé…ç½®å’Œå…·ä½“å‚æ•°ï¼Œä¾‹å¦‚LLMçš„é…ç½®ã€MCPçš„é…ç½®ã€å¼‚å¸¸å¤„ç†
	Data    *Data     `json:&#34;data&#34;`
    // å­èŠ‚ç‚¹åˆ—è¡¨ï¼Œç”¨äºå¤åˆèŠ‚ç‚¹ï¼ˆå¦‚å¾ªç¯ã€æ¡ä»¶åˆ†æ”¯ï¼‰çš„åµŒå¥—ç»“æ„
	Blocks  []*Node   `json:&#34;blocks,omitempty&#34;`
    // èŠ‚ç‚¹å†…éƒ¨çš„è¿çº¿ï¼Œç”¨äºå¤æ‚èŠ‚ç‚¹çš„å†…éƒ¨é€»è¾‘è¿æ¥
	Edges   []*Edge   `json:&#34;edges,omitempty&#34;`
    // èŠ‚ç‚¹çš„ç‰ˆæœ¬å·ï¼Œç”¨äºèŠ‚ç‚¹å®šä¹‰çš„ç‰ˆæœ¬æ§åˆ¶
	Version string    `json:&#34;version,omitempty&#34;` 
    // çˆ¶èŠ‚ç‚¹å¼•ç”¨ï¼Œä¸åºåˆ—åŒ–åˆ°JSONï¼Œç”¨äºå†…å­˜ä¸­çš„æ ‘å½¢ç»“æ„å¯¼èˆª
	parent *Node 
}
èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®Dataå¦‚ä¸‹æ‰€ç¤º
type Data struct {
    // èŠ‚ç‚¹çš„æ˜¾ç¤ºå…ƒæ•°æ®ï¼Œå¦‚æ ‡é¢˜ã€iconç­‰
	Meta    *NodeMeta `json:&#34;nodeMeta,omitempty&#34;`
    // èŠ‚ç‚¹çš„è¾“å‡ºå®šä¹‰ï¼Œå¯ä»¥æ˜¯ []*Variable æˆ– []*Param ç±»å‹
	Outputs []any     `json:&#34;outputs,omitempty&#34;`
    // èŠ‚ç‚¹çš„è¾“å…¥é…ç½®ï¼ŒåŒ…å«æ‰€æœ‰è¾“å…¥å‚æ•°å’Œè®¾ç½®
	Inputs  *Inputs   `json:&#34;inputs,omitempty&#34;`
    // èŠ‚ç‚¹åœ¨ç”»å¸ƒä¸Šçš„å°ºå¯¸ä¿¡æ¯ï¼Œç”¨äºå‰ç«¯æ˜¾ç¤º
	Size    any       `json:&#34;size,omitempty&#34;`     
}
èŠ‚ç‚¹çš„è¾“å…¥å‚æ•°Â inputs">
<meta name="author" content="SwimmingLiu">
<link rel="canonical" href="https://swimmingliu.cn/posts/job/coze-workflow-analysis/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6ecbb0040febd20e47edd88a662c19f1ea945bf7427774b86594271d18f88faf.css" integrity="sha256-bsuwBA/r0g5H7diKZiwZ8eqUW/dCd3S4ZZQnHRj4j68=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="apple-touch-icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="mask-icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://swimmingliu.cn/posts/job/coze-workflow-analysis/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            
            
            delimiters: [
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false },
                { left: '\\(', right: '\\)', display: false },
                { left: '\\[', right: '\\]', display: true }
            ],
            
            throwOnError: false
        });
    });
</script>

<meta property="og:url" content="https://swimmingliu.cn/posts/job/coze-workflow-analysis/">
  <meta property="og:site_name" content="SwimmingLiu&#39;s Blog">
  <meta property="og:title" content="Cozeå·¥ä½œæµåˆ†æ">
  <meta property="og:description" content="Cozeå·¥ä½œæµ-QA å·¥ä½œæµå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªå¤§æ¿å—ï¼šå·¥ä½œæµç®¡ç†Â (å‰åç«¯äº¤äº’-ç”»å¸ƒå­˜å‚¨)ã€å·¥ä½œæµæ ¡éªŒã€å·¥ä½œæµæ‰§è¡Œ
å·¥ä½œæµç®¡ç† å¯¹äºå‰ç«¯æ¥è®²ï¼Œå·¥ä½œæµå°±æ˜¯ä¸€å¼ canvasç”»å¸ƒã€‚ç”¨æˆ·å¯ä»¥åœ¨ç”»å¸ƒä¸­ï¼Œåˆ›å»ºä¸åŒåŠŸèƒ½çš„èŠ‚ç‚¹ã€‚
èŠ‚ç‚¹ç±»å‹å¯ä»¥åˆ†ä¸ºï¼šå¼€å§‹å’Œç»“æŸèŠ‚ç‚¹Â ï¼ˆé»˜è®¤ï¼‰ã€LLMèŠ‚ç‚¹ã€å­å·¥ä½œæµÂ (åµŒå¥—)ã€æ’ä»¶Â (å¤–éƒ¨å·¥å…·-ä¾‹å¦‚MCPã€OCR)ã€ä¸šåŠ¡é€»è¾‘èŠ‚ç‚¹Â (é€‰æ‹©ã€å¾ªç¯ã€åˆ†ç±»ã€æ‰¹å¤„ç†(å¹¶å‘)ã€å˜é‡èšåˆ)ã€æ•°æ®åº“èŠ‚ç‚¹(SQLã€CRUD)ã€çŸ¥è¯†åº“èŠ‚ç‚¹(RAGã€å¢åˆ ã€å˜é‡èµ‹å€¼)ã€å›¾åƒå¤„ç†èŠ‚ç‚¹ã€éŸ³è§†é¢‘å¤„ç†èŠ‚ç‚¹ã€ç»„ä»¶(JSONåºåˆ—åŒ–ã€HTTPè¯·æ±‚)ã€å®šæ—¶è§¦å‘å™¨èŠ‚ç‚¹(å®šæ—¶è§¦å‘ä»»åŠ¡)
1.1Â å¦‚ä½•ä»ç”»å¸ƒè½¬æˆä¸€ä¸ªç±»ï¼Ÿ å‰ç«¯çš„ç”»å¸ƒé‡‡ç”¨DSLÂ (JSON)Â å½¢å¼å­˜å‚¨ï¼Œæ¯æ¬¡æ›´æ–°ç”»å¸ƒéƒ½æ˜¯å°†DSLä¼ ç»™åç«¯ã€‚DSLçš„åç«¯ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸»è¦åŒ…å«èŠ‚ç‚¹Â (node)ã€Â è¾¹Â (edge)ã€Â ç‰ˆæœ¬
type Canvas struct { Nodes []*Node `json:&#34;nodes&#34;` Edges []*Edge `json:&#34;edges&#34;` Versions any `json:&#34;versions&#34;` } 1.1.1Â èŠ‚ç‚¹æ•°æ® ç”»å¸ƒä¸­çš„èŠ‚ç‚¹ä¼šè½¬æ¢ä¸ºåç«¯ä¸­Â backend/domain/workflow/entity/vo/canvas.goÂ ä¸­çš„Â NodeÂ ç»“æ„ä½“ï¼ŒÂ åç«¯å­˜å‚¨çš„ç»“æ„ä½“å¦‚ä¸‹
// Node å·¥ä½œæµèŠ‚ç‚¹çš„å®Œæ•´å®šä¹‰ // èŠ‚ç‚¹æ˜¯å·¥ä½œæµçš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½æˆ–æ“ä½œ type Node struct { // èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåœ¨ç”»å¸ƒä¸­å®šä½å’Œå¼•ç”¨èŠ‚ç‚¹ ID string `json:&#34;id&#34;` // èŠ‚ç‚¹ç±»å‹ï¼Œå†³å®šèŠ‚ç‚¹çš„åŠŸèƒ½å’Œè¡Œä¸ºï¼ˆå¦‚LLMã€APIè°ƒç”¨ã€æ¡ä»¶åˆ¤æ–­ç­‰ï¼‰ Type BlockType `json:&#34;type&#34;` // èŠ‚ç‚¹çš„å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒ…å«å‰ç«¯æ˜¾ç¤ºç›¸å…³çš„é…ç½® (å‰ç«¯çš„ä¸€äº›extendInfo) Meta any `json:&#34;meta&#34;` // èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®ï¼ŒåŒ…å«è¾“å…¥è¾“å‡ºé…ç½®å’Œå…·ä½“å‚æ•°ï¼Œä¾‹å¦‚LLMçš„é…ç½®ã€MCPçš„é…ç½®ã€å¼‚å¸¸å¤„ç† Data *Data `json:&#34;data&#34;` // å­èŠ‚ç‚¹åˆ—è¡¨ï¼Œç”¨äºå¤åˆèŠ‚ç‚¹ï¼ˆå¦‚å¾ªç¯ã€æ¡ä»¶åˆ†æ”¯ï¼‰çš„åµŒå¥—ç»“æ„ Blocks []*Node `json:&#34;blocks,omitempty&#34;` // èŠ‚ç‚¹å†…éƒ¨çš„è¿çº¿ï¼Œç”¨äºå¤æ‚èŠ‚ç‚¹çš„å†…éƒ¨é€»è¾‘è¿æ¥ Edges []*Edge `json:&#34;edges,omitempty&#34;` // èŠ‚ç‚¹çš„ç‰ˆæœ¬å·ï¼Œç”¨äºèŠ‚ç‚¹å®šä¹‰çš„ç‰ˆæœ¬æ§åˆ¶ Version string `json:&#34;version,omitempty&#34;` // çˆ¶èŠ‚ç‚¹å¼•ç”¨ï¼Œä¸åºåˆ—åŒ–åˆ°JSONï¼Œç”¨äºå†…å­˜ä¸­çš„æ ‘å½¢ç»“æ„å¯¼èˆª parent *Node } èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®Dataå¦‚ä¸‹æ‰€ç¤º
type Data struct { // èŠ‚ç‚¹çš„æ˜¾ç¤ºå…ƒæ•°æ®ï¼Œå¦‚æ ‡é¢˜ã€iconç­‰ Meta *NodeMeta `json:&#34;nodeMeta,omitempty&#34;` // èŠ‚ç‚¹çš„è¾“å‡ºå®šä¹‰ï¼Œå¯ä»¥æ˜¯ []*Variable æˆ– []*Param ç±»å‹ Outputs []any `json:&#34;outputs,omitempty&#34;` // èŠ‚ç‚¹çš„è¾“å…¥é…ç½®ï¼ŒåŒ…å«æ‰€æœ‰è¾“å…¥å‚æ•°å’Œè®¾ç½® Inputs *Inputs `json:&#34;inputs,omitempty&#34;` // èŠ‚ç‚¹åœ¨ç”»å¸ƒä¸Šçš„å°ºå¯¸ä¿¡æ¯ï¼Œç”¨äºå‰ç«¯æ˜¾ç¤º Size any `json:&#34;size,omitempty&#34;` } èŠ‚ç‚¹çš„è¾“å…¥å‚æ•°Â inputs">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-07T23:27:35+08:00">
    <meta property="article:modified_time" content="2025-08-07T23:27:35+08:00">
    <meta property="article:tag" content="Java">
      <meta property="og:image" content="https://swimmingliu.cn/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://swimmingliu.cn/papermod-cover.png">
<meta name="twitter:title" content="Cozeå·¥ä½œæµåˆ†æ">
<meta name="twitter:description" content="Cozeå·¥ä½œæµ-QA

å·¥ä½œæµå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªå¤§æ¿å—ï¼šå·¥ä½œæµç®¡ç†Â (å‰åç«¯äº¤äº’-ç”»å¸ƒå­˜å‚¨)ã€å·¥ä½œæµæ ¡éªŒã€å·¥ä½œæµæ‰§è¡Œ
å·¥ä½œæµç®¡ç†

å¯¹äºå‰ç«¯æ¥è®²ï¼Œå·¥ä½œæµå°±æ˜¯ä¸€å¼ canvasç”»å¸ƒã€‚ç”¨æˆ·å¯ä»¥åœ¨ç”»å¸ƒä¸­ï¼Œåˆ›å»ºä¸åŒåŠŸèƒ½çš„èŠ‚ç‚¹ã€‚

èŠ‚ç‚¹ç±»å‹å¯ä»¥åˆ†ä¸ºï¼šå¼€å§‹å’Œç»“æŸèŠ‚ç‚¹Â ï¼ˆé»˜è®¤ï¼‰ã€LLMèŠ‚ç‚¹ã€å­å·¥ä½œæµÂ (åµŒå¥—)ã€æ’ä»¶Â (å¤–éƒ¨å·¥å…·-ä¾‹å¦‚MCPã€OCR)ã€ä¸šåŠ¡é€»è¾‘èŠ‚ç‚¹Â (é€‰æ‹©ã€å¾ªç¯ã€åˆ†ç±»ã€æ‰¹å¤„ç†(å¹¶å‘)ã€å˜é‡èšåˆ)ã€æ•°æ®åº“èŠ‚ç‚¹(SQLã€CRUD)ã€çŸ¥è¯†åº“èŠ‚ç‚¹(RAGã€å¢åˆ ã€å˜é‡èµ‹å€¼)ã€å›¾åƒå¤„ç†èŠ‚ç‚¹ã€éŸ³è§†é¢‘å¤„ç†èŠ‚ç‚¹ã€ç»„ä»¶(JSONåºåˆ—åŒ–ã€HTTPè¯·æ±‚)ã€å®šæ—¶è§¦å‘å™¨èŠ‚ç‚¹(å®šæ—¶è§¦å‘ä»»åŠ¡)
1.1Â å¦‚ä½•ä»ç”»å¸ƒè½¬æˆä¸€ä¸ªç±»ï¼Ÿ
å‰ç«¯çš„ç”»å¸ƒé‡‡ç”¨DSLÂ (JSON)Â å½¢å¼å­˜å‚¨ï¼Œæ¯æ¬¡æ›´æ–°ç”»å¸ƒéƒ½æ˜¯å°†DSLä¼ ç»™åç«¯ã€‚DSLçš„åç«¯ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸»è¦åŒ…å«èŠ‚ç‚¹Â (node)ã€Â è¾¹Â (edge)ã€Â ç‰ˆæœ¬
type Canvas struct {
	Nodes    []*Node `json:&#34;nodes&#34;`
	Edges    []*Edge `json:&#34;edges&#34;`
	Versions any     `json:&#34;versions&#34;`
}
1.1.1Â èŠ‚ç‚¹æ•°æ®
ç”»å¸ƒä¸­çš„èŠ‚ç‚¹ä¼šè½¬æ¢ä¸ºåç«¯ä¸­Â backend/domain/workflow/entity/vo/canvas.goÂ ä¸­çš„Â NodeÂ ç»“æ„ä½“ï¼ŒÂ åç«¯å­˜å‚¨çš„ç»“æ„ä½“å¦‚ä¸‹
// Node å·¥ä½œæµèŠ‚ç‚¹çš„å®Œæ•´å®šä¹‰
// èŠ‚ç‚¹æ˜¯å·¥ä½œæµçš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½æˆ–æ“ä½œ
type Node struct {
    // èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåœ¨ç”»å¸ƒä¸­å®šä½å’Œå¼•ç”¨èŠ‚ç‚¹
	ID      string    `json:&#34;id&#34;` 
    // èŠ‚ç‚¹ç±»å‹ï¼Œå†³å®šèŠ‚ç‚¹çš„åŠŸèƒ½å’Œè¡Œä¸ºï¼ˆå¦‚LLMã€APIè°ƒç”¨ã€æ¡ä»¶åˆ¤æ–­ç­‰ï¼‰
	Type    BlockType `json:&#34;type&#34;`
    // èŠ‚ç‚¹çš„å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒ…å«å‰ç«¯æ˜¾ç¤ºç›¸å…³çš„é…ç½® (å‰ç«¯çš„ä¸€äº›extendInfo)
	Meta    any       `json:&#34;meta&#34;`
    // èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®ï¼ŒåŒ…å«è¾“å…¥è¾“å‡ºé…ç½®å’Œå…·ä½“å‚æ•°ï¼Œä¾‹å¦‚LLMçš„é…ç½®ã€MCPçš„é…ç½®ã€å¼‚å¸¸å¤„ç†
	Data    *Data     `json:&#34;data&#34;`
    // å­èŠ‚ç‚¹åˆ—è¡¨ï¼Œç”¨äºå¤åˆèŠ‚ç‚¹ï¼ˆå¦‚å¾ªç¯ã€æ¡ä»¶åˆ†æ”¯ï¼‰çš„åµŒå¥—ç»“æ„
	Blocks  []*Node   `json:&#34;blocks,omitempty&#34;`
    // èŠ‚ç‚¹å†…éƒ¨çš„è¿çº¿ï¼Œç”¨äºå¤æ‚èŠ‚ç‚¹çš„å†…éƒ¨é€»è¾‘è¿æ¥
	Edges   []*Edge   `json:&#34;edges,omitempty&#34;`
    // èŠ‚ç‚¹çš„ç‰ˆæœ¬å·ï¼Œç”¨äºèŠ‚ç‚¹å®šä¹‰çš„ç‰ˆæœ¬æ§åˆ¶
	Version string    `json:&#34;version,omitempty&#34;` 
    // çˆ¶èŠ‚ç‚¹å¼•ç”¨ï¼Œä¸åºåˆ—åŒ–åˆ°JSONï¼Œç”¨äºå†…å­˜ä¸­çš„æ ‘å½¢ç»“æ„å¯¼èˆª
	parent *Node 
}
èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®Dataå¦‚ä¸‹æ‰€ç¤º
type Data struct {
    // èŠ‚ç‚¹çš„æ˜¾ç¤ºå…ƒæ•°æ®ï¼Œå¦‚æ ‡é¢˜ã€iconç­‰
	Meta    *NodeMeta `json:&#34;nodeMeta,omitempty&#34;`
    // èŠ‚ç‚¹çš„è¾“å‡ºå®šä¹‰ï¼Œå¯ä»¥æ˜¯ []*Variable æˆ– []*Param ç±»å‹
	Outputs []any     `json:&#34;outputs,omitempty&#34;`
    // èŠ‚ç‚¹çš„è¾“å…¥é…ç½®ï¼ŒåŒ…å«æ‰€æœ‰è¾“å…¥å‚æ•°å’Œè®¾ç½®
	Inputs  *Inputs   `json:&#34;inputs,omitempty&#34;`
    // èŠ‚ç‚¹åœ¨ç”»å¸ƒä¸Šçš„å°ºå¯¸ä¿¡æ¯ï¼Œç”¨äºå‰ç«¯æ˜¾ç¤º
	Size    any       `json:&#34;size,omitempty&#34;`     
}
èŠ‚ç‚¹çš„è¾“å…¥å‚æ•°Â inputs">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "ğŸ“š Posts",
      "item": "https://swimmingliu.cn/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ’» Job",
      "item": "https://swimmingliu.cn/posts/job/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Cozeå·¥ä½œæµåˆ†æ",
      "item": "https://swimmingliu.cn/posts/job/coze-workflow-analysis/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Cozeå·¥ä½œæµåˆ†æ",
  "name": "Cozeå·¥ä½œæµåˆ†æ",
  "description": "Cozeå·¥ä½œæµ-QA å·¥ä½œæµå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªå¤§æ¿å—ï¼šå·¥ä½œæµç®¡ç†Â (å‰åç«¯äº¤äº’-ç”»å¸ƒå­˜å‚¨)ã€å·¥ä½œæµæ ¡éªŒã€å·¥ä½œæµæ‰§è¡Œ\nå·¥ä½œæµç®¡ç† å¯¹äºå‰ç«¯æ¥è®²ï¼Œå·¥ä½œæµå°±æ˜¯ä¸€å¼ canvasç”»å¸ƒã€‚ç”¨æˆ·å¯ä»¥åœ¨ç”»å¸ƒä¸­ï¼Œåˆ›å»ºä¸åŒåŠŸèƒ½çš„èŠ‚ç‚¹ã€‚\nèŠ‚ç‚¹ç±»å‹å¯ä»¥åˆ†ä¸ºï¼šå¼€å§‹å’Œç»“æŸèŠ‚ç‚¹Â ï¼ˆé»˜è®¤ï¼‰ã€LLMèŠ‚ç‚¹ã€å­å·¥ä½œæµÂ (åµŒå¥—)ã€æ’ä»¶Â (å¤–éƒ¨å·¥å…·-ä¾‹å¦‚MCPã€OCR)ã€ä¸šåŠ¡é€»è¾‘èŠ‚ç‚¹Â (é€‰æ‹©ã€å¾ªç¯ã€åˆ†ç±»ã€æ‰¹å¤„ç†(å¹¶å‘)ã€å˜é‡èšåˆ)ã€æ•°æ®åº“èŠ‚ç‚¹(SQLã€CRUD)ã€çŸ¥è¯†åº“èŠ‚ç‚¹(RAGã€å¢åˆ ã€å˜é‡èµ‹å€¼)ã€å›¾åƒå¤„ç†èŠ‚ç‚¹ã€éŸ³è§†é¢‘å¤„ç†èŠ‚ç‚¹ã€ç»„ä»¶(JSONåºåˆ—åŒ–ã€HTTPè¯·æ±‚)ã€å®šæ—¶è§¦å‘å™¨èŠ‚ç‚¹(å®šæ—¶è§¦å‘ä»»åŠ¡)\n1.1Â å¦‚ä½•ä»ç”»å¸ƒè½¬æˆä¸€ä¸ªç±»ï¼Ÿ å‰ç«¯çš„ç”»å¸ƒé‡‡ç”¨DSLÂ (JSON)Â å½¢å¼å­˜å‚¨ï¼Œæ¯æ¬¡æ›´æ–°ç”»å¸ƒéƒ½æ˜¯å°†DSLä¼ ç»™åç«¯ã€‚DSLçš„åç«¯ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸»è¦åŒ…å«èŠ‚ç‚¹Â (node)ã€Â è¾¹Â (edge)ã€Â ç‰ˆæœ¬\ntype Canvas struct { Nodes []*Node `json:\u0026#34;nodes\u0026#34;` Edges []*Edge `json:\u0026#34;edges\u0026#34;` Versions any `json:\u0026#34;versions\u0026#34;` } 1.1.1Â èŠ‚ç‚¹æ•°æ® ç”»å¸ƒä¸­çš„èŠ‚ç‚¹ä¼šè½¬æ¢ä¸ºåç«¯ä¸­Â backend/domain/workflow/entity/vo/canvas.goÂ ä¸­çš„Â NodeÂ ç»“æ„ä½“ï¼ŒÂ åç«¯å­˜å‚¨çš„ç»“æ„ä½“å¦‚ä¸‹\n// Node å·¥ä½œæµèŠ‚ç‚¹çš„å®Œæ•´å®šä¹‰ // èŠ‚ç‚¹æ˜¯å·¥ä½œæµçš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½æˆ–æ“ä½œ type Node struct { // èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåœ¨ç”»å¸ƒä¸­å®šä½å’Œå¼•ç”¨èŠ‚ç‚¹ ID string `json:\u0026#34;id\u0026#34;` // èŠ‚ç‚¹ç±»å‹ï¼Œå†³å®šèŠ‚ç‚¹çš„åŠŸèƒ½å’Œè¡Œä¸ºï¼ˆå¦‚LLMã€APIè°ƒç”¨ã€æ¡ä»¶åˆ¤æ–­ç­‰ï¼‰ Type BlockType `json:\u0026#34;type\u0026#34;` // èŠ‚ç‚¹çš„å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒ…å«å‰ç«¯æ˜¾ç¤ºç›¸å…³çš„é…ç½® (å‰ç«¯çš„ä¸€äº›extendInfo) Meta any `json:\u0026#34;meta\u0026#34;` // èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®ï¼ŒåŒ…å«è¾“å…¥è¾“å‡ºé…ç½®å’Œå…·ä½“å‚æ•°ï¼Œä¾‹å¦‚LLMçš„é…ç½®ã€MCPçš„é…ç½®ã€å¼‚å¸¸å¤„ç† Data *Data `json:\u0026#34;data\u0026#34;` // å­èŠ‚ç‚¹åˆ—è¡¨ï¼Œç”¨äºå¤åˆèŠ‚ç‚¹ï¼ˆå¦‚å¾ªç¯ã€æ¡ä»¶åˆ†æ”¯ï¼‰çš„åµŒå¥—ç»“æ„ Blocks []*Node `json:\u0026#34;blocks,omitempty\u0026#34;` // èŠ‚ç‚¹å†…éƒ¨çš„è¿çº¿ï¼Œç”¨äºå¤æ‚èŠ‚ç‚¹çš„å†…éƒ¨é€»è¾‘è¿æ¥ Edges []*Edge `json:\u0026#34;edges,omitempty\u0026#34;` // èŠ‚ç‚¹çš„ç‰ˆæœ¬å·ï¼Œç”¨äºèŠ‚ç‚¹å®šä¹‰çš„ç‰ˆæœ¬æ§åˆ¶ Version string `json:\u0026#34;version,omitempty\u0026#34;` // çˆ¶èŠ‚ç‚¹å¼•ç”¨ï¼Œä¸åºåˆ—åŒ–åˆ°JSONï¼Œç”¨äºå†…å­˜ä¸­çš„æ ‘å½¢ç»“æ„å¯¼èˆª parent *Node } èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®Dataå¦‚ä¸‹æ‰€ç¤º\ntype Data struct { // èŠ‚ç‚¹çš„æ˜¾ç¤ºå…ƒæ•°æ®ï¼Œå¦‚æ ‡é¢˜ã€iconç­‰ Meta *NodeMeta `json:\u0026#34;nodeMeta,omitempty\u0026#34;` // èŠ‚ç‚¹çš„è¾“å‡ºå®šä¹‰ï¼Œå¯ä»¥æ˜¯ []*Variable æˆ– []*Param ç±»å‹ Outputs []any `json:\u0026#34;outputs,omitempty\u0026#34;` // èŠ‚ç‚¹çš„è¾“å…¥é…ç½®ï¼ŒåŒ…å«æ‰€æœ‰è¾“å…¥å‚æ•°å’Œè®¾ç½® Inputs *Inputs `json:\u0026#34;inputs,omitempty\u0026#34;` // èŠ‚ç‚¹åœ¨ç”»å¸ƒä¸Šçš„å°ºå¯¸ä¿¡æ¯ï¼Œç”¨äºå‰ç«¯æ˜¾ç¤º Size any `json:\u0026#34;size,omitempty\u0026#34;` } èŠ‚ç‚¹çš„è¾“å…¥å‚æ•°Â inputs\n",
  "keywords": [
    "Java"
  ],
  "articleBody": "Cozeå·¥ä½œæµ-QA å·¥ä½œæµå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªå¤§æ¿å—ï¼šå·¥ä½œæµç®¡ç†Â (å‰åç«¯äº¤äº’-ç”»å¸ƒå­˜å‚¨)ã€å·¥ä½œæµæ ¡éªŒã€å·¥ä½œæµæ‰§è¡Œ\nå·¥ä½œæµç®¡ç† å¯¹äºå‰ç«¯æ¥è®²ï¼Œå·¥ä½œæµå°±æ˜¯ä¸€å¼ canvasç”»å¸ƒã€‚ç”¨æˆ·å¯ä»¥åœ¨ç”»å¸ƒä¸­ï¼Œåˆ›å»ºä¸åŒåŠŸèƒ½çš„èŠ‚ç‚¹ã€‚\nèŠ‚ç‚¹ç±»å‹å¯ä»¥åˆ†ä¸ºï¼šå¼€å§‹å’Œç»“æŸèŠ‚ç‚¹Â ï¼ˆé»˜è®¤ï¼‰ã€LLMèŠ‚ç‚¹ã€å­å·¥ä½œæµÂ (åµŒå¥—)ã€æ’ä»¶Â (å¤–éƒ¨å·¥å…·-ä¾‹å¦‚MCPã€OCR)ã€ä¸šåŠ¡é€»è¾‘èŠ‚ç‚¹Â (é€‰æ‹©ã€å¾ªç¯ã€åˆ†ç±»ã€æ‰¹å¤„ç†(å¹¶å‘)ã€å˜é‡èšåˆ)ã€æ•°æ®åº“èŠ‚ç‚¹(SQLã€CRUD)ã€çŸ¥è¯†åº“èŠ‚ç‚¹(RAGã€å¢åˆ ã€å˜é‡èµ‹å€¼)ã€å›¾åƒå¤„ç†èŠ‚ç‚¹ã€éŸ³è§†é¢‘å¤„ç†èŠ‚ç‚¹ã€ç»„ä»¶(JSONåºåˆ—åŒ–ã€HTTPè¯·æ±‚)ã€å®šæ—¶è§¦å‘å™¨èŠ‚ç‚¹(å®šæ—¶è§¦å‘ä»»åŠ¡)\n1.1Â å¦‚ä½•ä»ç”»å¸ƒè½¬æˆä¸€ä¸ªç±»ï¼Ÿ å‰ç«¯çš„ç”»å¸ƒé‡‡ç”¨DSLÂ (JSON)Â å½¢å¼å­˜å‚¨ï¼Œæ¯æ¬¡æ›´æ–°ç”»å¸ƒéƒ½æ˜¯å°†DSLä¼ ç»™åç«¯ã€‚DSLçš„åç«¯ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸»è¦åŒ…å«èŠ‚ç‚¹Â (node)ã€Â è¾¹Â (edge)ã€Â ç‰ˆæœ¬\ntype Canvas struct { Nodes []*Node `json:\"nodes\"` Edges []*Edge `json:\"edges\"` Versions any `json:\"versions\"` } 1.1.1Â èŠ‚ç‚¹æ•°æ® ç”»å¸ƒä¸­çš„èŠ‚ç‚¹ä¼šè½¬æ¢ä¸ºåç«¯ä¸­Â backend/domain/workflow/entity/vo/canvas.goÂ ä¸­çš„Â NodeÂ ç»“æ„ä½“ï¼ŒÂ åç«¯å­˜å‚¨çš„ç»“æ„ä½“å¦‚ä¸‹\n// Node å·¥ä½œæµèŠ‚ç‚¹çš„å®Œæ•´å®šä¹‰ // èŠ‚ç‚¹æ˜¯å·¥ä½œæµçš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½æˆ–æ“ä½œ type Node struct { // èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåœ¨ç”»å¸ƒä¸­å®šä½å’Œå¼•ç”¨èŠ‚ç‚¹ ID string `json:\"id\"` // èŠ‚ç‚¹ç±»å‹ï¼Œå†³å®šèŠ‚ç‚¹çš„åŠŸèƒ½å’Œè¡Œä¸ºï¼ˆå¦‚LLMã€APIè°ƒç”¨ã€æ¡ä»¶åˆ¤æ–­ç­‰ï¼‰ Type BlockType `json:\"type\"` // èŠ‚ç‚¹çš„å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒ…å«å‰ç«¯æ˜¾ç¤ºç›¸å…³çš„é…ç½® (å‰ç«¯çš„ä¸€äº›extendInfo) Meta any `json:\"meta\"` // èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®ï¼ŒåŒ…å«è¾“å…¥è¾“å‡ºé…ç½®å’Œå…·ä½“å‚æ•°ï¼Œä¾‹å¦‚LLMçš„é…ç½®ã€MCPçš„é…ç½®ã€å¼‚å¸¸å¤„ç† Data *Data `json:\"data\"` // å­èŠ‚ç‚¹åˆ—è¡¨ï¼Œç”¨äºå¤åˆèŠ‚ç‚¹ï¼ˆå¦‚å¾ªç¯ã€æ¡ä»¶åˆ†æ”¯ï¼‰çš„åµŒå¥—ç»“æ„ Blocks []*Node `json:\"blocks,omitempty\"` // èŠ‚ç‚¹å†…éƒ¨çš„è¿çº¿ï¼Œç”¨äºå¤æ‚èŠ‚ç‚¹çš„å†…éƒ¨é€»è¾‘è¿æ¥ Edges []*Edge `json:\"edges,omitempty\"` // èŠ‚ç‚¹çš„ç‰ˆæœ¬å·ï¼Œç”¨äºèŠ‚ç‚¹å®šä¹‰çš„ç‰ˆæœ¬æ§åˆ¶ Version string `json:\"version,omitempty\"` // çˆ¶èŠ‚ç‚¹å¼•ç”¨ï¼Œä¸åºåˆ—åŒ–åˆ°JSONï¼Œç”¨äºå†…å­˜ä¸­çš„æ ‘å½¢ç»“æ„å¯¼èˆª parent *Node } èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®Dataå¦‚ä¸‹æ‰€ç¤º\ntype Data struct { // èŠ‚ç‚¹çš„æ˜¾ç¤ºå…ƒæ•°æ®ï¼Œå¦‚æ ‡é¢˜ã€iconç­‰ Meta *NodeMeta `json:\"nodeMeta,omitempty\"` // èŠ‚ç‚¹çš„è¾“å‡ºå®šä¹‰ï¼Œå¯ä»¥æ˜¯ []*Variable æˆ– []*Param ç±»å‹ Outputs []any `json:\"outputs,omitempty\"` // èŠ‚ç‚¹çš„è¾“å…¥é…ç½®ï¼ŒåŒ…å«æ‰€æœ‰è¾“å…¥å‚æ•°å’Œè®¾ç½® Inputs *Inputs `json:\"inputs,omitempty\"` // èŠ‚ç‚¹åœ¨ç”»å¸ƒä¸Šçš„å°ºå¯¸ä¿¡æ¯ï¼Œç”¨äºå‰ç«¯æ˜¾ç¤º Size any `json:\"size,omitempty\"` } èŠ‚ç‚¹çš„è¾“å…¥å‚æ•°Â inputs\n// Inputs èŠ‚ç‚¹è¾“å…¥é…ç½®çš„ç»¼åˆç»“æ„ // è¿™æ˜¯ä¸€ä¸ªè”åˆç»“æ„ï¼ŒåŒ…å«äº†æ‰€æœ‰å¯èƒ½çš„èŠ‚ç‚¹è¾“å…¥é…ç½®ï¼Œä¸åŒç±»å‹çš„èŠ‚ç‚¹ä½¿ç”¨ä¸åŒçš„å­—æ®µå­é›† type Inputs struct { // é€šç”¨è¾“å…¥é…ç½® InputParameters []*Param `json:\"inputParameters\"` // èŠ‚ç‚¹çš„è¾“å…¥å‚æ•°åˆ—è¡¨ï¼Œå®šä¹‰èŠ‚ç‚¹éœ€è¦çš„æ•°æ®è¾“å…¥ Content *BlockInput `json:\"content\"` // èŠ‚ç‚¹çš„ä¸»è¦å†…å®¹è¾“å…¥ï¼Œé€šå¸¸ç”¨äºæ–‡æœ¬å¤„ç†æˆ–æç¤ºè¯ TerminatePlan *TerminatePlan `json:\"terminatePlan,omitempty\"` // ç»ˆæ­¢è®¡åˆ’ï¼Œå®šä¹‰èŠ‚ç‚¹å®Œæˆåçš„è¡Œä¸º StreamingOutput bool `json:\"streamingOutput,omitempty\"` // æ˜¯å¦å¯ç”¨æµå¼è¾“å‡ºï¼Œç”¨äºå®æ—¶è¿”å›å¤„ç†ç»“æœ CallTransferVoice bool `json:\"callTransferVoice,omitempty\"` // è¯­éŸ³é€šè¯è½¬æ¥è®¾ç½®ï¼Œç”¨äºè¯­éŸ³ç›¸å…³èŠ‚ç‚¹ ChatHistoryWriting string `json:\"chatHistoryWriting,omitempty\"` // èŠå¤©å†å²è®°å½•å†™å…¥é…ç½® LLMParam any `json:\"llmParam,omitempty\"` // LLMå‚æ•°ï¼Œå¯èƒ½æ˜¯LLMParamã€IntentDetectorLLMParamæˆ–QALLMParamç±»å‹ FCParam *FCParam `json:\"fcParam,omitempty\"` // åŠŸèƒ½è°ƒç”¨å‚æ•°ï¼Œç”¨äºé…ç½®å·¥ä½œæµã€æ’ä»¶æˆ–çŸ¥è¯†åº“çš„è°ƒç”¨ SettingOnError *SettingOnError `json:\"settingOnError,omitempty\"` // é”™è¯¯å¤„ç†é…ç½®ï¼Œå®šä¹‰èŠ‚ç‚¹å‡ºé”™æ—¶çš„å¤„ç†ç­–ç•¥ // å¾ªç¯æ§åˆ¶ç›¸å…³ LoopType LoopType `json:\"loopType,omitempty\"` // å¾ªç¯ç±»å‹ï¼šæ•°ç»„å¾ªç¯ã€è®¡æ•°å¾ªç¯æˆ–æ— é™å¾ªç¯ LoopCount *BlockInput `json:\"loopCount,omitempty\"` // å¾ªç¯æ¬¡æ•°ï¼Œç”¨äºè®¡æ•°å¾ªç¯ VariableParameters []*Param `json:\"variableParameters,omitempty\"` // å¾ªç¯å˜é‡å‚æ•° // æ¡ä»¶åˆ†æ”¯ç›¸å…³ Branches []*struct { Condition struct { Logic LogicType `json:\"logic\"` // æ¡ä»¶é€»è¾‘ï¼šANDæˆ–OR Conditions []*Condition `json:\"conditions\"` // å…·ä½“çš„æ¡ä»¶åˆ—è¡¨ } `json:\"condition\"` } `json:\"branches,omitempty\"` // åˆ†æ”¯æ¡ä»¶é…ç½®ï¼Œç”¨äºæ¡ä»¶åˆ¤æ–­èŠ‚ç‚¹ // æ‰¹å¤„ç†é…ç½® NodeBatchInfo *NodeBatch `json:\"batch,omitempty\"` // èŠ‚ç‚¹æ‰¹å¤„ç†æ¨¡å¼é…ç½® // ç‰¹å®šèŠ‚ç‚¹ç±»å‹çš„é…ç½®ï¼ˆä½¿ç”¨åµŒå…¥ç»“æ„ä½“å®ç°ç±»å‹å¤šæ€ï¼‰ *TextProcessor // æ–‡æœ¬å¤„ç†å™¨é…ç½®ï¼šæ‹¼æ¥ã€åˆ†å‰²ç­‰æ“ä½œ *SubWorkflow // å­å·¥ä½œæµé…ç½®ï¼šè°ƒç”¨å…¶ä»–å·¥ä½œæµ *IntentDetector // æ„å›¾æ£€æµ‹é…ç½®ï¼šè¯†åˆ«ç”¨æˆ·æ„å›¾ *DatabaseNode // æ•°æ®åº“æ“ä½œé…ç½®ï¼šå¢åˆ æ”¹æŸ¥ *HttpRequestNode // HTTPè¯·æ±‚é…ç½®ï¼šAPIè°ƒç”¨ *KnowledgeIndexer // çŸ¥è¯†åº“ç´¢å¼•é…ç½®ï¼šæ–‡æ¡£å¤„ç†å’Œç´¢å¼• *CodeRunner // ä»£ç æ‰§è¡Œå™¨é…ç½®ï¼šè¿è¡Œè‡ªå®šä¹‰ä»£ç  *PluginAPIParam // æ’ä»¶APIå‚æ•°é…ç½® *VariableAggregator // å˜é‡èšåˆå™¨é…ç½®ï¼šåˆå¹¶å¤šä¸ªå˜é‡ *VariableAssigner // å˜é‡èµ‹å€¼å™¨é…ç½®ï¼šè®¾ç½®å˜é‡å€¼ *QA // é—®ç­”èŠ‚ç‚¹é…ç½®ï¼šå¤„ç†é—®é¢˜å’Œç­”æ¡ˆ *Batch // æ‰¹å¤„ç†é…ç½®ï¼šæ‰¹é‡å¤„ç†æ•°æ® *Comment // æ³¨é‡ŠèŠ‚ç‚¹é…ç½®ï¼šæ·»åŠ è¯´æ˜æ–‡å­— OutputSchema string `json:\"outputSchema,omitempty\"` // è¾“å‡ºæ¨¡å¼å®šä¹‰ï¼Œæè¿°èŠ‚ç‚¹è¾“å‡ºæ•°æ®çš„ç»“æ„ } 1.1.2Â è¾¹æ•°æ® è¾¹ä¸»è¦æ˜¯åŒ…å«è¾“å…¥èŠ‚ç‚¹ã€è¾“å‡ºèŠ‚ç‚¹çš„IDï¼Œè¿˜æœ‰è¾“å…¥çš„ç«¯å£å’Œè¾“å‡ºçš„ç«¯å£Â ï¼ˆè¾“å…¥è¾“å‡ºç«¯å£éƒ½æ˜¯åªå­˜åœ¨äºä¸šåŠ¡é€»è¾‘èŠ‚ç‚¹ä¸­ï¼‰\n// Edge å·¥ä½œæµè¿çº¿å®šä¹‰ // è¿çº¿å®šä¹‰äº†èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥å…³ç³»ï¼Œç¡®å®šå·¥ä½œæµçš„æ‰§è¡Œé¡ºåºå’Œæ•°æ®æµå‘ type Edge struct { // æºèŠ‚ç‚¹IDï¼Œè¿çº¿çš„èµ·å§‹èŠ‚ç‚¹ SourceNodeID string `json:\"sourceNodeID\"` // ç›®æ ‡èŠ‚ç‚¹IDï¼Œè¿çº¿çš„ç»ˆæ­¢èŠ‚ç‚¹ TargetNodeID string `json:\"targetNodeID\"` // æºç«¯å£IDï¼Œç”¨äºå¤šè¾“å‡ºç«¯å£çš„èŠ‚ç‚¹ï¼ŒæŒ‡å®šå…·ä½“çš„è¾“å‡ºç«¯å£ SourcePortID string `json:\"sourcePortID,omitempty\"` // ç›®æ ‡ç«¯å£IDï¼Œç”¨äºå¤šè¾“å…¥ç«¯å£çš„èŠ‚ç‚¹ï¼ŒæŒ‡å®šå…·ä½“çš„è¾“å…¥ç«¯å£ TargetPortID string `json:\"targetPortID,omitempty\"` } 1.1.3Â å¤§è¯­è¨€æ¨¡å‹èŠ‚ç‚¹Â (NoteTypeLLM) LLMèŠ‚ç‚¹ç±»å›¾å¦‚ä¸‹å›¾æ‰€ç¤º classDiagram class Inputs { +Param[] inputParameters +SettingOnError settingOnError +NodeBatch nodeBatchInfo +any llmParam +LLM llmSpecificConfig } class LLM { +FCParam fcParam } class LLMParam { +Param[] parameters } class SimpleLLMParam { +string generationDiversity +int maxTokens +string modelName +int64 modelType +ResponseFormat responseFormat +string systemPrompt +float64 temperature +float64 topP } class Param { +string name +BlockInput input +BlockInput left +BlockInput right +BlockInput[] variables } class BlockInput { +VariableType type +AssistType assistType +any schema +BlockInputValue value } class BlockInputValue { +BlockInputValueType type +any content +any rawMeta } class BlockInputReference { +string blockID +string name +string[] path +RefSourceType source } class FCParam { +WorkflowFCParam workflowFCParam +PluginFCParam pluginFCParam +KnowledgeFCParam knowledgeFCParam } class SettingOnError { +ErrorHandlingStrategy strategy +string customMessage } class NodeBatch { +int batchSize +int concurrentSize } Inputs --\u003e LLM : \"contains\" Inputs --\u003e LLMParam : \"llmParam as\" Inputs --\u003e SimpleLLMParam : \"llmParam as\" Inputs --\u003e Param : \"contains\" Inputs --\u003e SettingOnError : \"contains\" Inputs --\u003e NodeBatch : \"contains\" LLM --\u003e FCParam : \"contains\" LLMParam --\u003e Param : \"contains\" Param --\u003e BlockInput : \"contains\" BlockInput --\u003e BlockInputValue : \"contains\" BlockInputValue --\u003e BlockInputReference : \"content as\" note for Inputs \"LLMèŠ‚ç‚¹çš„æ‰€æœ‰è¾“å…¥é…ç½®åŒ…å«é€šç”¨è¾“å…¥å’ŒLLMä¸“ç”¨é…ç½®\" note for LLMParam \"æ ‡å‡†LLMå‚æ•°åˆ—è¡¨æ¯ä¸ªå‚æ•°éƒ½æ˜¯Paramç±»å‹\" note for SimpleLLMParam \"ç®€åŒ–çš„LLMå‚æ•°ç»“æ„ç›´æ¥åŒ…å«æ‰€æœ‰LLMé…ç½®å­—æ®µ\" note for FCParam \"å‡½æ•°è°ƒç”¨èƒ½åŠ›é…ç½®LLMå¯è°ƒç”¨çš„å¤–éƒ¨å·¥å…·\" LLMå‚æ•°Â -Â SimpleLLMParam SimpleLLMParamå¦‚ä¸‹æ‰€ç¤ºï¼Œä¸»è¦åŒ…å«å¤šæ ·æ€§ç¨‹åº¦ã€æœ€å¤§Tokenã€æ¨¡å‹åç§°ã€æ¨¡å‹ç±»å‹ã€å“åº”æ ¼å¼ã€ç³»ç»Ÿæç¤ºè¯ã€Temperatureæ¸©åº¦ã€TopPÂ æ ¸é‡‡æ ·å‚æ•°\nã€æ³¨æ„ã€‘generationDiversityå¤šæ ·æ€§ç¨‹åº¦Â æ˜¯é«˜å±‚çš„é¢„è®¾ç­–ç•¥ï¼ˆå¦‚\"åˆ›æ„/å¹³è¡¡/ç²¾ç¡®\"æ¨¡å¼ï¼‰ï¼Œè€ŒÂ temperatureå’ŒÂ topPæ˜¯åº•å±‚çš„å…·ä½“ç®—æ³•å‚æ•°ï¼Œå‰è€…é€šè¿‡å†…ç½®çš„å‚æ•°ç»„åˆæ¥ç®€åŒ–é…ç½®ï¼Œåè€…åˆ™æä¾›ç²¾ç¡®çš„éšæœºæ€§æ§åˆ¶ï¼ˆtemperatureè°ƒèŠ‚æ¦‚ç‡åˆ†å¸ƒå¹³æ»‘åº¦ï¼ŒtopPé™åˆ¶å€™é€‰è¯æ±‡èŒƒå›´ï¼‰ã€‚\nç®€å•è¯´ï¼šgenerationDiversityÂ =Â â€œæˆ‘è¦ä»€ä¹ˆé£æ ¼â€ï¼ŒtemperatureÂ =Â â€œè¦å¤šéšæœºâ€ï¼ŒtopPÂ =Â â€œè€ƒè™‘å¤šå°‘è¯æ±‡â€ã€‚\n// SimpleLLMParam ç®€åŒ–çš„å¤§è¯­è¨€æ¨¡å‹å‚æ•°é…ç½® // æä¾›ç›´æ¥çš„å­—æ®µæ˜ å°„æ–¹å¼é…ç½®LLMå‚æ•°ï¼Œé€‚ç”¨äºç®€å•çš„æ¨¡å‹è°ƒç”¨åœºæ™¯ type SimpleLLMParam struct { // GenerationDiversity ç”Ÿæˆå¤šæ ·æ€§é…ç½® // æ§åˆ¶æ¨¡å‹è¾“å‡ºçš„å¤šæ ·æ€§ç¨‹åº¦ï¼Œå½±å“ç”Ÿæˆå†…å®¹çš„åˆ›æ–°æ€§ GenerationDiversity string `json:\"generationDiversity\"` // MaxTokens æœ€å¤§ç”Ÿæˆä»¤ç‰Œæ•° // é™åˆ¶æ¨¡å‹å•æ¬¡ç”Ÿæˆçš„æœ€å¤§tokenæ•°é‡ï¼Œæ§åˆ¶è¾“å‡ºé•¿åº¦ MaxTokens int `json:\"maxTokens\"` // ModelName æ¨¡å‹åç§° // æŒ‡å®šè¦ä½¿ç”¨çš„å…·ä½“æ¨¡å‹åç§°ï¼Œå¦‚gpt-3.5-turboã€gpt-4ç­‰ ModelName string `json:\"modelName\"` // ModelType æ¨¡å‹ç±»å‹æ ‡è¯† // ç”¨äºåŒºåˆ†ä¸åŒç±»å‹çš„æ¨¡å‹ï¼Œå¦‚èŠå¤©æ¨¡å‹ã€è¡¥å…¨æ¨¡å‹ç­‰ ModelType int64 `json:\"modelType\"` // ResponseFormat å“åº”æ ¼å¼é…ç½® // æŒ‡å®šæ¨¡å‹è¾“å‡ºçš„æ ¼å¼ï¼Œæ”¯æŒæ–‡æœ¬ã€JSONã€Markdownç­‰æ ¼å¼ ResponseFormat model.ResponseFormat `json:\"responseFormat\"` // SystemPrompt ç³»ç»Ÿæç¤ºè¯ // å®šä¹‰æ¨¡å‹çš„ç³»ç»Ÿçº§æŒ‡ä»¤ï¼Œè®¾å®šæ¨¡å‹çš„è§’è‰²å’Œè¡Œä¸ºè§„èŒƒ SystemPrompt string `json:\"systemPrompt\"` // Temperature æ¸©åº¦å‚æ•° // æ§åˆ¶æ¨¡å‹è¾“å‡ºçš„éšæœºæ€§ï¼ŒèŒƒå›´é€šå¸¸ä¸º0.0-1.0ï¼Œå€¼è¶Šé«˜è¾“å‡ºè¶Šéšæœº // é€šè¿‡è°ƒæ•´softmaxæ¦‚ç‡åˆ†å¸ƒçš„å¹³æ»‘åº¦æ¥å½±å“è¯æ±‡é€‰æ‹©çš„ç¡®å®šæ€§ Temperature float64 `json:\"temperature\"` // TopP æ ¸é‡‡æ ·å‚æ•° // æ§åˆ¶æ¨¡å‹ç”Ÿæˆæ—¶è€ƒè™‘çš„è¯æ±‡æ¦‚ç‡è´¨é‡ï¼Œå½±å“è¾“å‡ºçš„å¤šæ ·æ€§å’Œè´¨é‡ // é€šè¿‡è®¾ç½®æ¦‚ç‡ç´¯ç§¯é˜ˆå€¼æ¥é™åˆ¶å€™é€‰è¯æ±‡çš„èŒƒå›´ï¼ŒèŒƒå›´é€šå¸¸ä¸º0.0-1.0 TopP float64 `json:\"topP\"` } LLMä¸­çš„å‡½æ•°è°ƒç”¨å‚æ•°Â **FcParam** functionCallingÂ ï¼ˆå¤§è¯­è¨€æ¨¡å‹èŠ‚ç‚¹çš„â€œæŠ€èƒ½â€ï¼‰ä¸­éœ€è¦ç”¨åˆ°çš„å‚æ•°\ngraph TD A[ç”¨æˆ·è¾“å…¥é—®é¢˜] --\u003e B[LLMèŠ‚ç‚¹æ¥æ”¶] B --\u003e C{LLMåˆ†ææ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·} C --\u003e|éœ€è¦è°ƒç”¨| D[FCParam å·¥å…·é…ç½®] C --\u003e|ä¸éœ€è¦| E[ç›´æ¥ç”Ÿæˆå›ç­”] D --\u003e F[WorkflowFCParamå­å·¥ä½œæµè°ƒç”¨] D --\u003e G[PluginFCParamæ’ä»¶APIè°ƒç”¨] D --\u003e H[KnowledgeFCParamçŸ¥è¯†åº“æ£€ç´¢] F --\u003e F1[é…ç½®å¯è°ƒç”¨çš„å­å·¥ä½œæµåˆ—è¡¨] F --\u003e F2[å®šä¹‰è¯·æ±‚/å“åº”å‚æ•°] F --\u003e F3[æ‰§è¡Œå­å·¥ä½œæµ] G --\u003e G1[é…ç½®å¯è°ƒç”¨çš„æ’ä»¶APIåˆ—è¡¨] G --\u003e G2[å®šä¹‰APIå‚æ•°å’Œå“åº”æ ¼å¼] G --\u003e G3[è°ƒç”¨ç¬¬ä¸‰æ–¹æ’ä»¶æœåŠ¡] H --\u003e H1[é…ç½®çŸ¥è¯†åº“åˆ—è¡¨] H --\u003e H2[è®¾ç½®æ£€ç´¢ç­–ç•¥TopK/MinScore/æœç´¢æ¨¡å¼] H --\u003e H3[æ‰§è¡ŒçŸ¥è¯†åº“æ£€ç´¢] F3 --\u003e I[å·¥å…·æ‰§è¡Œç»“æœ] G3 --\u003e I H3 --\u003e I I --\u003e J[LLMæ•´åˆå·¥å…·ç»“æœ] J --\u003e K[ç”Ÿæˆæœ€ç»ˆå›ç­”] E --\u003e K K --\u003e L[è¿”å›ç»™ç”¨æˆ·] style A fill:#e1f5fe style D fill:#fff3e0 style F fill:#f3e5f5 style G fill:#e8f5e8 style H fill:#fce4ec style K fill:#e0f2f1 å‡½æ•°è°ƒç”¨å‚æ•°Â FcParamä¸»è¦åŒ…å«ä¸‰ç§æ¨¡å¼ï¼šå­å·¥ä½œæµè°ƒç”¨ã€æ’ä»¶APIè°ƒç”¨ã€çŸ¥è¯†åº“æ£€ç´¢\n// FCParam å‡½æ•°è°ƒç”¨å‚æ•°é…ç½® // ç”¨äºé…ç½®å·¥ä½œæµä¸­ä¸åŒç±»å‹çš„å‡½æ•°è°ƒç”¨èƒ½åŠ›ï¼ŒåŒ…æ‹¬å­å·¥ä½œæµè°ƒç”¨ã€æ’ä»¶APIè°ƒç”¨å’ŒçŸ¥è¯†åº“æ£€ç´¢è°ƒç”¨ type FCParam struct { // WorkflowFCParam å·¥ä½œæµå‡½æ•°è°ƒç”¨å‚æ•°é…ç½® // é…ç½®å½“å‰å·¥ä½œæµå¯ä»¥è°ƒç”¨çš„å­å·¥ä½œæµåˆ—è¡¨åŠå…¶å‚æ•°è®¾ç½® WorkflowFCParam *struct { // WorkflowList å¯è°ƒç”¨çš„å·¥ä½œæµåˆ—è¡¨ // æ¯ä¸ªå·¥ä½œæµé¡¹åŒ…å«å·¥ä½œæµæ ‡è¯†ã€ç‰ˆæœ¬ä¿¡æ¯å’Œå‡½æ•°è°ƒç”¨è®¾ç½® WorkflowList []struct { // WorkflowID å·¥ä½œæµå”¯ä¸€æ ‡è¯†ç¬¦ WorkflowID string `json:\"workflow_id\"` // WorkflowVersion å·¥ä½œæµç‰ˆæœ¬å· WorkflowVersion string `json:\"workflow_version\"` // PluginID å…³è”çš„æ’ä»¶IDï¼ˆå¦‚æœå·¥ä½œæµåŸºäºæ’ä»¶ï¼‰ PluginID string `json:\"plugin_id\"` // PluginVersion æ’ä»¶ç‰ˆæœ¬å· PluginVersion string `json:\"plugin_version\"` // IsDraft æ˜¯å¦ä¸ºè‰ç¨¿ç‰ˆæœ¬ IsDraft bool `json:\"is_draft\"` // FCSetting å‡½æ•°è°ƒç”¨è®¾ç½® // å®šä¹‰è°ƒç”¨è¯¥å·¥ä½œæµæ—¶çš„è¯·æ±‚å’Œå“åº”å‚æ•°ç»“æ„ FCSetting *struct { // RequestParameters è¯·æ±‚å‚æ•°åˆ—è¡¨ // å®šä¹‰è°ƒç”¨å·¥ä½œæµæ—¶éœ€è¦ä¼ å…¥çš„å‚æ•° RequestParameters []*workflow.APIParameter `json:\"request_params\"` // ResponseParameters å“åº”å‚æ•°åˆ—è¡¨ // å®šä¹‰å·¥ä½œæµæ‰§è¡Œå®Œæˆåè¿”å›çš„å‚æ•° ResponseParameters []*workflow.APIParameter `json:\"response_params\"` } `json:\"fc_setting,omitempty\"` } `json:\"workflowList,omitempty\"` } `json:\"workflowFCParam,omitempty\"` // PluginFCParam æ’ä»¶å‡½æ•°è°ƒç”¨å‚æ•°é…ç½® // é…ç½®å½“å‰å·¥ä½œæµå¯ä»¥è°ƒç”¨çš„æ’ä»¶APIåˆ—è¡¨åŠå…¶å‚æ•°è®¾ç½® PluginFCParam *struct { // PluginList å¯è°ƒç”¨çš„æ’ä»¶åˆ—è¡¨ // æ¯ä¸ªæ’ä»¶é¡¹åŒ…å«æ’ä»¶æ ‡è¯†ã€APIä¿¡æ¯å’Œå‡½æ•°è°ƒç”¨è®¾ç½® PluginList []struct { // PluginID æ’ä»¶å”¯ä¸€æ ‡è¯†ç¬¦ PluginID string `json:\"plugin_id\"` // ApiId APIæ¥å£å”¯ä¸€æ ‡è¯†ç¬¦ ApiId string `json:\"api_id\"` // ApiName APIæ¥å£åç§° ApiName string `json:\"api_name\"` // PluginVersion æ’ä»¶ç‰ˆæœ¬å· PluginVersion string `json:\"plugin_version\"` // IsDraft æ˜¯å¦ä¸ºè‰ç¨¿ç‰ˆæœ¬ IsDraft bool `json:\"is_draft\"` // FCSetting å‡½æ•°è°ƒç”¨è®¾ç½® // å®šä¹‰è°ƒç”¨è¯¥æ’ä»¶APIæ—¶çš„è¯·æ±‚å’Œå“åº”å‚æ•°ç»“æ„ FCSetting *struct { // RequestParameters è¯·æ±‚å‚æ•°åˆ—è¡¨ // å®šä¹‰è°ƒç”¨æ’ä»¶APIæ—¶éœ€è¦ä¼ å…¥çš„å‚æ•° RequestParameters []*workflow.APIParameter `json:\"request_params\"` // ResponseParameters å“åº”å‚æ•°åˆ—è¡¨ // å®šä¹‰æ’ä»¶APIæ‰§è¡Œå®Œæˆåè¿”å›çš„å‚æ•° ResponseParameters []*workflow.APIParameter `json:\"response_params\"` } `json:\"fc_setting,omitempty\"` } } `json:\"pluginFCParam,omitempty\"` // KnowledgeFCParam çŸ¥è¯†åº“å‡½æ•°è°ƒç”¨å‚æ•°é…ç½® // é…ç½®å½“å‰å·¥ä½œæµçš„çŸ¥è¯†åº“æ£€ç´¢åŠŸèƒ½åŠå…¶å…¨å±€è®¾ç½® KnowledgeFCParam *struct { // GlobalSetting çŸ¥è¯†åº“æ£€ç´¢å…¨å±€è®¾ç½® // å®šä¹‰çŸ¥è¯†åº“æ£€ç´¢çš„é€šç”¨é…ç½®å‚æ•° GlobalSetting *struct { // SearchMode æœç´¢æ¨¡å¼ // å®šä¹‰çŸ¥è¯†åº“æ£€ç´¢ä½¿ç”¨çš„æœç´¢ç®—æ³•æ¨¡å¼ SearchMode int64 `json:\"search_mode\"` // TopK è¿”å›ç»“æœæ•°é‡ // å®šä¹‰çŸ¥è¯†åº“æ£€ç´¢è¿”å›çš„æœ€å¤§ç»“æœæ•°é‡ TopK int64 `json:\"top_k\"` // MinScore æœ€å°ç›¸ä¼¼åº¦åˆ†æ•° // å®šä¹‰çŸ¥è¯†åº“æ£€ç´¢ç»“æœçš„æœ€å°ç›¸ä¼¼åº¦é˜ˆå€¼ MinScore float64 `json:\"min_score\"` // UseNL2SQL æ˜¯å¦å¯ç”¨è‡ªç„¶è¯­è¨€è½¬SQLåŠŸèƒ½ UseNL2SQL bool `json:\"use_nl2_sql\"` // UseRewrite æ˜¯å¦å¯ç”¨æŸ¥è¯¢é‡å†™åŠŸèƒ½ UseRewrite bool `json:\"use_rewrite\"` // UseRerank æ˜¯å¦å¯ç”¨ç»“æœé‡æ’åºåŠŸèƒ½ UseRerank bool `json:\"use_rerank\"` // NoRecallReplyCustomizePrompt æ— å¬å›ç»“æœæ—¶çš„è‡ªå®šä¹‰å›å¤æç¤ºè¯ NoRecallReplyCustomizePrompt string `json:\"no_recall_reply_customize_prompt\"` // NoRecallReplyMode æ— å¬å›ç»“æœæ—¶çš„å›å¤æ¨¡å¼ NoRecallReplyMode int64 `json:\"no_recall_reply_mode\"` } `json:\"global_setting,omitempty\"` // KnowledgeList å¯æ£€ç´¢çš„çŸ¥è¯†åº“åˆ—è¡¨ // å®šä¹‰å½“å‰å·¥ä½œæµå¯ä»¥æ£€ç´¢çš„çŸ¥è¯†åº“é›†åˆ KnowledgeList []*struct { // ID çŸ¥è¯†åº“å”¯ä¸€æ ‡è¯†ç¬¦ ID string `json:\"id\"` } `json:\"knowledgeList,omitempty\"` } `json:\"knowledgeFCParam,omitempty\"` } å­å·¥ä½œæµè°ƒç”¨ { \"workflowFCParam\": { \"workflowList\": [ { \"workflow_id\": \"7509120431183544356\", \"workflow_version\": \"v0.0.1\", \"plugin_id\": \"7509121334769795126\", \"is_draft\": false, \"fc_setting\": { \"request_params\": [...], // è°ƒç”¨å‚æ•° \"response_params\": [...] // è¿”å›å‚æ•° } } ] } } æ’ä»¶APIè°ƒç”¨ { \"pluginFCParam\": { \"pluginList\": [ { \"plugin_id\": \"7509353177339133952\", \"api_id\": \"7509353598782816256\", \"api_name\": \"å‘¨å…¬è§£æ¢¦\", \"plugin_version\": \"0\", \"fc_setting\": { \"request_params\": [ { \"name\": \"title\", \"desc\": \"æŸ¥è¯¢è§£æ¢¦æ ‡é¢˜ï¼Œä¾‹å¦‚ï¼šæ¢¦è§è›‡\", \"type\": 1, \"is_required\": true } ], \"response_params\": [...] } } ] } } çŸ¥è¯†åº“æ£€ç´¢ { \"knowledgeFCParam\": { \"knowledgeList\": [ { \"id\": \"7512369185624686592\", \"name\": \"æ—…æ¸¸æ™¯ç‚¹\" } ], \"global_setting\": { \"top_k\": 3, // \"min_score\": 0.5, \"search_mode\": 0, \"use_rerank\": true, \"use_rewrite\": true, \"use_nl2_sql\": true, \"no_recall_reply_mode\": 0, \"no_recall_reply_customize_prompt\": \"æŠ±æ­‰ï¼Œæ‚¨çš„é—®é¢˜è¶…å‡ºäº†æˆ‘çš„çŸ¥è¯†èŒƒå›´\" } } 1.1.4Â BlockInputç»“æ„ BlockInputæ˜¯å·¥ä½œæµç³»ç»Ÿä¸­çš„æ•°æ®ç»‘å®šæ ¸å¿ƒï¼Œå®ƒè§£å†³äº†ä¸€ä¸ªå…³é”®é—®é¢˜ï¼šå¦‚ä½•åœ¨å·¥ä½œæµèŠ‚ç‚¹ä¹‹é—´ä¼ é€’å’Œé…ç½®æ•°æ®ã€‚BlockInputÂ =Â \"è¿™ä¸ªè¾“å…¥æ¡†é‡Œæ”¾ä»€ä¹ˆæ•°æ®ï¼Œä»å“ªé‡Œæ¥\"\ngraph TD A[BlockInput å—è¾“å…¥é…ç½®] --\u003e B[Type: æ•°æ®ç±»å‹] A --\u003e C[AssistType: è¾…åŠ©ç±»å‹] A --\u003e D[Schema: ç»“æ„å®šä¹‰] A --\u003e E[Value: è¾“å…¥å€¼é…ç½®] E --\u003e F[BlockInputValue] F --\u003e G[Type: å€¼ç±»å‹] F --\u003e H[Content: å…·ä½“å†…å®¹] F --\u003e I[RawMeta: å…ƒæ•°æ®] G --\u003e G1[literal: å­—é¢å€¼] G --\u003e G2[ref: èŠ‚ç‚¹å¼•ç”¨] G --\u003e G3[object_ref: å¯¹è±¡å¼•ç”¨] H --\u003e H1[é™æ€æ–‡æœ¬/æ•°å€¼] H --\u003e H2[BlockInputReference] H2 --\u003e J[BlockID: æºèŠ‚ç‚¹ID] H2 --\u003e K[Name: å­—æ®µåç§°] H2 --\u003e L[Path: è®¿é—®è·¯å¾„] H2 --\u003e M[Source: å¼•ç”¨æºç±»å‹] M --\u003e M1[block-output: èŠ‚ç‚¹è¾“å‡º] M --\u003e M2[global_variable_app: åº”ç”¨å˜é‡] M --\u003e M3[global_variable_system: ç³»ç»Ÿå˜é‡] M --\u003e M4[global_variable_user: ç”¨æˆ·å˜é‡] N[å®é™…ä½¿ç”¨åœºæ™¯] --\u003e N1[é™æ€é…ç½®: å›ºå®šå€¼] N --\u003e N2[åŠ¨æ€ç»‘å®š: å¼•ç”¨å…¶ä»–èŠ‚ç‚¹] N --\u003e N3[æ¨¡æ¿æ¸²æŸ“: å˜é‡æ›¿æ¢] N --\u003e N4[å¤æ‚å¯¹è±¡: åµŒå¥—ç»“æ„] style A fill:#e1f5fe style F fill:#fff3e0 style H2 fill:#f3e5f5 style N fill:#e8f5e8 BlockInputç»“æ„å¦‚ä¸‹æ‰€ç¤º\ntype BlockInput struct { Type VariableType // æ•°æ®ç±»å‹ï¼šstringã€numberã€objectç­‰ AssistType AssistType // è¾…åŠ©ç±»å‹ï¼šæ›´å…·ä½“çš„ç±»å‹æè¿° Schema any // ç»“æ„å®šä¹‰ï¼šå¤æ‚å¯¹è±¡çš„å†…éƒ¨ç»“æ„ Value *BlockInputValue // å€¼é…ç½®ï¼šå…·ä½“çš„æ•°æ®æ¥æº } ä¸‰ç§æ•°æ®æµæ¥æºï¼šå¸¸é‡literalã€èŠ‚ç‚¹å¼•ç”¨refã€å¯¹è±¡å¼•ç”¨Â ObjectÂ Ref\nå¸¸é‡literal { \"type\": \"string\", \"value\": { \"type\": \"literal\", \"content\": \"Hello World\", \"rawMeta\": {\"type\": 1} } } èŠ‚ç‚¹å¼•ç”¨refÂ (æœ€å¸¸ç”¨çš„) { \"type\": \"string\", \"value\": { \"type\": \"ref\", \"content\": { \"blockID\": \"100001\", \"name\": \"output\", \"source\": \"block-output\" } } } å¯¹è±¡å¼•ç”¨ { \"type\": \"object\", \"schema\": [{\"name\": \"name\", \"type\": \"string\"}], \"value\": { \"type\": \"object_ref\", \"content\": { \"blockID\": \"100001\", \"name\": \"person\", \"source\": \"block-output\" } } } 1.1.5Â çŸ¥è¯†åº“èŠ‚ç‚¹Â (RAG) RAGå®Œæ•´æµç¨‹å›¾ ä¸€ä¸ªå®Œæ•´çš„RAGæµç¨‹å¦‚ä¸‹ï¼š\næŸ¥è¯¢é‡å†™ä¼˜åŒ–Â ï¼ˆå°æ¨¡å‹ï¼‰-\u003eÂ è‡ªç„¶è¯­è¨€è½¬SQLÂ ï¼ˆNL2SQLï¼‰-\u003eÂ å‘é‡æ£€ç´¢Â (è¯­ä¹‰æœç´¢/æ··åˆæœç´¢/å…¨é‡æœç´¢)Â -\u003eÂ ç›¸ä¼¼åº¦è¿‡æ»¤Â (æœ€å°ç›¸ä¼¼åº¦é˜ˆå€¼)Â -\u003eÂ ç»“æœé‡æ’åºÂ (Rerank)Â -\u003eÂ TopKç»“æœæˆªå–Â -\u003eÂ æ„å»ºæ–°çš„ä¸Šä¸‹æ–‡æç¤ºè¯\ngraph LR A[ç”¨æˆ·è¾“å…¥æŸ¥è¯¢] --\u003e B[æŸ¥è¯¢é¢„å¤„ç†] B --\u003e B1[UseRewrite: æŸ¥è¯¢é‡å†™] B1 --\u003e B2[ä¼˜åŒ–æŸ¥è¯¢è¯­ä¹‰] B2 --\u003e B3[UseNL2SQL: è‡ªç„¶è¯­è¨€è½¬SQL] B3 --\u003e C[å‘é‡æ£€ç´¢é˜¶æ®µ] C --\u003e C1[æ–‡æ¡£å‘é‡åŒ–] C --\u003e C2[æŸ¥è¯¢å‘é‡åŒ–] C1 --\u003e C3[å‘é‡ç›¸ä¼¼åº¦è®¡ç®—] C2 --\u003e C3 C3 --\u003e D[SearchMode: æœç´¢ç­–ç•¥] D --\u003e D1[0: è¯­ä¹‰æœç´¢Semantic Search] D --\u003e D2[1: æ··åˆæœç´¢Hybrid Search] D --\u003e D3[20: å…¨æ–‡æœç´¢Full-text Search] D1 --\u003e E[åˆæ­¥ç»“æœç­›é€‰] D2 --\u003e E D3 --\u003e E E --\u003e E1[MinScore: ç›¸ä¼¼åº¦è¿‡æ»¤] E1 --\u003e E2[è¿‡æ»¤ä½è´¨é‡ç»“æœ] E2 --\u003e F[UseRerank: ç»“æœé‡æ’åº] F --\u003e F1[æ·±åº¦è¯­ä¹‰åŒ¹é…] F1 --\u003e F2[é‡æ–°æ’åºç»“æœ] F2 --\u003e G[TopK: ç»“æœæˆªå–] G --\u003e G1[é€‰æ‹©å‰Kä¸ªæœ€ä½³ç»“æœ] G1 --\u003e H{æ˜¯å¦æœ‰åˆé€‚ç»“æœ?} H --\u003e|æœ‰| I[æ„å»ºå¢å¼ºä¸Šä¸‹æ–‡] H --\u003e|æ— | J[NoRecallReplyModeå¤„ç†] J --\u003e J1[0: ä½¿ç”¨è‡ªå®šä¹‰æç¤ºè¯] J --\u003e J2[1: å…¶ä»–å¤„ç†æ¨¡å¼] J1 --\u003e K[è¿”å›æ— ç»“æœå›å¤] J2 --\u003e K I --\u003e L[RAGç”Ÿæˆé˜¶æ®µ] L --\u003e L1[ç»„åˆæŸ¥è¯¢+æ£€ç´¢å†…å®¹] L1 --\u003e L2[LLMç”Ÿæˆå¢å¼ºå›ç­”] L2 --\u003e M[è¿”å›æœ€ç»ˆç­”æ¡ˆ] K --\u003e M style A fill:#e1f5fe style B fill:#fff3e0 style C fill:#f3e5f5 style D fill:#e8f5e8 style F fill:#fce4ec style L fill:#e0f2f1 å‘é‡æ£€ç´¢è§„åˆ™ graph TD A[ç”¨æˆ·æŸ¥è¯¢] --\u003e B{SearchModeé€‰æ‹©} B --\u003e|0: è¯­ä¹‰æœç´¢| C[Semantic Search] B --\u003e|1: æ··åˆæœç´¢| D[Hybrid Search] B --\u003e|20: å…¨æ–‡æœç´¢| E[Full-text Search] C --\u003e C1[Step1: æŸ¥è¯¢å‘é‡åŒ–] C1 --\u003e C2[Embedding Model] C2 --\u003e C3[Query Vector] C3 --\u003e C4[Step2: æ–‡æ¡£å‘é‡åŒ¹é…] C4 --\u003e C5[å‘é‡æ•°æ®åº“] C5 --\u003e C6[ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—] D --\u003e D1[Step1: å‘é‡æœç´¢è·¯å¾„] D --\u003e D2[Step2: å…³é”®è¯æœç´¢è·¯å¾„] D1 --\u003e D3[Embeddingæ£€ç´¢] D2 --\u003e D4[BM25ç®—æ³•] D3 --\u003e D5[ç»“æœèåˆç®—æ³•] D4 --\u003e D5 E --\u003e E1[Step1: åˆ†è¯å¤„ç†] E1 --\u003e E2[åˆ†è¯å™¨] E2 --\u003e E3[Step2: å€’æ’ç´¢å¼•] E3 --\u003e E4[æœç´¢å¼•æ“] E4 --\u003e E5[TF-IDFè¯„åˆ†] C6 --\u003e F[è¯­ä¹‰ç†è§£å¼º] D5 --\u003e G[å¹³è¡¡ç²¾ç¡®æ€§å’Œè¯­ä¹‰] E5 --\u003e H[å…³é”®è¯ç²¾ç¡®åŒ¹é…] F --\u003e I[æœ€ç»ˆæ£€ç´¢ç»“æœ] G --\u003e I H --\u003e I style C fill:#e1f5fe style D fill:#fff3e0 style E fill:#f3e5f5 style I fill:#e8f5e8 è¯­ä¹‰æœç´¢Â ï¼ˆå‡†ï¼‰:Â ä½¿ç”¨Â EmbeddingÂ æ¨¡å‹è®¡ç®—å‘é‡ç›¸ä¼¼åº¦ï¼Œç†è§£æ·±å±‚è¯­ä¹‰ï¼Œå¤„ç†åŒä¹‰è¯å’Œæ¦‚å¿µåŒ¹é…ã€‚\næ··åˆæœç´¢Â ï¼ˆå…¨é¢ï¼‰:Â ç»“åˆå‘é‡æœç´¢Â +Â BM25Â å…³é”®è¯æœç´¢ï¼Œå¹³è¡¡è¯­ä¹‰ç†è§£å’Œç²¾ç¡®åŒ¹é…ã€‚\nå…¨æ–‡æœç´¢Â ï¼ˆå¿«ï¼‰:Â ä¼ ç»Ÿçš„å€’æ’ç´¢å¼•å’ŒTF-IDFï¼Œç²¾ç¡®çš„å…³é”®è¯åŒ¹é…ï¼Œé€Ÿåº¦å¿«\nã€ç®—æ³•è¯´æ˜ã€‘\nEmbeddingå‘é‡æ£€ç´¢ï¼šå°†æ–‡æœ¬é€šè¿‡ç¼–ç å™¨è½¬ä¸ºå‘é‡å’ŒDBä¸­çš„å‘é‡è®¡ç®—cosç›¸ä¼¼åº¦æœ€åè¿”å›TopKçš„ç»“æœ graph TD A[æ–‡æœ¬è¾“å…¥] --\u003e B[Embeddingæ£€ç´¢æµç¨‹] B --\u003e C[ç¬¬ä¸€é˜¶æ®µ: å‘é‡åŒ–] C --\u003e C1[åˆ†è¯å’Œé¢„å¤„ç†] C1 --\u003e C2[Transformerç¼–ç å™¨] C2 --\u003e C3[æ± åŒ–æ“ä½œ] C3 --\u003e C4[å½’ä¸€åŒ–å¤„ç†] C4 --\u003e C5[ç”Ÿæˆå‘é‡è¡¨ç¤º] B --\u003e D[ç¬¬äºŒé˜¶æ®µ: ç´¢å¼•æ„å»º] D --\u003e D1[å‘é‡ç»´åº¦ä¼˜åŒ–] D1 --\u003e D2[ç´¢å¼•ç»“æ„é€‰æ‹©] D2 --\u003e D3[HNSW/IVF/LSH] D3 --\u003e D4[åˆ†å¸ƒå¼å­˜å‚¨] B --\u003e E[ç¬¬ä¸‰é˜¶æ®µ: ç›¸ä¼¼åº¦æ£€ç´¢] E --\u003e E1[æŸ¥è¯¢å‘é‡åŒ–] E1 --\u003e E2[è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢] E2 --\u003e E3[ç›¸ä¼¼åº¦è®¡ç®—] E3 --\u003e E4[TopKç»“æœè¿”å›] F[æŠ€æœ¯æ ˆ] --\u003e F1[æ¨¡å‹: BERT/Sentence-BERT] F --\u003e F2[å‘é‡DB: Pinecone/Milvus/ElasticSearch] F --\u003e F3[ç›¸ä¼¼åº¦: ä½™å¼¦/ç‚¹ç§¯/æ¬§æ°] F --\u003e F4[ç´¢å¼•: HNSW/IVF] style C fill:#e1f5fe style D fill:#fff3e0 style E fill:#f3e5f5 style F fill:#e8f5e8 å€’æ’ç´¢å¼•ï¼šå°†æ–‡æ¡£åˆ‡åˆ†æˆç‹¬ç«‹çš„è¯æ±‡å•å…ƒï¼Œå»ºç«‹ä»è¯æ±‡åˆ°æ–‡æ¡£çš„æ˜ å°„ç´¢å¼•\nTF-IDFÂ (è¯é¢‘-é€†æ–‡æ¡£é¢‘ç‡)ï¼šTFï¼ˆè¯é¢‘ï¼‰ï¼šÂ è®¡ç®—ä¸€ä¸ªè¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„è¯æ¬¡æ•°ï¼ŒÂ ç”¨äºè¡¡é‡è¯æ±‡çš„é‡è¦æ€§ã€‚IDFÂ ï¼ˆé€†æ–‡æ¡£é¢‘ç‡ï¼‰ï¼šè¡¡é‡è¯æ±‡åœ¨æ•´ä¸ªè¯­æ–™åº“ä¸­çš„é‡è¦æ€§ã€‚Â TF(t,d) = è¯æ±‡tåœ¨æ–‡æ¡£dä¸­å‡ºç°çš„æ¬¡æ•° / æ–‡æ¡£dçš„æ€»è¯æ•° IDF(t) = log(æ–‡æ¡£æ€»æ•° / åŒ…å«è¯æ±‡tçš„æ–‡æ¡£æ•°) TF-IDF = sigmoid (TF(t,d) * IDF(t)) ç¼ºç‚¹ï¼šä¸èƒ½è€ƒè™‘è¯æ±‡çš„ä½ç½®ï¼Œå¿½ç•¥äº†è¯æ±‡çš„ç›¸å…³æ€§ï¼›ä¸åˆ©äºç¨€ç–æ€§Â ï¼ˆçŸ­æ–‡æ¡£å¾ˆå¤šè¯æ±‡Â TF-IDF=0ï¼‰\nBM25Â ç®—æ³•ï¼šåœ¨Â TF-IDFÂ (è¯é¢‘-é€†æ–‡æ¡£é¢‘ç‡)Â åŸºç¡€ä¸Šï¼Œè§£å†³äº†è¯é¢‘é¥±å’Œé—®é¢˜å’Œæ–‡æ¡£é•¿åº¦å½’ä¸€åŒ–é—®é¢˜ã€‚ ReRankÂ è§„åˆ™ çŸ¥è¯†åº“èŠ‚ç‚¹ç»“æ„ // Knowledge çŸ¥è¯†åº“èŠ‚ç‚¹é…ç½® // ç”¨äºé…ç½®ç‹¬ç«‹çš„çŸ¥è¯†åº“æ£€ç´¢èŠ‚ç‚¹ï¼Œå®šä¹‰æ•°æ®æºå‚æ•°å’Œå¤„ç†ç­–ç•¥ // ä¸LLMèŠ‚ç‚¹ä¸­çš„KnowledgeFCParamä¸åŒï¼Œè¿™æ˜¯ä¸“é—¨çš„çŸ¥è¯†åº“æ£€ç´¢æ­¥éª¤ type Knowledge struct { // DatasetParam æ•°æ®é›†å‚æ•°é…ç½® // å®šä¹‰çŸ¥è¯†åº“çš„æ•°æ®æºé…ç½®ï¼ŒåŒ…æ‹¬æ•°æ®åº“è¿æ¥ã€æ–‡ä»¶è·¯å¾„ç­‰ä¿¡æ¯ // æ¯ä¸ªParamåŒ…å«å…·ä½“çš„æ•°æ®æºé…ç½®é¡¹ DatasetParam []*Param `json:\"datasetParam,omitempty\"` // StrategyParam çŸ¥è¯†åº“å¤„ç†ç­–ç•¥å‚æ•° // å®šä¹‰æ–‡æ¡£è§£æã€åˆ†å—ã€ç´¢å¼•ç­‰å„ä¸ªç¯èŠ‚çš„å¤„ç†ç­–ç•¥å’Œå‚æ•° StrategyParam StrategyParam `json:\"strategyParam,omitempty\"` } // StrategyParam çŸ¥è¯†åº“å¤„ç†ç­–ç•¥å‚æ•°é…ç½® // å®šä¹‰çŸ¥è¯†åº“ä»æ–‡æ¡£è§£æåˆ°å‘é‡ç´¢å¼•çš„å®Œæ•´å¤„ç†æµç¨‹ç­–ç•¥ type StrategyParam struct { // ParsingStrategy æ–‡æ¡£è§£æç­–ç•¥é…ç½® // å®šä¹‰å¦‚ä½•è§£æå’Œæå–ä¸åŒç±»å‹æ–‡æ¡£çš„å†…å®¹ ParsingStrategy struct { // ParsingType è§£æç±»å‹ // å®šä¹‰æ–‡æ¡£è§£æçš„æ–¹å¼ï¼Œå¦‚è‡ªåŠ¨è¯†åˆ«ã€æ‰‹åŠ¨æŒ‡å®šç­‰ // å¸¸è§å€¼ï¼šautoï¼ˆè‡ªåŠ¨è¯†åˆ«ï¼‰ã€manualï¼ˆæ‰‹åŠ¨æŒ‡å®šï¼‰ã€customï¼ˆè‡ªå®šä¹‰ï¼‰ ParsingType string `json:\"parsingType,omitempty\"` // ImageExtraction æ˜¯å¦æå–å›¾ç‰‡ // æ§åˆ¶æ˜¯å¦ä»æ–‡æ¡£ä¸­æå–å›¾ç‰‡å†…å®¹è¿›è¡Œå¤„ç† // trueè¡¨ç¤ºæå–å›¾ç‰‡ï¼Œfalseè¡¨ç¤ºå¿½ç•¥å›¾ç‰‡å†…å®¹ ImageExtraction bool `json:\"imageExtraction\"` // TableExtraction æ˜¯å¦æå–è¡¨æ ¼ // æ§åˆ¶æ˜¯å¦ä»æ–‡æ¡£ä¸­æå–è¡¨æ ¼ç»“æ„å’Œæ•°æ® // trueè¡¨ç¤ºè§£æè¡¨æ ¼ç»“æ„ï¼Œfalseè¡¨ç¤ºå°†è¡¨æ ¼è§†ä¸ºæ™®é€šæ–‡æœ¬ TableExtraction bool `json:\"tableExtraction\"` // ImageOcr æ˜¯å¦å¯ç”¨å›¾ç‰‡OCRè¯†åˆ« // æ§åˆ¶æ˜¯å¦å¯¹æå–çš„å›¾ç‰‡è¿›è¡Œå…‰å­¦å­—ç¬¦è¯†åˆ« // trueè¡¨ç¤ºå¯¹å›¾ç‰‡è¿›è¡ŒOCRæ–‡å­—è¯†åˆ«ï¼Œfalseè¡¨ç¤ºå¿½ç•¥å›¾ç‰‡ä¸­çš„æ–‡å­— ImageOcr bool `json:\"imageOcr\"` } `json:\"parsingStrategy,omitempty\"` // ChunkStrategy æ–‡æ¡£åˆ†å—ç­–ç•¥é…ç½® // å®šä¹‰å¦‚ä½•å°†é•¿æ–‡æ¡£åˆ‡åˆ†æˆé€‚åˆå‘é‡åŒ–çš„å°å— ChunkStrategy struct { // ChunkType åˆ†å—ç±»å‹ // å®šä¹‰æ–‡æ¡£åˆ†å—çš„ç­–ç•¥ç±»å‹ // å¸¸è§å€¼ï¼šfixedï¼ˆå›ºå®šé•¿åº¦ï¼‰ã€semanticï¼ˆè¯­ä¹‰åˆ†å—ï¼‰ã€sentenceï¼ˆå¥å­åˆ†å—ï¼‰ ChunkType string `json:\"chunkType,omitempty\"` // SeparatorType åˆ†éš”ç¬¦ç±»å‹ // å®šä¹‰ç”¨äºåˆ†å—çš„åˆ†éš”ç¬¦ç±»å‹ // å¸¸è§å€¼ï¼šautoï¼ˆè‡ªåŠ¨é€‰æ‹©ï¼‰ã€newlineï¼ˆæ¢è¡Œç¬¦ï¼‰ã€paragraphï¼ˆæ®µè½ï¼‰ã€customï¼ˆè‡ªå®šä¹‰ï¼‰ SeparatorType string `json:\"separatorType,omitempty\"` // Separator è‡ªå®šä¹‰åˆ†éš”ç¬¦ // å½“SeparatorTypeä¸ºcustomæ—¶ï¼ŒæŒ‡å®šå…·ä½“çš„åˆ†éš”ç¬¦å­—ç¬¦ä¸² Separator string `json:\"separator,omitempty\"` // MaxToken æœ€å¤§ä»¤ç‰Œæ•° // å®šä¹‰æ¯ä¸ªæ–‡æ¡£å—çš„æœ€å¤§tokenæ•°é‡ï¼Œæ§åˆ¶å—çš„å¤§å° // é€šå¸¸è®¾ç½®ä¸ºæ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£å¤§å°ï¼Œå¦‚512ã€1024ç­‰ MaxToken int64 `json:\"maxToken,omitempty\"` // Overlap é‡å æ¯”ä¾‹ // å®šä¹‰ç›¸é‚»æ–‡æ¡£å—ä¹‹é—´çš„é‡å æ¯”ä¾‹ï¼Œé¿å…è¯­ä¹‰ä¿¡æ¯åœ¨è¾¹ç•Œå¤„ä¸¢å¤± // å–å€¼èŒƒå›´0.0-1.0ï¼Œå¸¸è§å€¼ä¸º0.1-0.2ï¼ˆ10%-20%é‡å ï¼‰ Overlap float64 `json:\"overlap,omitempty\"` } `json:\"chunkStrategy,omitempty\"` // IndexStrategy ç´¢å¼•ç­–ç•¥é…ç½® // å®šä¹‰å‘é‡ç´¢å¼•çš„æ„å»ºç­–ç•¥ï¼Œå¦‚ç´¢å¼•ç±»å‹ã€å‚æ•°ç­‰ // å…·ä½“ç»“æ„ä¾èµ–äºä½¿ç”¨çš„å‘é‡æ•°æ®åº“ç±»å‹ï¼ˆå¦‚HNSWã€IVFç­‰ï¼‰ IndexStrategy any `json:\"indexStrategy\"` } ",
  "wordCount" : "1812",
  "inLanguage": "en",
  "image": "https://swimmingliu.cn/papermod-cover.png","datePublished": "2025-08-07T23:27:35+08:00",
  "dateModified": "2025-08-07T23:27:35+08:00",
  "author":[{
    "@type": "Person",
    "name": "SwimmingLiu"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://swimmingliu.cn/posts/job/coze-workflow-analysis/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "SwimmingLiu's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://swimmingliu.cn/images/swimmingliu_icon.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://swimmingliu.cn/" accesskey="h" title="ğ“¢ğ”€ğ“²ğ“¶ğ“¶ğ“²ğ“·ğ“°ğ“›ğ“²ğ“¾&#39;ğ“¼ ğ“‘ğ“µğ“¸ğ“° (Alt + H)">
                <img src="https://swimmingliu.cn/images/swimmingliu_icon.png" alt="" aria-label="logo"
                    height="30">ğ“¢ğ”€ğ“²ğ“¶ğ“¶ğ“²ğ“·ğ“°ğ“›ğ“²ğ“¾&#39;ğ“¼ ğ“‘ğ“µğ“¸ğ“°</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://swimmingliu.cn/index.html" title="ğŸ¡ Home">
                    <span>ğŸ¡ Home</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/search/" title="ğŸ” Search">
                    <span>ğŸ” Search</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/posts/" title="ğŸ—’ï¸ Posts">
                    <span>ğŸ—’ï¸ Posts</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/archives/" title="ğŸ“ƒ Archive">
                    <span>ğŸ“ƒ Archive</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/tags/" title="ğŸ“‘ Tags">
                    <span>ğŸ“‘ Tags</span>
                </a>
            </li>
            <li>
                <a href="https://bento.me/swimmingliu" title="ğŸ‘¨ğŸ»â€ğŸ“ About Me">
                    <span>ğŸ‘¨ğŸ»â€ğŸ“ About Me</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://www.emojisearch.app/" title="Emoji">
                    <span>Emoji</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://swimmingliu.cn/">Home</a>&nbsp;Â»&nbsp;<a href="https://swimmingliu.cn/posts/">ğŸ“š Posts</a>&nbsp;Â»&nbsp;<a href="https://swimmingliu.cn/posts/job/">ğŸ’» Job</a></div>
    <h1 class="post-title entry-hint-parent">
      Cozeå·¥ä½œæµåˆ†æ
    </h1>
    <div class="post-meta"><span title='2025-08-07 23:27:35 +0800 CST'>August 7, 2025</span>&nbsp;Â·&nbsp;9 min&nbsp;Â·&nbsp;SwimmingLiu

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#coze%e5%b7%a5%e4%bd%9c%e6%b5%81-qa" aria-label="Cozeå·¥ä½œæµ-QA">Cozeå·¥ä½œæµ-QA</a><ul>
                        
                <li>
                    <a href="#%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%ae%a1%e7%90%86" aria-label="å·¥ä½œæµç®¡ç†">å·¥ä½œæµç®¡ç†</a><ul>
                        
                <li>
                    <a href="#11%e5%a6%82%e4%bd%95%e4%bb%8e%e7%94%bb%e5%b8%83%e8%bd%ac%e6%88%90%e4%b8%80%e4%b8%aa%e7%b1%bb" aria-label="1.1Â å¦‚ä½•ä»ç”»å¸ƒè½¬æˆä¸€ä¸ªç±»ï¼Ÿ">1.1Â å¦‚ä½•ä»ç”»å¸ƒè½¬æˆä¸€ä¸ªç±»ï¼Ÿ</a><ul>
                        
                <li>
                    <a href="#111%e8%8a%82%e7%82%b9%e6%95%b0%e6%8d%ae" aria-label="1.1.1Â èŠ‚ç‚¹æ•°æ®">1.1.1Â èŠ‚ç‚¹æ•°æ®</a></li>
                <li>
                    <a href="#112%e8%be%b9%e6%95%b0%e6%8d%ae" aria-label="1.1.2Â è¾¹æ•°æ®">1.1.2Â è¾¹æ•°æ®</a></li>
                <li>
                    <a href="#113%e5%a4%a7%e8%af%ad%e8%a8%80%e6%a8%a1%e5%9e%8b%e8%8a%82%e7%82%b9notetypellm" aria-label="1.1.3Â å¤§è¯­è¨€æ¨¡å‹èŠ‚ç‚¹Â (NoteTypeLLM)">1.1.3Â å¤§è¯­è¨€æ¨¡å‹èŠ‚ç‚¹Â (NoteTypeLLM)</a><ul>
                        
                <li>
                    <a href="#llm%e8%8a%82%e7%82%b9%e7%b1%bb%e5%9b%be%e5%a6%82%e4%b8%8b%e5%9b%be%e6%89%80%e7%a4%ba" aria-label="LLMèŠ‚ç‚¹ç±»å›¾å¦‚ä¸‹å›¾æ‰€ç¤º">LLMèŠ‚ç‚¹ç±»å›¾å¦‚ä¸‹å›¾æ‰€ç¤º</a></li>
                <li>
                    <a href="#llm%e5%8f%82%e6%95%b0-simplellmparam" aria-label="LLMå‚æ•°Â -Â SimpleLLMParam">LLMå‚æ•°Â -Â SimpleLLMParam</a></li>
                <li>
                    <a href="#llm%e4%b8%ad%e7%9a%84%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8%e5%8f%82%e6%95%b0fcparam" aria-label="LLMä¸­çš„å‡½æ•°è°ƒç”¨å‚æ•°Â **FcParam**">LLMä¸­çš„å‡½æ•°è°ƒç”¨å‚æ•°Â **FcParam**</a></li></ul>
                </li>
                <li>
                    <a href="#114blockinput%e7%bb%93%e6%9e%84" aria-label="1.1.4Â BlockInputç»“æ„">1.1.4Â BlockInputç»“æ„</a></li>
                <li>
                    <a href="#115%e7%9f%a5%e8%af%86%e5%ba%93%e8%8a%82%e7%82%b9rag" aria-label="1.1.5Â çŸ¥è¯†åº“èŠ‚ç‚¹Â (RAG)">1.1.5Â çŸ¥è¯†åº“èŠ‚ç‚¹Â (RAG)</a><ul>
                        
                <li>
                    <a href="#rag%e5%ae%8c%e6%95%b4%e6%b5%81%e7%a8%8b%e5%9b%be" aria-label="RAGå®Œæ•´æµç¨‹å›¾">RAGå®Œæ•´æµç¨‹å›¾</a></li>
                <li>
                    <a href="#%e5%90%91%e9%87%8f%e6%a3%80%e7%b4%a2%e8%a7%84%e5%88%99" aria-label="å‘é‡æ£€ç´¢è§„åˆ™">å‘é‡æ£€ç´¢è§„åˆ™</a></li>
                <li>
                    <a href="#rerank%e8%a7%84%e5%88%99" aria-label="ReRankÂ è§„åˆ™">ReRankÂ è§„åˆ™</a></li>
                <li>
                    <a href="#%e7%9f%a5%e8%af%86%e5%ba%93%e8%8a%82%e7%82%b9%e7%bb%93%e6%9e%84" aria-label="çŸ¥è¯†åº“èŠ‚ç‚¹ç»“æ„">çŸ¥è¯†åº“èŠ‚ç‚¹ç»“æ„</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>
  <div class="post-content"><h1 id="cozeå·¥ä½œæµ-qa">Cozeå·¥ä½œæµ-QA<a hidden class="anchor" aria-hidden="true" href="#cozeå·¥ä½œæµ-qa">#</a></h1>
<blockquote>
<p>å·¥ä½œæµå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªå¤§æ¿å—ï¼šå·¥ä½œæµç®¡ç†Â (å‰åç«¯äº¤äº’-ç”»å¸ƒå­˜å‚¨)ã€å·¥ä½œæµæ ¡éªŒã€å·¥ä½œæµæ‰§è¡Œ</p></blockquote>
<h2 id="å·¥ä½œæµç®¡ç†">å·¥ä½œæµç®¡ç†<a hidden class="anchor" aria-hidden="true" href="#å·¥ä½œæµç®¡ç†">#</a></h2>
<blockquote>
<p>å¯¹äºå‰ç«¯æ¥è®²ï¼Œå·¥ä½œæµå°±æ˜¯ä¸€å¼ canvasç”»å¸ƒã€‚ç”¨æˆ·å¯ä»¥åœ¨ç”»å¸ƒä¸­ï¼Œåˆ›å»ºä¸åŒåŠŸèƒ½çš„èŠ‚ç‚¹ã€‚</p></blockquote>
<blockquote>
<p>èŠ‚ç‚¹ç±»å‹å¯ä»¥åˆ†ä¸ºï¼šå¼€å§‹å’Œç»“æŸèŠ‚ç‚¹Â ï¼ˆé»˜è®¤ï¼‰ã€LLMèŠ‚ç‚¹ã€å­å·¥ä½œæµÂ (åµŒå¥—)ã€æ’ä»¶Â (å¤–éƒ¨å·¥å…·-ä¾‹å¦‚MCPã€OCR)ã€ä¸šåŠ¡é€»è¾‘èŠ‚ç‚¹Â (é€‰æ‹©ã€å¾ªç¯ã€åˆ†ç±»ã€æ‰¹å¤„ç†(å¹¶å‘)ã€å˜é‡èšåˆ)ã€æ•°æ®åº“èŠ‚ç‚¹(SQLã€CRUD)ã€çŸ¥è¯†åº“èŠ‚ç‚¹(RAGã€å¢åˆ ã€å˜é‡èµ‹å€¼)ã€å›¾åƒå¤„ç†èŠ‚ç‚¹ã€éŸ³è§†é¢‘å¤„ç†èŠ‚ç‚¹ã€ç»„ä»¶(JSONåºåˆ—åŒ–ã€HTTPè¯·æ±‚)ã€å®šæ—¶è§¦å‘å™¨èŠ‚ç‚¹(å®šæ—¶è§¦å‘ä»»åŠ¡)</p></blockquote>
<h3 id="11å¦‚ä½•ä»ç”»å¸ƒè½¬æˆä¸€ä¸ªç±»">1.1Â å¦‚ä½•ä»ç”»å¸ƒè½¬æˆä¸€ä¸ªç±»ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#11å¦‚ä½•ä»ç”»å¸ƒè½¬æˆä¸€ä¸ªç±»">#</a></h3>
<p>å‰ç«¯çš„ç”»å¸ƒé‡‡ç”¨DSLÂ (JSON)Â å½¢å¼å­˜å‚¨ï¼Œæ¯æ¬¡æ›´æ–°ç”»å¸ƒéƒ½æ˜¯å°†DSLä¼ ç»™åç«¯ã€‚DSLçš„åç«¯ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸»è¦åŒ…å«èŠ‚ç‚¹Â (node)ã€Â è¾¹Â (edge)ã€Â ç‰ˆæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Canvas</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Nodes</span>    <span class="p">[]</span><span class="o">*</span><span class="nx">Node</span> <span class="s">`json:&#34;nodes&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Edges</span>    <span class="p">[]</span><span class="o">*</span><span class="nx">Edge</span> <span class="s">`json:&#34;edges&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Versions</span> <span class="kt">any</span>     <span class="s">`json:&#34;versions&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="111èŠ‚ç‚¹æ•°æ®">1.1.1Â èŠ‚ç‚¹æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#111èŠ‚ç‚¹æ•°æ®">#</a></h4>
<p>ç”»å¸ƒä¸­çš„èŠ‚ç‚¹ä¼šè½¬æ¢ä¸ºåç«¯ä¸­Â <code>backend/domain/workflow/entity/vo/canvas.go</code>Â ä¸­çš„Â NodeÂ ç»“æ„ä½“ï¼ŒÂ åç«¯å­˜å‚¨çš„ç»“æ„ä½“å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// Node å·¥ä½œæµèŠ‚ç‚¹çš„å®Œæ•´å®šä¹‰</span>
</span></span><span class="line"><span class="cl"><span class="c1">// èŠ‚ç‚¹æ˜¯å·¥ä½œæµçš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½æˆ–æ“ä½œ</span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Node</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåœ¨ç”»å¸ƒä¸­å®šä½å’Œå¼•ç”¨èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ID</span>      <span class="kt">string</span>    <span class="s">`json:&#34;id&#34;`</span> 
</span></span><span class="line"><span class="cl">    <span class="c1">// èŠ‚ç‚¹ç±»å‹ï¼Œå†³å®šèŠ‚ç‚¹çš„åŠŸèƒ½å’Œè¡Œä¸ºï¼ˆå¦‚LLMã€APIè°ƒç”¨ã€æ¡ä»¶åˆ¤æ–­ç­‰ï¼‰</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Type</span>    <span class="nx">BlockType</span> <span class="s">`json:&#34;type&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// èŠ‚ç‚¹çš„å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒ…å«å‰ç«¯æ˜¾ç¤ºç›¸å…³çš„é…ç½® (å‰ç«¯çš„ä¸€äº›extendInfo)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Meta</span>    <span class="kt">any</span>       <span class="s">`json:&#34;meta&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®ï¼ŒåŒ…å«è¾“å…¥è¾“å‡ºé…ç½®å’Œå…·ä½“å‚æ•°ï¼Œä¾‹å¦‚LLMçš„é…ç½®ã€MCPçš„é…ç½®ã€å¼‚å¸¸å¤„ç†</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Data</span>    <span class="o">*</span><span class="nx">Data</span>     <span class="s">`json:&#34;data&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å­èŠ‚ç‚¹åˆ—è¡¨ï¼Œç”¨äºå¤åˆèŠ‚ç‚¹ï¼ˆå¦‚å¾ªç¯ã€æ¡ä»¶åˆ†æ”¯ï¼‰çš„åµŒå¥—ç»“æ„</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Blocks</span>  <span class="p">[]</span><span class="o">*</span><span class="nx">Node</span>   <span class="s">`json:&#34;blocks,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// èŠ‚ç‚¹å†…éƒ¨çš„è¿çº¿ï¼Œç”¨äºå¤æ‚èŠ‚ç‚¹çš„å†…éƒ¨é€»è¾‘è¿æ¥</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Edges</span>   <span class="p">[]</span><span class="o">*</span><span class="nx">Edge</span>   <span class="s">`json:&#34;edges,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// èŠ‚ç‚¹çš„ç‰ˆæœ¬å·ï¼Œç”¨äºèŠ‚ç‚¹å®šä¹‰çš„ç‰ˆæœ¬æ§åˆ¶</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Version</span> <span class="kt">string</span>    <span class="s">`json:&#34;version,omitempty&#34;`</span> 
</span></span><span class="line"><span class="cl">    <span class="c1">// çˆ¶èŠ‚ç‚¹å¼•ç”¨ï¼Œä¸åºåˆ—åŒ–åˆ°JSONï¼Œç”¨äºå†…å­˜ä¸­çš„æ ‘å½¢ç»“æ„å¯¼èˆª</span>
</span></span><span class="line"><span class="cl">	<span class="nx">parent</span> <span class="o">*</span><span class="nx">Node</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>èŠ‚ç‚¹çš„æ ¸å¿ƒæ•°æ®<code>Data</code>å¦‚ä¸‹æ‰€ç¤º</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Data</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// èŠ‚ç‚¹çš„æ˜¾ç¤ºå…ƒæ•°æ®ï¼Œå¦‚æ ‡é¢˜ã€iconç­‰</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Meta</span>    <span class="o">*</span><span class="nx">NodeMeta</span> <span class="s">`json:&#34;nodeMeta,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// èŠ‚ç‚¹çš„è¾“å‡ºå®šä¹‰ï¼Œå¯ä»¥æ˜¯ []*Variable æˆ– []*Param ç±»å‹</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Outputs</span> <span class="p">[]</span><span class="kt">any</span>     <span class="s">`json:&#34;outputs,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// èŠ‚ç‚¹çš„è¾“å…¥é…ç½®ï¼ŒåŒ…å«æ‰€æœ‰è¾“å…¥å‚æ•°å’Œè®¾ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Inputs</span>  <span class="o">*</span><span class="nx">Inputs</span>   <span class="s">`json:&#34;inputs,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// èŠ‚ç‚¹åœ¨ç”»å¸ƒä¸Šçš„å°ºå¯¸ä¿¡æ¯ï¼Œç”¨äºå‰ç«¯æ˜¾ç¤º</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Size</span>    <span class="kt">any</span>       <span class="s">`json:&#34;size,omitempty&#34;`</span>     
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>èŠ‚ç‚¹çš„è¾“å…¥å‚æ•°Â <code>inputs</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// Inputs èŠ‚ç‚¹è¾“å…¥é…ç½®çš„ç»¼åˆç»“æ„</span>
</span></span><span class="line"><span class="cl"><span class="c1">// è¿™æ˜¯ä¸€ä¸ªè”åˆç»“æ„ï¼ŒåŒ…å«äº†æ‰€æœ‰å¯èƒ½çš„èŠ‚ç‚¹è¾“å…¥é…ç½®ï¼Œä¸åŒç±»å‹çš„èŠ‚ç‚¹ä½¿ç”¨ä¸åŒçš„å­—æ®µå­é›†</span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Inputs</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// é€šç”¨è¾“å…¥é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="nx">InputParameters</span>    <span class="p">[]</span><span class="o">*</span><span class="nx">Param</span>        <span class="s">`json:&#34;inputParameters&#34;`</span>              <span class="c1">// èŠ‚ç‚¹çš„è¾“å…¥å‚æ•°åˆ—è¡¨ï¼Œå®šä¹‰èŠ‚ç‚¹éœ€è¦çš„æ•°æ®è¾“å…¥</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Content</span>            <span class="o">*</span><span class="nx">BlockInput</span>     <span class="s">`json:&#34;content&#34;`</span>                      <span class="c1">// èŠ‚ç‚¹çš„ä¸»è¦å†…å®¹è¾“å…¥ï¼Œé€šå¸¸ç”¨äºæ–‡æœ¬å¤„ç†æˆ–æç¤ºè¯</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TerminatePlan</span>      <span class="o">*</span><span class="nx">TerminatePlan</span>  <span class="s">`json:&#34;terminatePlan,omitempty&#34;`</span>      <span class="c1">// ç»ˆæ­¢è®¡åˆ’ï¼Œå®šä¹‰èŠ‚ç‚¹å®Œæˆåçš„è¡Œä¸º</span>
</span></span><span class="line"><span class="cl">	<span class="nx">StreamingOutput</span>    <span class="kt">bool</span>            <span class="s">`json:&#34;streamingOutput,omitempty&#34;`</span>    <span class="c1">// æ˜¯å¦å¯ç”¨æµå¼è¾“å‡ºï¼Œç”¨äºå®æ—¶è¿”å›å¤„ç†ç»“æœ</span>
</span></span><span class="line"><span class="cl">	<span class="nx">CallTransferVoice</span>  <span class="kt">bool</span>            <span class="s">`json:&#34;callTransferVoice,omitempty&#34;`</span>  <span class="c1">// è¯­éŸ³é€šè¯è½¬æ¥è®¾ç½®ï¼Œç”¨äºè¯­éŸ³ç›¸å…³èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ChatHistoryWriting</span> <span class="kt">string</span>          <span class="s">`json:&#34;chatHistoryWriting,omitempty&#34;`</span> <span class="c1">// èŠå¤©å†å²è®°å½•å†™å…¥é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="nx">LLMParam</span>           <span class="kt">any</span>             <span class="s">`json:&#34;llmParam,omitempty&#34;`</span>           <span class="c1">// LLMå‚æ•°ï¼Œå¯èƒ½æ˜¯LLMParamã€IntentDetectorLLMParamæˆ–QALLMParamç±»å‹</span>
</span></span><span class="line"><span class="cl">	<span class="nx">FCParam</span>            <span class="o">*</span><span class="nx">FCParam</span>        <span class="s">`json:&#34;fcParam,omitempty&#34;`</span>            <span class="c1">// åŠŸèƒ½è°ƒç”¨å‚æ•°ï¼Œç”¨äºé…ç½®å·¥ä½œæµã€æ’ä»¶æˆ–çŸ¥è¯†åº“çš„è°ƒç”¨</span>
</span></span><span class="line"><span class="cl">	<span class="nx">SettingOnError</span>     <span class="o">*</span><span class="nx">SettingOnError</span> <span class="s">`json:&#34;settingOnError,omitempty&#34;`</span>     <span class="c1">// é”™è¯¯å¤„ç†é…ç½®ï¼Œå®šä¹‰èŠ‚ç‚¹å‡ºé”™æ—¶çš„å¤„ç†ç­–ç•¥</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// å¾ªç¯æ§åˆ¶ç›¸å…³</span>
</span></span><span class="line"><span class="cl">	<span class="nx">LoopType</span>           <span class="nx">LoopType</span>    <span class="s">`json:&#34;loopType,omitempty&#34;`</span>           <span class="c1">// å¾ªç¯ç±»å‹ï¼šæ•°ç»„å¾ªç¯ã€è®¡æ•°å¾ªç¯æˆ–æ— é™å¾ªç¯</span>
</span></span><span class="line"><span class="cl">	<span class="nx">LoopCount</span>          <span class="o">*</span><span class="nx">BlockInput</span> <span class="s">`json:&#34;loopCount,omitempty&#34;`</span>          <span class="c1">// å¾ªç¯æ¬¡æ•°ï¼Œç”¨äºè®¡æ•°å¾ªç¯</span>
</span></span><span class="line"><span class="cl">	<span class="nx">VariableParameters</span> <span class="p">[]</span><span class="o">*</span><span class="nx">Param</span>    <span class="s">`json:&#34;variableParameters,omitempty&#34;`</span> <span class="c1">// å¾ªç¯å˜é‡å‚æ•°</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// æ¡ä»¶åˆ†æ”¯ç›¸å…³</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Branches</span> <span class="p">[]</span><span class="o">*</span><span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Condition</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Logic</span>      <span class="nx">LogicType</span>    <span class="s">`json:&#34;logic&#34;`</span>      <span class="c1">// æ¡ä»¶é€»è¾‘ï¼šANDæˆ–OR</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Conditions</span> <span class="p">[]</span><span class="o">*</span><span class="nx">Condition</span> <span class="s">`json:&#34;conditions&#34;`</span> <span class="c1">// å…·ä½“çš„æ¡ä»¶åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="s">`json:&#34;condition&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="s">`json:&#34;branches,omitempty&#34;`</span> <span class="c1">// åˆ†æ”¯æ¡ä»¶é…ç½®ï¼Œç”¨äºæ¡ä»¶åˆ¤æ–­èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// æ‰¹å¤„ç†é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="nx">NodeBatchInfo</span> <span class="o">*</span><span class="nx">NodeBatch</span> <span class="s">`json:&#34;batch,omitempty&#34;`</span> <span class="c1">// èŠ‚ç‚¹æ‰¹å¤„ç†æ¨¡å¼é…ç½®</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// ç‰¹å®šèŠ‚ç‚¹ç±»å‹çš„é…ç½®ï¼ˆä½¿ç”¨åµŒå…¥ç»“æ„ä½“å®ç°ç±»å‹å¤šæ€ï¼‰</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">TextProcessor</span>      <span class="c1">// æ–‡æœ¬å¤„ç†å™¨é…ç½®ï¼šæ‹¼æ¥ã€åˆ†å‰²ç­‰æ“ä½œ</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">SubWorkflow</span>        <span class="c1">// å­å·¥ä½œæµé…ç½®ï¼šè°ƒç”¨å…¶ä»–å·¥ä½œæµ</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">IntentDetector</span>     <span class="c1">// æ„å›¾æ£€æµ‹é…ç½®ï¼šè¯†åˆ«ç”¨æˆ·æ„å›¾</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">DatabaseNode</span>       <span class="c1">// æ•°æ®åº“æ“ä½œé…ç½®ï¼šå¢åˆ æ”¹æŸ¥</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">HttpRequestNode</span>    <span class="c1">// HTTPè¯·æ±‚é…ç½®ï¼šAPIè°ƒç”¨</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">KnowledgeIndexer</span>   <span class="c1">// çŸ¥è¯†åº“ç´¢å¼•é…ç½®ï¼šæ–‡æ¡£å¤„ç†å’Œç´¢å¼•</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">CodeRunner</span>         <span class="c1">// ä»£ç æ‰§è¡Œå™¨é…ç½®ï¼šè¿è¡Œè‡ªå®šä¹‰ä»£ç </span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">PluginAPIParam</span>     <span class="c1">// æ’ä»¶APIå‚æ•°é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">VariableAggregator</span> <span class="c1">// å˜é‡èšåˆå™¨é…ç½®ï¼šåˆå¹¶å¤šä¸ªå˜é‡</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">VariableAssigner</span>   <span class="c1">// å˜é‡èµ‹å€¼å™¨é…ç½®ï¼šè®¾ç½®å˜é‡å€¼</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">QA</span>                 <span class="c1">// é—®ç­”èŠ‚ç‚¹é…ç½®ï¼šå¤„ç†é—®é¢˜å’Œç­”æ¡ˆ</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">Batch</span>              <span class="c1">// æ‰¹å¤„ç†é…ç½®ï¼šæ‰¹é‡å¤„ç†æ•°æ®</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="nx">Comment</span>            <span class="c1">// æ³¨é‡ŠèŠ‚ç‚¹é…ç½®ï¼šæ·»åŠ è¯´æ˜æ–‡å­—</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">OutputSchema</span> <span class="kt">string</span> <span class="s">`json:&#34;outputSchema,omitempty&#34;`</span> <span class="c1">// è¾“å‡ºæ¨¡å¼å®šä¹‰ï¼Œæè¿°èŠ‚ç‚¹è¾“å‡ºæ•°æ®çš„ç»“æ„</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="112è¾¹æ•°æ®">1.1.2Â è¾¹æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#112è¾¹æ•°æ®">#</a></h4>
<p>è¾¹ä¸»è¦æ˜¯åŒ…å«è¾“å…¥èŠ‚ç‚¹ã€è¾“å‡ºèŠ‚ç‚¹çš„IDï¼Œè¿˜æœ‰è¾“å…¥çš„ç«¯å£å’Œè¾“å‡ºçš„ç«¯å£Â ï¼ˆè¾“å…¥è¾“å‡ºç«¯å£éƒ½æ˜¯åªå­˜åœ¨äº<code>ä¸šåŠ¡é€»è¾‘èŠ‚ç‚¹</code>ä¸­ï¼‰</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// Edge å·¥ä½œæµè¿çº¿å®šä¹‰</span>
</span></span><span class="line"><span class="cl"><span class="c1">// è¿çº¿å®šä¹‰äº†èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥å…³ç³»ï¼Œç¡®å®šå·¥ä½œæµçš„æ‰§è¡Œé¡ºåºå’Œæ•°æ®æµå‘</span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Edge</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æºèŠ‚ç‚¹IDï¼Œè¿çº¿çš„èµ·å§‹èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">	<span class="nx">SourceNodeID</span> <span class="kt">string</span> <span class="s">`json:&#34;sourceNodeID&#34;`</span> 
</span></span><span class="line"><span class="cl">    <span class="c1">// ç›®æ ‡èŠ‚ç‚¹IDï¼Œè¿çº¿çš„ç»ˆæ­¢èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TargetNodeID</span> <span class="kt">string</span> <span class="s">`json:&#34;targetNodeID&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æºç«¯å£IDï¼Œç”¨äºå¤šè¾“å‡ºç«¯å£çš„èŠ‚ç‚¹ï¼ŒæŒ‡å®šå…·ä½“çš„è¾“å‡ºç«¯å£</span>
</span></span><span class="line"><span class="cl">	<span class="nx">SourcePortID</span> <span class="kt">string</span> <span class="s">`json:&#34;sourcePortID,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ç›®æ ‡ç«¯å£IDï¼Œç”¨äºå¤šè¾“å…¥ç«¯å£çš„èŠ‚ç‚¹ï¼ŒæŒ‡å®šå…·ä½“çš„è¾“å…¥ç«¯å£</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TargetPortID</span> <span class="kt">string</span> <span class="s">`json:&#34;targetPortID,omitempty&#34;`</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="113å¤§è¯­è¨€æ¨¡å‹èŠ‚ç‚¹notetypellm">1.1.3Â å¤§è¯­è¨€æ¨¡å‹èŠ‚ç‚¹Â (NoteTypeLLM)<a hidden class="anchor" aria-hidden="true" href="#113å¤§è¯­è¨€æ¨¡å‹èŠ‚ç‚¹notetypellm">#</a></h4>
<h5 id="llmèŠ‚ç‚¹ç±»å›¾å¦‚ä¸‹å›¾æ‰€ç¤º">LLMèŠ‚ç‚¹ç±»å›¾å¦‚ä¸‹å›¾æ‰€ç¤º<a hidden class="anchor" aria-hidden="true" href="#llmèŠ‚ç‚¹ç±»å›¾å¦‚ä¸‹å›¾æ‰€ç¤º">#</a></h5>
<pre class="mermaid">classDiagram
    class Inputs {
        +Param[] inputParameters
        +SettingOnError settingOnError
        +NodeBatch nodeBatchInfo
        +any llmParam
        +LLM llmSpecificConfig
    }

    class LLM {
        +FCParam fcParam
    }

    class LLMParam {
        +Param[] parameters
    }

    class SimpleLLMParam {
        +string generationDiversity
        +int maxTokens
        +string modelName
        +int64 modelType
        +ResponseFormat responseFormat
        +string systemPrompt
        +float64 temperature
        +float64 topP
    }

    class Param {
        +string name
        +BlockInput input
        +BlockInput left
        +BlockInput right
        +BlockInput[] variables
    }

    class BlockInput {
        +VariableType type
        +AssistType assistType
        +any schema
        +BlockInputValue value
    }

    class BlockInputValue {
        +BlockInputValueType type
        +any content
        +any rawMeta
    }

    class BlockInputReference {
        +string blockID
        +string name
        +string[] path
        +RefSourceType source
    }

    class FCParam {
        +WorkflowFCParam workflowFCParam
        +PluginFCParam pluginFCParam
        +KnowledgeFCParam knowledgeFCParam
    }

    class SettingOnError {
        +ErrorHandlingStrategy strategy
        +string customMessage
    }

    class NodeBatch {
        +int batchSize
        +int concurrentSize
    }

    Inputs --> LLM : "contains"
    Inputs --> LLMParam : "llmParam as"
    Inputs --> SimpleLLMParam : "llmParam as"
    Inputs --> Param : "contains"
    Inputs --> SettingOnError : "contains"
    Inputs --> NodeBatch : "contains"
    
    LLM --> FCParam : "contains"
    LLMParam --> Param : "contains"
    Param --> BlockInput : "contains"
    BlockInput --> BlockInputValue : "contains"
    BlockInputValue --> BlockInputReference : "content as"

    note for Inputs "LLMèŠ‚ç‚¹çš„æ‰€æœ‰è¾“å…¥é…ç½®<br/>åŒ…å«é€šç”¨è¾“å…¥å’ŒLLMä¸“ç”¨é…ç½®"
    note for LLMParam "æ ‡å‡†LLMå‚æ•°åˆ—è¡¨<br/>æ¯ä¸ªå‚æ•°éƒ½æ˜¯Paramç±»å‹"
    note for SimpleLLMParam "ç®€åŒ–çš„LLMå‚æ•°ç»“æ„<br/>ç›´æ¥åŒ…å«æ‰€æœ‰LLMé…ç½®å­—æ®µ"
    note for FCParam "å‡½æ•°è°ƒç”¨èƒ½åŠ›é…ç½®<br/>LLMå¯è°ƒç”¨çš„å¤–éƒ¨å·¥å…·"
</pre>

<h5 id="llmå‚æ•°-simplellmparam">LLMå‚æ•°Â -Â <code>SimpleLLMParam</code><a hidden class="anchor" aria-hidden="true" href="#llmå‚æ•°-simplellmparam">#</a></h5>
<p><code>SimpleLLMParam</code>å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸»è¦åŒ…å«å¤šæ ·æ€§ç¨‹åº¦ã€æœ€å¤§Tokenã€æ¨¡å‹åç§°ã€æ¨¡å‹ç±»å‹ã€å“åº”æ ¼å¼ã€ç³»ç»Ÿæç¤ºè¯ã€<code>Temperature</code>æ¸©åº¦ã€<code>TopP</code>Â æ ¸é‡‡æ ·å‚æ•°</p>
<p>ã€æ³¨æ„ã€‘<code>generationDiversity</code>å¤šæ ·æ€§ç¨‹åº¦Â æ˜¯é«˜å±‚çš„é¢„è®¾ç­–ç•¥ï¼ˆå¦‚&quot;åˆ›æ„/å¹³è¡¡/ç²¾ç¡®&quot;æ¨¡å¼ï¼‰ï¼Œè€ŒÂ <code>temperature</code>å’ŒÂ <code>topP</code>æ˜¯åº•å±‚çš„å…·ä½“ç®—æ³•å‚æ•°ï¼Œå‰è€…é€šè¿‡å†…ç½®çš„å‚æ•°ç»„åˆæ¥ç®€åŒ–é…ç½®ï¼Œåè€…åˆ™æä¾›ç²¾ç¡®çš„éšæœºæ€§æ§åˆ¶ï¼ˆtemperatureè°ƒèŠ‚æ¦‚ç‡åˆ†å¸ƒå¹³æ»‘åº¦ï¼ŒtopPé™åˆ¶å€™é€‰è¯æ±‡èŒƒå›´ï¼‰ã€‚</p>
<p>ç®€å•è¯´ï¼šgenerationDiversityÂ =Â &ldquo;æˆ‘è¦ä»€ä¹ˆé£æ ¼&rdquo;ï¼ŒtemperatureÂ =Â &ldquo;è¦å¤šéšæœº&rdquo;ï¼ŒtopPÂ =Â &ldquo;è€ƒè™‘å¤šå°‘è¯æ±‡&rdquo;ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// SimpleLLMParam ç®€åŒ–çš„å¤§è¯­è¨€æ¨¡å‹å‚æ•°é…ç½®</span>
</span></span><span class="line"><span class="cl"><span class="c1">// æä¾›ç›´æ¥çš„å­—æ®µæ˜ å°„æ–¹å¼é…ç½®LLMå‚æ•°ï¼Œé€‚ç”¨äºç®€å•çš„æ¨¡å‹è°ƒç”¨åœºæ™¯</span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">SimpleLLMParam</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// GenerationDiversity ç”Ÿæˆå¤šæ ·æ€§é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// æ§åˆ¶æ¨¡å‹è¾“å‡ºçš„å¤šæ ·æ€§ç¨‹åº¦ï¼Œå½±å“ç”Ÿæˆå†…å®¹çš„åˆ›æ–°æ€§</span>
</span></span><span class="line"><span class="cl">	<span class="nx">GenerationDiversity</span> <span class="kt">string</span> <span class="s">`json:&#34;generationDiversity&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// MaxTokens æœ€å¤§ç”Ÿæˆä»¤ç‰Œæ•°</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// é™åˆ¶æ¨¡å‹å•æ¬¡ç”Ÿæˆçš„æœ€å¤§tokenæ•°é‡ï¼Œæ§åˆ¶è¾“å‡ºé•¿åº¦</span>
</span></span><span class="line"><span class="cl">	<span class="nx">MaxTokens</span> <span class="kt">int</span> <span class="s">`json:&#34;maxTokens&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// ModelName æ¨¡å‹åç§°</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// æŒ‡å®šè¦ä½¿ç”¨çš„å…·ä½“æ¨¡å‹åç§°ï¼Œå¦‚gpt-3.5-turboã€gpt-4ç­‰</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ModelName</span> <span class="kt">string</span> <span class="s">`json:&#34;modelName&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// ModelType æ¨¡å‹ç±»å‹æ ‡è¯†</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// ç”¨äºåŒºåˆ†ä¸åŒç±»å‹çš„æ¨¡å‹ï¼Œå¦‚èŠå¤©æ¨¡å‹ã€è¡¥å…¨æ¨¡å‹ç­‰</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ModelType</span> <span class="kt">int64</span> <span class="s">`json:&#34;modelType&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// ResponseFormat å“åº”æ ¼å¼é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// æŒ‡å®šæ¨¡å‹è¾“å‡ºçš„æ ¼å¼ï¼Œæ”¯æŒæ–‡æœ¬ã€JSONã€Markdownç­‰æ ¼å¼</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ResponseFormat</span> <span class="nx">model</span><span class="p">.</span><span class="nx">ResponseFormat</span> <span class="s">`json:&#34;responseFormat&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// SystemPrompt ç³»ç»Ÿæç¤ºè¯</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// å®šä¹‰æ¨¡å‹çš„ç³»ç»Ÿçº§æŒ‡ä»¤ï¼Œè®¾å®šæ¨¡å‹çš„è§’è‰²å’Œè¡Œä¸ºè§„èŒƒ</span>
</span></span><span class="line"><span class="cl">	<span class="nx">SystemPrompt</span> <span class="kt">string</span> <span class="s">`json:&#34;systemPrompt&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Temperature æ¸©åº¦å‚æ•°</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// æ§åˆ¶æ¨¡å‹è¾“å‡ºçš„éšæœºæ€§ï¼ŒèŒƒå›´é€šå¸¸ä¸º0.0-1.0ï¼Œå€¼è¶Šé«˜è¾“å‡ºè¶Šéšæœº</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// é€šè¿‡è°ƒæ•´softmaxæ¦‚ç‡åˆ†å¸ƒçš„å¹³æ»‘åº¦æ¥å½±å“è¯æ±‡é€‰æ‹©çš„ç¡®å®šæ€§</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Temperature</span> <span class="kt">float64</span> <span class="s">`json:&#34;temperature&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// TopP æ ¸é‡‡æ ·å‚æ•°</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// æ§åˆ¶æ¨¡å‹ç”Ÿæˆæ—¶è€ƒè™‘çš„è¯æ±‡æ¦‚ç‡è´¨é‡ï¼Œå½±å“è¾“å‡ºçš„å¤šæ ·æ€§å’Œè´¨é‡</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// é€šè¿‡è®¾ç½®æ¦‚ç‡ç´¯ç§¯é˜ˆå€¼æ¥é™åˆ¶å€™é€‰è¯æ±‡çš„èŒƒå›´ï¼ŒèŒƒå›´é€šå¸¸ä¸º0.0-1.0</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TopP</span> <span class="kt">float64</span> <span class="s">`json:&#34;topP&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h5 id="llmä¸­çš„å‡½æ•°è°ƒç”¨å‚æ•°fcparam">LLMä¸­çš„å‡½æ•°è°ƒç”¨å‚æ•°Â <code>**FcParam**</code><a hidden class="anchor" aria-hidden="true" href="#llmä¸­çš„å‡½æ•°è°ƒç”¨å‚æ•°fcparam">#</a></h5>
<p>functionCallingÂ ï¼ˆå¤§è¯­è¨€æ¨¡å‹èŠ‚ç‚¹çš„â€œæŠ€èƒ½â€ï¼‰ä¸­éœ€è¦ç”¨åˆ°çš„å‚æ•°</p>
<pre class="mermaid">graph TD
    A[ç”¨æˆ·è¾“å…¥é—®é¢˜] --> B[LLMèŠ‚ç‚¹æ¥æ”¶]
    B --> C{LLMåˆ†ææ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·}
    
    C -->|éœ€è¦è°ƒç”¨| D[FCParam å·¥å…·é…ç½®]
    C -->|ä¸éœ€è¦| E[ç›´æ¥ç”Ÿæˆå›ç­”]
    
    D --> F[WorkflowFCParam<br/>å­å·¥ä½œæµè°ƒç”¨]
    D --> G[PluginFCParam<br/>æ’ä»¶APIè°ƒç”¨]  
    D --> H[KnowledgeFCParam<br/>çŸ¥è¯†åº“æ£€ç´¢]
    
    F --> F1[é…ç½®å¯è°ƒç”¨çš„å­å·¥ä½œæµåˆ—è¡¨]
    F --> F2[å®šä¹‰è¯·æ±‚/å“åº”å‚æ•°]
    F --> F3[æ‰§è¡Œå­å·¥ä½œæµ]
    
    G --> G1[é…ç½®å¯è°ƒç”¨çš„æ’ä»¶APIåˆ—è¡¨]
    G --> G2[å®šä¹‰APIå‚æ•°å’Œå“åº”æ ¼å¼]
    G --> G3[è°ƒç”¨ç¬¬ä¸‰æ–¹æ’ä»¶æœåŠ¡]
    
    H --> H1[é…ç½®çŸ¥è¯†åº“åˆ—è¡¨]
    H --> H2[è®¾ç½®æ£€ç´¢ç­–ç•¥<br/>TopK/MinScore/æœç´¢æ¨¡å¼]
    H --> H3[æ‰§è¡ŒçŸ¥è¯†åº“æ£€ç´¢]
    
    F3 --> I[å·¥å…·æ‰§è¡Œç»“æœ]
    G3 --> I
    H3 --> I
    
    I --> J[LLMæ•´åˆå·¥å…·ç»“æœ]
    J --> K[ç”Ÿæˆæœ€ç»ˆå›ç­”]
    E --> K
    
    K --> L[è¿”å›ç»™ç”¨æˆ·]
    
    style A fill:#e1f5fe
    style D fill:#fff3e0
    style F fill:#f3e5f5
    style G fill:#e8f5e8
    style H fill:#fce4ec
    style K fill:#e0f2f1
</pre>

<p>å‡½æ•°è°ƒç”¨å‚æ•°Â <code>FcParam</code>ä¸»è¦åŒ…å«ä¸‰ç§æ¨¡å¼ï¼šå­å·¥ä½œæµè°ƒç”¨ã€æ’ä»¶APIè°ƒç”¨ã€çŸ¥è¯†åº“æ£€ç´¢</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// FCParam å‡½æ•°è°ƒç”¨å‚æ•°é…ç½®</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ç”¨äºé…ç½®å·¥ä½œæµä¸­ä¸åŒç±»å‹çš„å‡½æ•°è°ƒç”¨èƒ½åŠ›ï¼ŒåŒ…æ‹¬å­å·¥ä½œæµè°ƒç”¨ã€æ’ä»¶APIè°ƒç”¨å’ŒçŸ¥è¯†åº“æ£€ç´¢è°ƒç”¨</span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">FCParam</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// WorkflowFCParam å·¥ä½œæµå‡½æ•°è°ƒç”¨å‚æ•°é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// é…ç½®å½“å‰å·¥ä½œæµå¯ä»¥è°ƒç”¨çš„å­å·¥ä½œæµåˆ—è¡¨åŠå…¶å‚æ•°è®¾ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="nx">WorkflowFCParam</span> <span class="o">*</span><span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// WorkflowList å¯è°ƒç”¨çš„å·¥ä½œæµåˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// æ¯ä¸ªå·¥ä½œæµé¡¹åŒ…å«å·¥ä½œæµæ ‡è¯†ã€ç‰ˆæœ¬ä¿¡æ¯å’Œå‡½æ•°è°ƒç”¨è®¾ç½®</span>
</span></span><span class="line"><span class="cl">		<span class="nx">WorkflowList</span> <span class="p">[]</span><span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// WorkflowID å·¥ä½œæµå”¯ä¸€æ ‡è¯†ç¬¦</span>
</span></span><span class="line"><span class="cl">			<span class="nx">WorkflowID</span> <span class="kt">string</span> <span class="s">`json:&#34;workflow_id&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// WorkflowVersion å·¥ä½œæµç‰ˆæœ¬å·</span>
</span></span><span class="line"><span class="cl">			<span class="nx">WorkflowVersion</span> <span class="kt">string</span> <span class="s">`json:&#34;workflow_version&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// PluginID å…³è”çš„æ’ä»¶IDï¼ˆå¦‚æœå·¥ä½œæµåŸºäºæ’ä»¶ï¼‰</span>
</span></span><span class="line"><span class="cl">			<span class="nx">PluginID</span> <span class="kt">string</span> <span class="s">`json:&#34;plugin_id&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// PluginVersion æ’ä»¶ç‰ˆæœ¬å·</span>
</span></span><span class="line"><span class="cl">			<span class="nx">PluginVersion</span> <span class="kt">string</span> <span class="s">`json:&#34;plugin_version&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// IsDraft æ˜¯å¦ä¸ºè‰ç¨¿ç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl">			<span class="nx">IsDraft</span> <span class="kt">bool</span> <span class="s">`json:&#34;is_draft&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// FCSetting å‡½æ•°è°ƒç”¨è®¾ç½®</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// å®šä¹‰è°ƒç”¨è¯¥å·¥ä½œæµæ—¶çš„è¯·æ±‚å’Œå“åº”å‚æ•°ç»“æ„</span>
</span></span><span class="line"><span class="cl">			<span class="nx">FCSetting</span> <span class="o">*</span><span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="c1">// RequestParameters è¯·æ±‚å‚æ•°åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">				<span class="c1">// å®šä¹‰è°ƒç”¨å·¥ä½œæµæ—¶éœ€è¦ä¼ å…¥çš„å‚æ•°</span>
</span></span><span class="line"><span class="cl">				<span class="nx">RequestParameters</span> <span class="p">[]</span><span class="o">*</span><span class="nx">workflow</span><span class="p">.</span><span class="nx">APIParameter</span> <span class="s">`json:&#34;request_params&#34;`</span>
</span></span><span class="line"><span class="cl">				<span class="c1">// ResponseParameters å“åº”å‚æ•°åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">				<span class="c1">// å®šä¹‰å·¥ä½œæµæ‰§è¡Œå®Œæˆåè¿”å›çš„å‚æ•°</span>
</span></span><span class="line"><span class="cl">				<span class="nx">ResponseParameters</span> <span class="p">[]</span><span class="o">*</span><span class="nx">workflow</span><span class="p">.</span><span class="nx">APIParameter</span> <span class="s">`json:&#34;response_params&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span> <span class="s">`json:&#34;fc_setting,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="s">`json:&#34;workflowList,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="s">`json:&#34;workflowFCParam,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// PluginFCParam æ’ä»¶å‡½æ•°è°ƒç”¨å‚æ•°é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// é…ç½®å½“å‰å·¥ä½œæµå¯ä»¥è°ƒç”¨çš„æ’ä»¶APIåˆ—è¡¨åŠå…¶å‚æ•°è®¾ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="nx">PluginFCParam</span> <span class="o">*</span><span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// PluginList å¯è°ƒç”¨çš„æ’ä»¶åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// æ¯ä¸ªæ’ä»¶é¡¹åŒ…å«æ’ä»¶æ ‡è¯†ã€APIä¿¡æ¯å’Œå‡½æ•°è°ƒç”¨è®¾ç½®</span>
</span></span><span class="line"><span class="cl">		<span class="nx">PluginList</span> <span class="p">[]</span><span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// PluginID æ’ä»¶å”¯ä¸€æ ‡è¯†ç¬¦</span>
</span></span><span class="line"><span class="cl">			<span class="nx">PluginID</span> <span class="kt">string</span> <span class="s">`json:&#34;plugin_id&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// ApiId APIæ¥å£å”¯ä¸€æ ‡è¯†ç¬¦</span>
</span></span><span class="line"><span class="cl">			<span class="nx">ApiId</span> <span class="kt">string</span> <span class="s">`json:&#34;api_id&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// ApiName APIæ¥å£åç§°</span>
</span></span><span class="line"><span class="cl">			<span class="nx">ApiName</span> <span class="kt">string</span> <span class="s">`json:&#34;api_name&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// PluginVersion æ’ä»¶ç‰ˆæœ¬å·</span>
</span></span><span class="line"><span class="cl">			<span class="nx">PluginVersion</span> <span class="kt">string</span> <span class="s">`json:&#34;plugin_version&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// IsDraft æ˜¯å¦ä¸ºè‰ç¨¿ç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl">			<span class="nx">IsDraft</span> <span class="kt">bool</span> <span class="s">`json:&#34;is_draft&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// FCSetting å‡½æ•°è°ƒç”¨è®¾ç½®</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// å®šä¹‰è°ƒç”¨è¯¥æ’ä»¶APIæ—¶çš„è¯·æ±‚å’Œå“åº”å‚æ•°ç»“æ„</span>
</span></span><span class="line"><span class="cl">			<span class="nx">FCSetting</span> <span class="o">*</span><span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="c1">// RequestParameters è¯·æ±‚å‚æ•°åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">				<span class="c1">// å®šä¹‰è°ƒç”¨æ’ä»¶APIæ—¶éœ€è¦ä¼ å…¥çš„å‚æ•°</span>
</span></span><span class="line"><span class="cl">				<span class="nx">RequestParameters</span> <span class="p">[]</span><span class="o">*</span><span class="nx">workflow</span><span class="p">.</span><span class="nx">APIParameter</span> <span class="s">`json:&#34;request_params&#34;`</span>
</span></span><span class="line"><span class="cl">				<span class="c1">// ResponseParameters å“åº”å‚æ•°åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">				<span class="c1">// å®šä¹‰æ’ä»¶APIæ‰§è¡Œå®Œæˆåè¿”å›çš„å‚æ•°</span>
</span></span><span class="line"><span class="cl">				<span class="nx">ResponseParameters</span> <span class="p">[]</span><span class="o">*</span><span class="nx">workflow</span><span class="p">.</span><span class="nx">APIParameter</span> <span class="s">`json:&#34;response_params&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span> <span class="s">`json:&#34;fc_setting,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="s">`json:&#34;pluginFCParam,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// KnowledgeFCParam çŸ¥è¯†åº“å‡½æ•°è°ƒç”¨å‚æ•°é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// é…ç½®å½“å‰å·¥ä½œæµçš„çŸ¥è¯†åº“æ£€ç´¢åŠŸèƒ½åŠå…¶å…¨å±€è®¾ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="nx">KnowledgeFCParam</span> <span class="o">*</span><span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// GlobalSetting çŸ¥è¯†åº“æ£€ç´¢å…¨å±€è®¾ç½®</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å®šä¹‰çŸ¥è¯†åº“æ£€ç´¢çš„é€šç”¨é…ç½®å‚æ•°</span>
</span></span><span class="line"><span class="cl">		<span class="nx">GlobalSetting</span> <span class="o">*</span><span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// SearchMode æœç´¢æ¨¡å¼</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// å®šä¹‰çŸ¥è¯†åº“æ£€ç´¢ä½¿ç”¨çš„æœç´¢ç®—æ³•æ¨¡å¼</span>
</span></span><span class="line"><span class="cl">			<span class="nx">SearchMode</span> <span class="kt">int64</span> <span class="s">`json:&#34;search_mode&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// TopK è¿”å›ç»“æœæ•°é‡</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// å®šä¹‰çŸ¥è¯†åº“æ£€ç´¢è¿”å›çš„æœ€å¤§ç»“æœæ•°é‡</span>
</span></span><span class="line"><span class="cl">			<span class="nx">TopK</span> <span class="kt">int64</span> <span class="s">`json:&#34;top_k&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// MinScore æœ€å°ç›¸ä¼¼åº¦åˆ†æ•°</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// å®šä¹‰çŸ¥è¯†åº“æ£€ç´¢ç»“æœçš„æœ€å°ç›¸ä¼¼åº¦é˜ˆå€¼</span>
</span></span><span class="line"><span class="cl">			<span class="nx">MinScore</span> <span class="kt">float64</span> <span class="s">`json:&#34;min_score&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// UseNL2SQL æ˜¯å¦å¯ç”¨è‡ªç„¶è¯­è¨€è½¬SQLåŠŸèƒ½</span>
</span></span><span class="line"><span class="cl">			<span class="nx">UseNL2SQL</span> <span class="kt">bool</span> <span class="s">`json:&#34;use_nl2_sql&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// UseRewrite æ˜¯å¦å¯ç”¨æŸ¥è¯¢é‡å†™åŠŸèƒ½</span>
</span></span><span class="line"><span class="cl">			<span class="nx">UseRewrite</span> <span class="kt">bool</span> <span class="s">`json:&#34;use_rewrite&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// UseRerank æ˜¯å¦å¯ç”¨ç»“æœé‡æ’åºåŠŸèƒ½</span>
</span></span><span class="line"><span class="cl">			<span class="nx">UseRerank</span> <span class="kt">bool</span> <span class="s">`json:&#34;use_rerank&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// NoRecallReplyCustomizePrompt æ— å¬å›ç»“æœæ—¶çš„è‡ªå®šä¹‰å›å¤æç¤ºè¯</span>
</span></span><span class="line"><span class="cl">			<span class="nx">NoRecallReplyCustomizePrompt</span> <span class="kt">string</span> <span class="s">`json:&#34;no_recall_reply_customize_prompt&#34;`</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// NoRecallReplyMode æ— å¬å›ç»“æœæ—¶çš„å›å¤æ¨¡å¼</span>
</span></span><span class="line"><span class="cl">			<span class="nx">NoRecallReplyMode</span> <span class="kt">int64</span> <span class="s">`json:&#34;no_recall_reply_mode&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="s">`json:&#34;global_setting,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// KnowledgeList å¯æ£€ç´¢çš„çŸ¥è¯†åº“åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å®šä¹‰å½“å‰å·¥ä½œæµå¯ä»¥æ£€ç´¢çš„çŸ¥è¯†åº“é›†åˆ</span>
</span></span><span class="line"><span class="cl">		<span class="nx">KnowledgeList</span> <span class="p">[]</span><span class="o">*</span><span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// ID çŸ¥è¯†åº“å”¯ä¸€æ ‡è¯†ç¬¦</span>
</span></span><span class="line"><span class="cl">			<span class="nx">ID</span> <span class="kt">string</span> <span class="s">`json:&#34;id&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="s">`json:&#34;knowledgeList,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="s">`json:&#34;knowledgeFCParam,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol>
<li>å­å·¥ä½œæµè°ƒç”¨</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;workflowFCParam&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;workflowList&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;workflow_id&#34;</span><span class="p">:</span> <span class="s2">&#34;7509120431183544356&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;workflow_version&#34;</span><span class="p">:</span> <span class="s2">&#34;v0.0.1&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;plugin_id&#34;</span><span class="p">:</span> <span class="s2">&#34;7509121334769795126&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;is_draft&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;fc_setting&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;request_params&#34;</span><span class="p">:</span> <span class="p">[</span><span class="err">...</span><span class="p">],</span>  <span class="c1">// è°ƒç”¨å‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="nt">&#34;response_params&#34;</span><span class="p">:</span> <span class="p">[</span><span class="err">...</span><span class="p">]</span>  <span class="c1">// è¿”å›å‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol start="2">
<li>æ’ä»¶APIè°ƒç”¨</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;pluginFCParam&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pluginList&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;plugin_id&#34;</span><span class="p">:</span> <span class="s2">&#34;7509353177339133952&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;api_id&#34;</span><span class="p">:</span> <span class="s2">&#34;7509353598782816256&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;api_name&#34;</span><span class="p">:</span> <span class="s2">&#34;å‘¨å…¬è§£æ¢¦&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;plugin_version&#34;</span><span class="p">:</span> <span class="s2">&#34;0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;fc_setting&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;request_params&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;title&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nt">&#34;desc&#34;</span><span class="p">:</span> <span class="s2">&#34;æŸ¥è¯¢è§£æ¢¦æ ‡é¢˜ï¼Œä¾‹å¦‚ï¼šæ¢¦è§è›‡&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nt">&#34;is_required&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">],</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;response_params&#34;</span><span class="p">:</span> <span class="p">[</span><span class="err">...</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol start="3">
<li>çŸ¥è¯†åº“æ£€ç´¢</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;knowledgeFCParam&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;knowledgeList&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;7512369185624686592&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;æ—…æ¸¸æ™¯ç‚¹&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;global_setting&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;top_k&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">// 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;min_score&#34;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;search_mode&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;use_rerank&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;use_rewrite&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;use_nl2_sql&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;no_recall_reply_mode&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;no_recall_reply_customize_prompt&#34;</span><span class="p">:</span> <span class="s2">&#34;æŠ±æ­‰ï¼Œæ‚¨çš„é—®é¢˜è¶…å‡ºäº†æˆ‘çš„çŸ¥è¯†èŒƒå›´&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><h4 id="114blockinputç»“æ„">1.1.4Â BlockInputç»“æ„<a hidden class="anchor" aria-hidden="true" href="#114blockinputç»“æ„">#</a></h4>
<p><code>BlockInput</code>æ˜¯å·¥ä½œæµç³»ç»Ÿä¸­çš„æ•°æ®ç»‘å®šæ ¸å¿ƒï¼Œå®ƒè§£å†³äº†ä¸€ä¸ªå…³é”®é—®é¢˜ï¼šå¦‚ä½•åœ¨å·¥ä½œæµèŠ‚ç‚¹ä¹‹é—´ä¼ é€’å’Œé…ç½®æ•°æ®ã€‚<code>BlockInputÂ =Â &quot;è¿™ä¸ªè¾“å…¥æ¡†é‡Œæ”¾ä»€ä¹ˆæ•°æ®ï¼Œä»å“ªé‡Œæ¥&quot;</code></p>
<pre class="mermaid">graph TD
    A[BlockInput å—è¾“å…¥é…ç½®] --> B[Type: æ•°æ®ç±»å‹]
    A --> C[AssistType: è¾…åŠ©ç±»å‹]
    A --> D[Schema: ç»“æ„å®šä¹‰]
    A --> E[Value: è¾“å…¥å€¼é…ç½®]
    
    E --> F[BlockInputValue]
    F --> G[Type: å€¼ç±»å‹]
    F --> H[Content: å…·ä½“å†…å®¹]
    F --> I[RawMeta: å…ƒæ•°æ®]
    
    G --> G1[literal: å­—é¢å€¼]
    G --> G2[ref: èŠ‚ç‚¹å¼•ç”¨]
    G --> G3[object_ref: å¯¹è±¡å¼•ç”¨]
    
    H --> H1[é™æ€æ–‡æœ¬/æ•°å€¼]
    H --> H2[BlockInputReference]
    
    H2 --> J[BlockID: æºèŠ‚ç‚¹ID]
    H2 --> K[Name: å­—æ®µåç§°]
    H2 --> L[Path: è®¿é—®è·¯å¾„]
    H2 --> M[Source: å¼•ç”¨æºç±»å‹]
    
    M --> M1[block-output: èŠ‚ç‚¹è¾“å‡º]
    M --> M2[global_variable_app: åº”ç”¨å˜é‡]
    M --> M3[global_variable_system: ç³»ç»Ÿå˜é‡]
    M --> M4[global_variable_user: ç”¨æˆ·å˜é‡]
    
    N[å®é™…ä½¿ç”¨åœºæ™¯] --> N1[é™æ€é…ç½®: å›ºå®šå€¼]
    N --> N2[åŠ¨æ€ç»‘å®š: å¼•ç”¨å…¶ä»–èŠ‚ç‚¹]
    N --> N3[æ¨¡æ¿æ¸²æŸ“: å˜é‡æ›¿æ¢]
    N --> N4[å¤æ‚å¯¹è±¡: åµŒå¥—ç»“æ„]
    
    style A fill:#e1f5fe
    style F fill:#fff3e0
    style H2 fill:#f3e5f5
    style N fill:#e8f5e8
</pre>

<p><code>BlockInput</code>ç»“æ„å¦‚ä¸‹æ‰€ç¤º</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">BlockInput</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Type</span>       <span class="nx">VariableType</span>     <span class="c1">// æ•°æ®ç±»å‹ï¼šstringã€numberã€objectç­‰</span>
</span></span><span class="line"><span class="cl">    <span class="nx">AssistType</span> <span class="nx">AssistType</span>       <span class="c1">// è¾…åŠ©ç±»å‹ï¼šæ›´å…·ä½“çš„ç±»å‹æè¿°</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Schema</span>     <span class="kt">any</span>              <span class="c1">// ç»“æ„å®šä¹‰ï¼šå¤æ‚å¯¹è±¡çš„å†…éƒ¨ç»“æ„</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Value</span>      <span class="o">*</span><span class="nx">BlockInputValue</span> <span class="c1">// å€¼é…ç½®ï¼šå…·ä½“çš„æ•°æ®æ¥æº</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¸‰ç§æ•°æ®æµæ¥æºï¼šå¸¸é‡<code>literal</code>ã€èŠ‚ç‚¹å¼•ç”¨<code>ref</code>ã€å¯¹è±¡å¼•ç”¨Â <code>ObjectÂ Ref</code></p>
<ol>
<li>å¸¸é‡<code>literal</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="s">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;value&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="s">&#34;literal&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;content&#34;</span><span class="p">:</span> <span class="s">&#34;Hello World&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;rawMeta&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol start="2">
<li>èŠ‚ç‚¹å¼•ç”¨<code>ref</code>Â (æœ€å¸¸ç”¨çš„)</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="s">&#34;string&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="s">&#34;value&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="s">&#34;ref&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;content&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;blockID&#34;</span><span class="p">:</span> <span class="s">&#34;100001&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="s">&#34;output&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;source&#34;</span><span class="p">:</span> <span class="s">&#34;block-output&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol start="3">
<li>Â å¯¹è±¡å¼•ç”¨</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="s">&#34;object&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;schema&#34;</span><span class="p">:</span> <span class="p">[{</span><span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="s">&#34;string&#34;</span><span class="p">}],</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;value&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;type&#34;</span><span class="p">:</span> <span class="s">&#34;object_ref&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;content&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;blockID&#34;</span><span class="p">:</span> <span class="s">&#34;100001&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">      <span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="s">&#34;person&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;source&#34;</span><span class="p">:</span> <span class="s">&#34;block-output&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="115çŸ¥è¯†åº“èŠ‚ç‚¹rag">1.1.5Â çŸ¥è¯†åº“èŠ‚ç‚¹Â (RAG)<a hidden class="anchor" aria-hidden="true" href="#115çŸ¥è¯†åº“èŠ‚ç‚¹rag">#</a></h4>
<h5 id="ragå®Œæ•´æµç¨‹å›¾">RAGå®Œæ•´æµç¨‹å›¾<a hidden class="anchor" aria-hidden="true" href="#ragå®Œæ•´æµç¨‹å›¾">#</a></h5>
<p>ä¸€ä¸ªå®Œæ•´çš„RAGæµç¨‹å¦‚ä¸‹ï¼š</p>
<p>æŸ¥è¯¢é‡å†™ä¼˜åŒ–Â ï¼ˆå°æ¨¡å‹ï¼‰-&gt;Â è‡ªç„¶è¯­è¨€è½¬SQLÂ ï¼ˆNL2SQLï¼‰-&gt;Â å‘é‡æ£€ç´¢Â (è¯­ä¹‰æœç´¢/æ··åˆæœç´¢/å…¨é‡æœç´¢)Â -&gt;Â ç›¸ä¼¼åº¦è¿‡æ»¤Â (æœ€å°ç›¸ä¼¼åº¦é˜ˆå€¼)Â -&gt;Â ç»“æœé‡æ’åºÂ (Rerank)Â -&gt;Â TopKç»“æœæˆªå–Â -&gt;Â æ„å»ºæ–°çš„ä¸Šä¸‹æ–‡æç¤ºè¯</p>
<pre class="mermaid">graph LR
    A[ç”¨æˆ·è¾“å…¥æŸ¥è¯¢] --> B[æŸ¥è¯¢é¢„å¤„ç†]
    
    B --> B1[UseRewrite: æŸ¥è¯¢é‡å†™]
    B1 --> B2[ä¼˜åŒ–æŸ¥è¯¢è¯­ä¹‰]
    B2 --> B3[UseNL2SQL: è‡ªç„¶è¯­è¨€è½¬SQL]
    
    B3 --> C[å‘é‡æ£€ç´¢é˜¶æ®µ]
    C --> C1[æ–‡æ¡£å‘é‡åŒ–]
    C --> C2[æŸ¥è¯¢å‘é‡åŒ–] 
    C1 --> C3[å‘é‡ç›¸ä¼¼åº¦è®¡ç®—]
    C2 --> C3
    
    C3 --> D[SearchMode: æœç´¢ç­–ç•¥]
    D --> D1[0: è¯­ä¹‰æœç´¢<br/>Semantic Search]
    D --> D2[1: æ··åˆæœç´¢<br/>Hybrid Search]
    D --> D3[20: å…¨æ–‡æœç´¢<br/>Full-text Search]
    
    D1 --> E[åˆæ­¥ç»“æœç­›é€‰]
    D2 --> E
    D3 --> E
    
    E --> E1[MinScore: ç›¸ä¼¼åº¦è¿‡æ»¤]
    E1 --> E2[è¿‡æ»¤ä½è´¨é‡ç»“æœ]
    
    E2 --> F[UseRerank: ç»“æœé‡æ’åº]
    F --> F1[æ·±åº¦è¯­ä¹‰åŒ¹é…]
    F1 --> F2[é‡æ–°æ’åºç»“æœ]
    
    F2 --> G[TopK: ç»“æœæˆªå–]
    G --> G1[é€‰æ‹©å‰Kä¸ªæœ€ä½³ç»“æœ]
    
    G1 --> H{æ˜¯å¦æœ‰åˆé€‚ç»“æœ?}
    H -->|æœ‰| I[æ„å»ºå¢å¼ºä¸Šä¸‹æ–‡]
    H -->|æ— | J[NoRecallReplyModeå¤„ç†]
    
    J --> J1[0: ä½¿ç”¨è‡ªå®šä¹‰æç¤ºè¯]
    J --> J2[1: å…¶ä»–å¤„ç†æ¨¡å¼]
    J1 --> K[è¿”å›æ— ç»“æœå›å¤]
    J2 --> K
    
    I --> L[RAGç”Ÿæˆé˜¶æ®µ]
    L --> L1[ç»„åˆæŸ¥è¯¢+æ£€ç´¢å†…å®¹]
    L1 --> L2[LLMç”Ÿæˆå¢å¼ºå›ç­”]
    
    L2 --> M[è¿”å›æœ€ç»ˆç­”æ¡ˆ]
    K --> M
    
    style A fill:#e1f5fe
    style B fill:#fff3e0
    style C fill:#f3e5f5
    style D fill:#e8f5e8
    style F fill:#fce4ec
    style L fill:#e0f2f1
</pre>

<h5 id="å‘é‡æ£€ç´¢è§„åˆ™">å‘é‡æ£€ç´¢è§„åˆ™<a hidden class="anchor" aria-hidden="true" href="#å‘é‡æ£€ç´¢è§„åˆ™">#</a></h5>
<pre class="mermaid">graph TD
    A[ç”¨æˆ·æŸ¥è¯¢] --> B{SearchModeé€‰æ‹©}
    
    B -->|0: è¯­ä¹‰æœç´¢| C[Semantic Search]
    B -->|1: æ··åˆæœç´¢| D[Hybrid Search]  
    B -->|20: å…¨æ–‡æœç´¢| E[Full-text Search]
    
    C --> C1[Step1: æŸ¥è¯¢å‘é‡åŒ–]
    C1 --> C2[Embedding Model]
    C2 --> C3[Query Vector]
    
    C3 --> C4[Step2: æ–‡æ¡£å‘é‡åŒ¹é…]
    C4 --> C5[å‘é‡æ•°æ®åº“]
    C5 --> C6[ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—]
    
    D --> D1[Step1: å‘é‡æœç´¢è·¯å¾„]
    D --> D2[Step2: å…³é”®è¯æœç´¢è·¯å¾„]
    
    D1 --> D3[Embeddingæ£€ç´¢]
    D2 --> D4[BM25ç®—æ³•]
    D3 --> D5[ç»“æœèåˆç®—æ³•]
    D4 --> D5
    
    E --> E1[Step1: åˆ†è¯å¤„ç†]
    E1 --> E2[åˆ†è¯å™¨]
    E2 --> E3[Step2: å€’æ’ç´¢å¼•]
    E3 --> E4[æœç´¢å¼•æ“]
    E4 --> E5[TF-IDFè¯„åˆ†]
    
    C6 --> F[è¯­ä¹‰ç†è§£å¼º]
    D5 --> G[å¹³è¡¡ç²¾ç¡®æ€§å’Œè¯­ä¹‰]
    E5 --> H[å…³é”®è¯ç²¾ç¡®åŒ¹é…]
    
    F --> I[æœ€ç»ˆæ£€ç´¢ç»“æœ]
    G --> I
    H --> I
    
    style C fill:#e1f5fe
    style D fill:#fff3e0
    style E fill:#f3e5f5
    style I fill:#e8f5e8
</pre>

<ol>
<li>
<p>è¯­ä¹‰æœç´¢Â ï¼ˆå‡†ï¼‰:Â ä½¿ç”¨Â EmbeddingÂ æ¨¡å‹è®¡ç®—å‘é‡ç›¸ä¼¼åº¦ï¼Œç†è§£æ·±å±‚è¯­ä¹‰ï¼Œå¤„ç†åŒä¹‰è¯å’Œæ¦‚å¿µåŒ¹é…ã€‚</p>
</li>
<li>
<p>æ··åˆæœç´¢Â ï¼ˆå…¨é¢ï¼‰:Â ç»“åˆå‘é‡æœç´¢Â +Â BM25Â å…³é”®è¯æœç´¢ï¼Œå¹³è¡¡è¯­ä¹‰ç†è§£å’Œç²¾ç¡®åŒ¹é…ã€‚</p>
</li>
<li>
<p>å…¨æ–‡æœç´¢Â ï¼ˆå¿«ï¼‰:Â ä¼ ç»Ÿçš„å€’æ’ç´¢å¼•å’ŒTF-IDFï¼Œç²¾ç¡®çš„å…³é”®è¯åŒ¹é…ï¼Œé€Ÿåº¦å¿«</p>
</li>
</ol>
<p>ã€ç®—æ³•è¯´æ˜ã€‘</p>
<ul>
<li>Embeddingå‘é‡æ£€ç´¢ï¼šå°†æ–‡æœ¬é€šè¿‡ç¼–ç å™¨è½¬ä¸ºå‘é‡å’ŒDBä¸­çš„å‘é‡è®¡ç®—cosç›¸ä¼¼åº¦æœ€åè¿”å›TopKçš„ç»“æœ</li>
</ul>
<pre class="mermaid">graph TD
    A[æ–‡æœ¬è¾“å…¥] --> B[Embeddingæ£€ç´¢æµç¨‹]
    
    B --> C[ç¬¬ä¸€é˜¶æ®µ: å‘é‡åŒ–]
    C --> C1[åˆ†è¯å’Œé¢„å¤„ç†]
    C1 --> C2[Transformerç¼–ç å™¨]
    C2 --> C3[æ± åŒ–æ“ä½œ]
    C3 --> C4[å½’ä¸€åŒ–å¤„ç†]
    C4 --> C5[ç”Ÿæˆå‘é‡è¡¨ç¤º]
    
    B --> D[ç¬¬äºŒé˜¶æ®µ: ç´¢å¼•æ„å»º]
    D --> D1[å‘é‡ç»´åº¦ä¼˜åŒ–]
    D1 --> D2[ç´¢å¼•ç»“æ„é€‰æ‹©]
    D2 --> D3[HNSW/IVF/LSH]
    D3 --> D4[åˆ†å¸ƒå¼å­˜å‚¨]
    
    B --> E[ç¬¬ä¸‰é˜¶æ®µ: ç›¸ä¼¼åº¦æ£€ç´¢]
    E --> E1[æŸ¥è¯¢å‘é‡åŒ–]
    E1 --> E2[è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢]
    E2 --> E3[ç›¸ä¼¼åº¦è®¡ç®—]
    E3 --> E4[TopKç»“æœè¿”å›]
    
    F[æŠ€æœ¯æ ˆ] --> F1[æ¨¡å‹: BERT/Sentence-BERT]
    F --> F2[å‘é‡DB: Pinecone/Milvus/ElasticSearch]
    F --> F3[ç›¸ä¼¼åº¦: ä½™å¼¦/ç‚¹ç§¯/æ¬§æ°]
    F --> F4[ç´¢å¼•: HNSW/IVF]
    
    style C fill:#e1f5fe
    style D fill:#fff3e0
    style E fill:#f3e5f5
    style F fill:#e8f5e8
</pre>

<ul>
<li>
<p>å€’æ’ç´¢å¼•ï¼šå°†æ–‡æ¡£åˆ‡åˆ†æˆç‹¬ç«‹çš„è¯æ±‡å•å…ƒï¼Œå»ºç«‹ä»è¯æ±‡åˆ°æ–‡æ¡£çš„æ˜ å°„ç´¢å¼•</p>
</li>
<li>
<p>TF-IDFÂ (è¯é¢‘-é€†æ–‡æ¡£é¢‘ç‡)ï¼šTFï¼ˆè¯é¢‘ï¼‰ï¼šÂ è®¡ç®—ä¸€ä¸ªè¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„è¯æ¬¡æ•°ï¼ŒÂ ç”¨äºè¡¡é‡è¯æ±‡çš„é‡è¦æ€§ã€‚IDFÂ ï¼ˆé€†æ–‡æ¡£é¢‘ç‡ï¼‰ï¼šè¡¡é‡è¯æ±‡åœ¨æ•´ä¸ªè¯­æ–™åº“ä¸­çš„é‡è¦æ€§ã€‚Â </p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">TF</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">è¯æ±‡tåœ¨æ–‡æ¡£dä¸­å‡ºç°çš„æ¬¡æ•°</span> <span class="o">/</span> <span class="n">æ–‡æ¡£dçš„æ€»è¯æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">IDF</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">æ–‡æ¡£æ€»æ•°</span> <span class="o">/</span> <span class="n">åŒ…å«è¯æ±‡tçš„æ–‡æ¡£æ•°</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">TF</span><span class="o">-</span><span class="n">IDF</span> <span class="o">=</span> <span class="n">sigmoid</span> <span class="p">(</span><span class="n">TF</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="n">IDF</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</span></span></code></pre></div><p>ç¼ºç‚¹ï¼šä¸èƒ½è€ƒè™‘è¯æ±‡çš„ä½ç½®ï¼Œå¿½ç•¥äº†è¯æ±‡çš„ç›¸å…³æ€§ï¼›ä¸åˆ©äºç¨€ç–æ€§Â ï¼ˆçŸ­æ–‡æ¡£å¾ˆå¤šè¯æ±‡Â <code>TF-IDF=0</code>ï¼‰</p>
<ul>
<li>BM25Â ç®—æ³•ï¼šåœ¨Â <code>TF-IDF</code>Â (è¯é¢‘-é€†æ–‡æ¡£é¢‘ç‡)Â åŸºç¡€ä¸Šï¼Œè§£å†³äº†è¯é¢‘é¥±å’Œé—®é¢˜å’Œæ–‡æ¡£é•¿åº¦å½’ä¸€åŒ–é—®é¢˜ã€‚</li>
</ul>
<h5 id="rerankè§„åˆ™">ReRankÂ è§„åˆ™<a hidden class="anchor" aria-hidden="true" href="#rerankè§„åˆ™">#</a></h5>
<h5 id="çŸ¥è¯†åº“èŠ‚ç‚¹ç»“æ„">çŸ¥è¯†åº“èŠ‚ç‚¹ç»“æ„<a hidden class="anchor" aria-hidden="true" href="#çŸ¥è¯†åº“èŠ‚ç‚¹ç»“æ„">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// Knowledge çŸ¥è¯†åº“èŠ‚ç‚¹é…ç½®</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ç”¨äºé…ç½®ç‹¬ç«‹çš„çŸ¥è¯†åº“æ£€ç´¢èŠ‚ç‚¹ï¼Œå®šä¹‰æ•°æ®æºå‚æ•°å’Œå¤„ç†ç­–ç•¥</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸LLMèŠ‚ç‚¹ä¸­çš„KnowledgeFCParamä¸åŒï¼Œè¿™æ˜¯ä¸“é—¨çš„çŸ¥è¯†åº“æ£€ç´¢æ­¥éª¤</span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Knowledge</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// DatasetParam æ•°æ®é›†å‚æ•°é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// å®šä¹‰çŸ¥è¯†åº“çš„æ•°æ®æºé…ç½®ï¼ŒåŒ…æ‹¬æ•°æ®åº“è¿æ¥ã€æ–‡ä»¶è·¯å¾„ç­‰ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// æ¯ä¸ªParamåŒ…å«å…·ä½“çš„æ•°æ®æºé…ç½®é¡¹</span>
</span></span><span class="line"><span class="cl">	<span class="nx">DatasetParam</span> <span class="p">[]</span><span class="o">*</span><span class="nx">Param</span> <span class="s">`json:&#34;datasetParam,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// StrategyParam çŸ¥è¯†åº“å¤„ç†ç­–ç•¥å‚æ•°</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// å®šä¹‰æ–‡æ¡£è§£æã€åˆ†å—ã€ç´¢å¼•ç­‰å„ä¸ªç¯èŠ‚çš„å¤„ç†ç­–ç•¥å’Œå‚æ•°</span>
</span></span><span class="line"><span class="cl">	<span class="nx">StrategyParam</span> <span class="nx">StrategyParam</span> <span class="s">`json:&#34;strategyParam,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// StrategyParam çŸ¥è¯†åº“å¤„ç†ç­–ç•¥å‚æ•°é…ç½®</span>
</span></span><span class="line"><span class="cl"><span class="c1">// å®šä¹‰çŸ¥è¯†åº“ä»æ–‡æ¡£è§£æåˆ°å‘é‡ç´¢å¼•çš„å®Œæ•´å¤„ç†æµç¨‹ç­–ç•¥</span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">StrategyParam</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// ParsingStrategy æ–‡æ¡£è§£æç­–ç•¥é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// å®šä¹‰å¦‚ä½•è§£æå’Œæå–ä¸åŒç±»å‹æ–‡æ¡£çš„å†…å®¹</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ParsingStrategy</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// ParsingType è§£æç±»å‹</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å®šä¹‰æ–‡æ¡£è§£æçš„æ–¹å¼ï¼Œå¦‚è‡ªåŠ¨è¯†åˆ«ã€æ‰‹åŠ¨æŒ‡å®šç­‰</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å¸¸è§å€¼ï¼šautoï¼ˆè‡ªåŠ¨è¯†åˆ«ï¼‰ã€manualï¼ˆæ‰‹åŠ¨æŒ‡å®šï¼‰ã€customï¼ˆè‡ªå®šä¹‰ï¼‰</span>
</span></span><span class="line"><span class="cl">		<span class="nx">ParsingType</span> <span class="kt">string</span> <span class="s">`json:&#34;parsingType,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// ImageExtraction æ˜¯å¦æå–å›¾ç‰‡</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// æ§åˆ¶æ˜¯å¦ä»æ–‡æ¡£ä¸­æå–å›¾ç‰‡å†…å®¹è¿›è¡Œå¤„ç†</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// trueè¡¨ç¤ºæå–å›¾ç‰‡ï¼Œfalseè¡¨ç¤ºå¿½ç•¥å›¾ç‰‡å†…å®¹</span>
</span></span><span class="line"><span class="cl">		<span class="nx">ImageExtraction</span> <span class="kt">bool</span> <span class="s">`json:&#34;imageExtraction&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// TableExtraction æ˜¯å¦æå–è¡¨æ ¼</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// æ§åˆ¶æ˜¯å¦ä»æ–‡æ¡£ä¸­æå–è¡¨æ ¼ç»“æ„å’Œæ•°æ®</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// trueè¡¨ç¤ºè§£æè¡¨æ ¼ç»“æ„ï¼Œfalseè¡¨ç¤ºå°†è¡¨æ ¼è§†ä¸ºæ™®é€šæ–‡æœ¬</span>
</span></span><span class="line"><span class="cl">		<span class="nx">TableExtraction</span> <span class="kt">bool</span> <span class="s">`json:&#34;tableExtraction&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// ImageOcr æ˜¯å¦å¯ç”¨å›¾ç‰‡OCRè¯†åˆ«</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// æ§åˆ¶æ˜¯å¦å¯¹æå–çš„å›¾ç‰‡è¿›è¡Œå…‰å­¦å­—ç¬¦è¯†åˆ«</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// trueè¡¨ç¤ºå¯¹å›¾ç‰‡è¿›è¡ŒOCRæ–‡å­—è¯†åˆ«ï¼Œfalseè¡¨ç¤ºå¿½ç•¥å›¾ç‰‡ä¸­çš„æ–‡å­—</span>
</span></span><span class="line"><span class="cl">		<span class="nx">ImageOcr</span> <span class="kt">bool</span> <span class="s">`json:&#34;imageOcr&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="s">`json:&#34;parsingStrategy,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// ChunkStrategy æ–‡æ¡£åˆ†å—ç­–ç•¥é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// å®šä¹‰å¦‚ä½•å°†é•¿æ–‡æ¡£åˆ‡åˆ†æˆé€‚åˆå‘é‡åŒ–çš„å°å—</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ChunkStrategy</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// ChunkType åˆ†å—ç±»å‹</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å®šä¹‰æ–‡æ¡£åˆ†å—çš„ç­–ç•¥ç±»å‹</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å¸¸è§å€¼ï¼šfixedï¼ˆå›ºå®šé•¿åº¦ï¼‰ã€semanticï¼ˆè¯­ä¹‰åˆ†å—ï¼‰ã€sentenceï¼ˆå¥å­åˆ†å—ï¼‰</span>
</span></span><span class="line"><span class="cl">		<span class="nx">ChunkType</span> <span class="kt">string</span> <span class="s">`json:&#34;chunkType,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// SeparatorType åˆ†éš”ç¬¦ç±»å‹</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å®šä¹‰ç”¨äºåˆ†å—çš„åˆ†éš”ç¬¦ç±»å‹</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å¸¸è§å€¼ï¼šautoï¼ˆè‡ªåŠ¨é€‰æ‹©ï¼‰ã€newlineï¼ˆæ¢è¡Œç¬¦ï¼‰ã€paragraphï¼ˆæ®µè½ï¼‰ã€customï¼ˆè‡ªå®šä¹‰ï¼‰</span>
</span></span><span class="line"><span class="cl">		<span class="nx">SeparatorType</span> <span class="kt">string</span> <span class="s">`json:&#34;separatorType,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Separator è‡ªå®šä¹‰åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å½“SeparatorTypeä¸ºcustomæ—¶ï¼ŒæŒ‡å®šå…·ä½“çš„åˆ†éš”ç¬¦å­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Separator</span> <span class="kt">string</span> <span class="s">`json:&#34;separator,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// MaxToken æœ€å¤§ä»¤ç‰Œæ•°</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å®šä¹‰æ¯ä¸ªæ–‡æ¡£å—çš„æœ€å¤§tokenæ•°é‡ï¼Œæ§åˆ¶å—çš„å¤§å°</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// é€šå¸¸è®¾ç½®ä¸ºæ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£å¤§å°ï¼Œå¦‚512ã€1024ç­‰</span>
</span></span><span class="line"><span class="cl">		<span class="nx">MaxToken</span> <span class="kt">int64</span> <span class="s">`json:&#34;maxToken,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Overlap é‡å æ¯”ä¾‹</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å®šä¹‰ç›¸é‚»æ–‡æ¡£å—ä¹‹é—´çš„é‡å æ¯”ä¾‹ï¼Œé¿å…è¯­ä¹‰ä¿¡æ¯åœ¨è¾¹ç•Œå¤„ä¸¢å¤±</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// å–å€¼èŒƒå›´0.0-1.0ï¼Œå¸¸è§å€¼ä¸º0.1-0.2ï¼ˆ10%-20%é‡å ï¼‰</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Overlap</span> <span class="kt">float64</span> <span class="s">`json:&#34;overlap,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="s">`json:&#34;chunkStrategy,omitempty&#34;`</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// IndexStrategy ç´¢å¼•ç­–ç•¥é…ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// å®šä¹‰å‘é‡ç´¢å¼•çš„æ„å»ºç­–ç•¥ï¼Œå¦‚ç´¢å¼•ç±»å‹ã€å‚æ•°ç­‰</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// å…·ä½“ç»“æ„ä¾èµ–äºä½¿ç”¨çš„å‘é‡æ•°æ®åº“ç±»å‹ï¼ˆå¦‚HNSWã€IVFç­‰ï¼‰</span>
</span></span><span class="line"><span class="cl">	<span class="nx">IndexStrategy</span> <span class="kt">any</span> <span class="s">`json:&#34;indexStrategy&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>

  </div>



  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://swimmingliu.cn/tags/java/">Java</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="https://swimmingliu.cn/posts/job/leetcode-hot100-notes/">
    <span class="title">Next Â»</span>
    <br>
    <span>Leetcode Hot100 åˆ·é¢˜ç¬”è®°</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2023-2025 <a href="https://swimmingliu.cn/">SwimmingLiu&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
    <span>
        <a href="https://beian.miit.gov.cn/">æµ™ICPå¤‡2024056260å·</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>


  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script>

