<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>è®¾è®¡æ¨¡å¼é¢è¯•é¢˜ç¬”è®° | SwimmingLiu&#39;s Blog</title>
<meta name="keywords" content="Java, Design Mode">
<meta name="description" content="1. å•ä¾‹æ¨¡å¼æœ‰å“ªå‡ ç§å®ç°ï¼Ÿå¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Ÿ
é¦–å…ˆï¼Œå•ä¾‹æ¨¡å¼å’Œå·¥å‚æ¨¡å¼éƒ½æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ã€‚å•ä¾‹æ¨¡å¼å½“ä¸­ï¼Œä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡(æˆ–è€…è¯´å®ä¾‹)ï¼Œ é‚£è¿™ä¸ªç±»å°±æ˜¯å•ä¾‹ç±»ã€‚å•ä¾‹ç±»æ˜¯ä¸å¯ä»¥è¢«ç»§æ‰¿çš„ï¼Œä¹Ÿæ²¡æœ‰äº†å¤šæ€çš„ç‰¹æ€§ã€‚
ã€å•ä¾‹ç±»çš„å®ç°æ–¹å¼ã€‘
å¸¸è§„å•ä¾‹æ¨¡å¼æœ‰äº”ç§å†™æ³•ï¼Œä½†æ˜¯ç¼–å†™ä»£ç çš„è¿‡ç¨‹å½“ä¸­ï¼Œè¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

æ„é€ å™¨éœ€è¦ç§æœ‰åŒ–
æš´éœ²ä¸€ä¸ªå…¬å…±è·å–å•ä¾‹å¯¹è±¡çš„æ¥å£ ï¼ˆobj.getInstance()ï¼‰
æ˜¯å¦æ”¯æŒæ‡’åŠ è½½ å»¶è¿ŸåŠ è½½
æ˜¯å¦çº¿ç¨‹å®‰å…¨

äº”ç§å†™æ³•ä¸ºï¼š


é¥¿æ±‰å¼ï¼š ç±»åŠ è½½çš„æ—¶å€™ï¼Œå°±ä¸€èµ·æŠŠ instance é™æ€å®ä¾‹åˆ›å»ºå¥½äº†ï¼Œæ‰€ä»¥åˆ›å»ºçš„è¿‡ç¨‹å¸‚çº¿ç¨‹å®‰å…¨çš„ã€‚
é¥¿æ±‰å¼çš„å•ä¾‹æ¨¡å¼è™½ç„¶ä¸æ”¯æŒæ‡’åŠ è½½ï¼Œæœ‰ç‚¹æµªè´¹èµ„æºã€‚ä½†å…¶å®ä¸ä¼šå ç”¨å¤ªå¤šèµ„æºï¼Œå¹¶ä¸”å¦‚æœä¸€ä¸ªå®ä¾‹åˆå§‹åŒ–çš„è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå°±åº”è¯¥æ”¾åœ¨å¯åŠ¨çš„æ—¶å€™æ¥å¤„ç†ï¼Œé¿å…è¿è¡Œæ—¶å¡é¡¿æˆ–å‘ç”Ÿé—®é¢˜ï¼Œ æ»¡è¶³fail-fast å¤±è´¥å¿«é€Ÿè§£å†³çš„è®¾è®¡åŸåˆ™
public class EagerSingleton {  
    private static Singleton instance = new Singleton();  
    private Singleton (){}  
    public static Singleton getInstance() {  
    	return instance;  
    }  
}


æ‡’æ±‰å¼ï¼šç›¸è¾ƒäºé¥¿æ±‰å¼çš„æ–¹å¼ï¼Œä¿®æ”¹æˆå»¶è¿ŸåŠ è½½çš„æ¨¡å¼ã€‚æ³¨æ„getInstance()æ–¹æ³•æ²¡æœ‰ä¸Šé”çš„è¯ï¼Œåœ¨å¤§é‡çº¿ç¨‹å¹¶å‘è¯·æ±‚çš„æ—¶å€™ï¼Œå¯èƒ½åˆ›å»ºå¤šä¸ªå®ä¾‹ã€‚
public class Singleton {  
    private static Singleton instance;  
    private Singleton (){}  
    public synchronized static Singleton getInstance() {  
        if (instance == null) {  
            instance = new Singleton();  
        }  
        return instance;  
    }  
}


åŒé‡æ£€æŸ¥é”ï¼šé¥¿æ±‰å¼é”ä¸æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œç„¶åæ‡’æ±‰å¼é”çš„ç²’åº¦æ¯”è¾ƒå¤§ï¼Œä¸æ”¯æŒé«˜å¹¶å‘ã€‚åŒé‡æ£€æŸ¥é”å¯ä»¥å®ç°æ—¢å»¶è¿ŸåŠ è½½ï¼Œåˆæ”¯æŒé«˜å¹¶å‘ã€‚å…¶å®å°±æ˜¯åœ¨åˆ¤æ–­äº†æ²¡æœ‰å®ä¾‹ä¹‹åï¼Œå†è¿›è¡Œä¸Šé”ï¼Œåˆ›å»ºå®ä¾‹ã€‚ ä½†æ˜¯å®ä¾‹å¿…é¡»ç”¨volatile ä¿®é¥°ï¼Œä¸ç„¶new æ“ä½œåˆ›å»ºå¯¹è±¡æ—¶ï¼Œå®¹æ˜“å‡ºç°é‡æ’åºçš„é—®é¢˜ã€‚">
<meta name="author" content="SwimmingLiu">
<link rel="canonical" href="https://swimmingliu.cn/posts/job/desgin-mode-interview-questions/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6ecbb0040febd20e47edd88a662c19f1ea945bf7427774b86594271d18f88faf.css" integrity="sha256-bsuwBA/r0g5H7diKZiwZ8eqUW/dCd3S4ZZQnHRj4j68=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="apple-touch-icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="mask-icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://swimmingliu.cn/posts/job/desgin-mode-interview-questions/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            
            
            delimiters: [
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false },
                { left: '\\(', right: '\\)', display: false },
                { left: '\\[', right: '\\]', display: true }
            ],
            
            throwOnError: false
        });
    });
</script>



</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://swimmingliu.cn/" accesskey="h" title="ğ“¢ğ”€ğ“²ğ“¶ğ“¶ğ“²ğ“·ğ“°ğ“›ğ“²ğ“¾&#39;ğ“¼ ğ“‘ğ“µğ“¸ğ“° (Alt + H)">
                <img src="https://swimmingliu.cn/images/swimmingliu_icon.png" alt="" aria-label="logo"
                    height="30">ğ“¢ğ”€ğ“²ğ“¶ğ“¶ğ“²ğ“·ğ“°ğ“›ğ“²ğ“¾&#39;ğ“¼ ğ“‘ğ“µğ“¸ğ“°</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://swimmingliu.cn/index.html" title="ğŸ¡ Home">
                    <span>ğŸ¡ Home</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/search/" title="ğŸ” Search">
                    <span>ğŸ” Search</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/posts/" title="ğŸ—’ï¸ Posts">
                    <span>ğŸ—’ï¸ Posts</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/archives/" title="ğŸ“ƒ Archive">
                    <span>ğŸ“ƒ Archive</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/tags/" title="ğŸ“‘ Tags">
                    <span>ğŸ“‘ Tags</span>
                </a>
            </li>
            <li>
                <a href="https://bento.me/swimmingliu" title="ğŸ‘¨ğŸ»â€ğŸ“ About Me">
                    <span>ğŸ‘¨ğŸ»â€ğŸ“ About Me</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://www.emojisearch.app/" title="Emoji">
                    <span>Emoji</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://swimmingliu.cn/">Home</a>&nbsp;Â»&nbsp;<a href="https://swimmingliu.cn/posts/">ğŸ“š Posts</a>&nbsp;Â»&nbsp;<a href="https://swimmingliu.cn/posts/job/">ğŸ’» Job</a></div>
    <h1 class="post-title entry-hint-parent">
      è®¾è®¡æ¨¡å¼é¢è¯•é¢˜ç¬”è®°
    </h1>
    <div class="post-meta"><span title='2025-03-07 21:44:36 +0800 CST'>March 7, 2025</span>&nbsp;Â·&nbsp;5 min&nbsp;Â·&nbsp;SwimmingLiu

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#1-%e5%8d%95%e4%be%8b%e6%a8%a1%e5%bc%8f%e6%9c%89%e5%93%aa%e5%87%a0%e7%a7%8d%e5%ae%9e%e7%8e%b0%e5%a6%82%e4%bd%95%e4%bf%9d%e8%af%81%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8" aria-label="1. å•ä¾‹æ¨¡å¼æœ‰å“ªå‡ ç§å®ç°ï¼Ÿå¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Ÿ">1. å•ä¾‹æ¨¡å¼æœ‰å“ªå‡ ç§å®ç°ï¼Ÿå¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Ÿ</a></li>
                <li>
                    <a href="#2-%e4%bb%80%e4%b9%88%e6%98%af%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f%e4%b8%80%e8%88%ac%e7%94%a8%e5%9c%a8%e4%bb%80%e4%b9%88%e5%9c%ba%e6%99%af" aria-label="2. ä»€ä¹ˆæ˜¯ç­–ç•¥æ¨¡å¼ï¼Ÿä¸€èˆ¬ç”¨åœ¨ä»€ä¹ˆåœºæ™¯ï¼Ÿ">2. ä»€ä¹ˆæ˜¯ç­–ç•¥æ¨¡å¼ï¼Ÿä¸€èˆ¬ç”¨åœ¨ä»€ä¹ˆåœºæ™¯ï¼Ÿ</a></li>
                <li>
                    <a href="#3-%e4%bb%80%e4%b9%88%e6%98%af%e6%a8%a1%e6%9d%bf%e6%96%b9%e6%b3%95%e6%a8%a1%e5%bc%8f%e4%b8%80%e8%88%ac%e7%94%a8%e5%9c%a8%e4%bb%80%e4%b9%88%e5%9c%ba%e6%99%af" aria-label="3. ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Ÿä¸€èˆ¬ç”¨åœ¨ä»€ä¹ˆåœºæ™¯ï¼Ÿ">3. ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Ÿä¸€èˆ¬ç”¨åœ¨ä»€ä¹ˆåœºæ™¯ï¼Ÿ</a></li>
                <li>
                    <a href="#4-%e8%b0%88%e8%b0%88%e4%bd%a0%e4%ba%86%e8%a7%a3%e7%9a%84%e6%9c%80%e5%b8%b8%e8%a7%81%e7%9a%84%e5%87%a0%e7%a7%8d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e8%af%b4%e8%af%b4%e4%bb%96%e4%bb%ac%e7%9a%84%e5%ba%94%e7%94%a8%e5%9c%ba%e6%99%af" aria-label="4. è°ˆè°ˆä½ äº†è§£çš„æœ€å¸¸è§çš„å‡ ç§è®¾è®¡æ¨¡å¼ï¼Œè¯´è¯´ä»–ä»¬çš„åº”ç”¨åœºæ™¯">4. è°ˆè°ˆä½ äº†è§£çš„æœ€å¸¸è§çš„å‡ ç§è®¾è®¡æ¨¡å¼ï¼Œè¯´è¯´ä»–ä»¬çš„åº”ç”¨åœºæ™¯</a></li>
                <li>
                    <a href="#5-%e4%bd%a0%e8%ae%a4%e4%b8%ba%e5%a5%bd%e7%9a%84%e4%bb%a3%e7%a0%81%e5%ba%94%e8%af%a5%e6%98%af%e4%bb%80%e4%b9%88%e6%a0%b7%e7%9a%84" aria-label="5. ä½ è®¤ä¸ºå¥½çš„ä»£ç åº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ">5. ä½ è®¤ä¸ºå¥½çš„ä»£ç åº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</a></li>
                <li>
                    <a href="#6-%e5%b7%a5%e5%8e%82%e6%a8%a1%e5%bc%8f%e5%92%8c%e6%8a%bd%e8%b1%a1%e5%b7%a5%e5%8e%82%e6%a8%a1%e5%bc%8f%e6%9c%89%e4%bb%80%e4%b9%88%e5%8c%ba%e5%88%ab" aria-label="6. å·¥å‚æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ">6. å·¥å‚æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a>
                </li>
            </ul>
        </div>
    </details>
</div>
  <div class="post-content"><h2 id="1-å•ä¾‹æ¨¡å¼æœ‰å“ªå‡ ç§å®ç°å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨">1. å•ä¾‹æ¨¡å¼æœ‰å“ªå‡ ç§å®ç°ï¼Ÿå¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#1-å•ä¾‹æ¨¡å¼æœ‰å“ªå‡ ç§å®ç°å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨">#</a></h2>
<p>é¦–å…ˆï¼Œå•ä¾‹æ¨¡å¼å’Œå·¥å‚æ¨¡å¼éƒ½æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ã€‚å•ä¾‹æ¨¡å¼å½“ä¸­ï¼Œä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡(æˆ–è€…è¯´å®ä¾‹)ï¼Œ é‚£è¿™ä¸ªç±»å°±æ˜¯å•ä¾‹ç±»ã€‚å•ä¾‹ç±»æ˜¯ä¸å¯ä»¥è¢«ç»§æ‰¿çš„ï¼Œä¹Ÿæ²¡æœ‰äº†å¤šæ€çš„ç‰¹æ€§ã€‚</p>
<p><strong>ã€å•ä¾‹ç±»çš„å®ç°æ–¹å¼ã€‘</strong></p>
<p>å¸¸è§„å•ä¾‹æ¨¡å¼æœ‰äº”ç§å†™æ³•ï¼Œä½†æ˜¯ç¼–å†™ä»£ç çš„è¿‡ç¨‹å½“ä¸­ï¼Œè¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li>æ„é€ å™¨éœ€è¦ç§æœ‰åŒ–</li>
<li>æš´éœ²ä¸€ä¸ªå…¬å…±è·å–å•ä¾‹å¯¹è±¡çš„æ¥å£ ï¼ˆ<code>obj.getInstance()</code>ï¼‰</li>
<li>æ˜¯å¦æ”¯æŒæ‡’åŠ è½½ <code>å»¶è¿ŸåŠ è½½</code></li>
<li>æ˜¯å¦çº¿ç¨‹å®‰å…¨</li>
</ol>
<p>äº”ç§å†™æ³•ä¸ºï¼š</p>
<ol>
<li>
<p><strong>é¥¿æ±‰å¼</strong>ï¼š ç±»åŠ è½½çš„æ—¶å€™ï¼Œå°±ä¸€èµ·æŠŠ <code>instance</code> é™æ€å®ä¾‹åˆ›å»ºå¥½äº†ï¼Œæ‰€ä»¥åˆ›å»ºçš„è¿‡ç¨‹å¸‚çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
<p>é¥¿æ±‰å¼çš„å•ä¾‹æ¨¡å¼è™½ç„¶ä¸æ”¯æŒæ‡’åŠ è½½ï¼Œæœ‰ç‚¹æµªè´¹èµ„æºã€‚ä½†å…¶å®ä¸ä¼šå ç”¨å¤ªå¤šèµ„æºï¼Œå¹¶ä¸”å¦‚æœä¸€ä¸ªå®ä¾‹åˆå§‹åŒ–çš„è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå°±åº”è¯¥æ”¾åœ¨å¯åŠ¨çš„æ—¶å€™æ¥å¤„ç†ï¼Œé¿å…è¿è¡Œæ—¶å¡é¡¿æˆ–å‘ç”Ÿé—®é¢˜ï¼Œ æ»¡è¶³<code>fail-fast</code> å¤±è´¥å¿«é€Ÿè§£å†³çš„è®¾è®¡åŸåˆ™</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EagerSingleton</span><span class="w"> </span><span class="p">{</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Singleton</span><span class="p">();</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="nf">Singleton</span><span class="w"> </span><span class="p">(){}</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    	</span><span class="k">return</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><strong>æ‡’æ±‰å¼</strong>ï¼šç›¸è¾ƒäºé¥¿æ±‰å¼çš„æ–¹å¼ï¼Œä¿®æ”¹æˆå»¶è¿ŸåŠ è½½çš„æ¨¡å¼ã€‚æ³¨æ„<code>getInstance()</code>æ–¹æ³•æ²¡æœ‰ä¸Šé”çš„è¯ï¼Œåœ¨å¤§é‡çº¿ç¨‹å¹¶å‘è¯·æ±‚çš„æ—¶å€™ï¼Œå¯èƒ½åˆ›å»ºå¤šä¸ªå®ä¾‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Singleton</span><span class="w"> </span><span class="p">{</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="nf">Singleton</span><span class="w"> </span><span class="p">(){}</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">synchronized</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">instance</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Singleton</span><span class="p">();</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><strong>åŒé‡æ£€æŸ¥é”</strong>ï¼šé¥¿æ±‰å¼é”ä¸æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œç„¶åæ‡’æ±‰å¼é”çš„ç²’åº¦æ¯”è¾ƒå¤§ï¼Œä¸æ”¯æŒé«˜å¹¶å‘ã€‚åŒé‡æ£€æŸ¥é”å¯ä»¥å®ç°æ—¢å»¶è¿ŸåŠ è½½ï¼Œåˆæ”¯æŒé«˜å¹¶å‘ã€‚å…¶å®å°±æ˜¯åœ¨åˆ¤æ–­äº†æ²¡æœ‰å®ä¾‹ä¹‹åï¼Œå†è¿›è¡Œä¸Šé”ï¼Œåˆ›å»ºå®ä¾‹ã€‚ ä½†æ˜¯å®ä¾‹å¿…é¡»ç”¨<code>volatile</code> ä¿®é¥°ï¼Œä¸ç„¶<code>new</code> æ“ä½œåˆ›å»ºå¯¹è±¡æ—¶ï¼Œå®¹æ˜“å‡ºç°é‡æ’åºçš„é—®é¢˜ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DclSingleton</span><span class="w"> </span><span class="p">{</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// volatileå¦‚æœä¸åŠ å¯èƒ½ä¼šå‡ºç°åŠåˆå§‹åŒ–çš„å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ç°åœ¨ç”¨çš„é«˜ç‰ˆæœ¬çš„ Java å·²ç»åœ¨ JDK å†…éƒ¨å®ç°ä¸­è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼ˆè§£å†³çš„æ–¹æ³•å¾ˆç®€å•ï¼Œåªè¦æŠŠå¯¹è±¡ new æ“ä½œå’Œåˆå§‹åŒ–æ“ä½œè®¾è®¡ä¸ºåŸå­æ“ä½œï¼Œå°±è‡ªç„¶èƒ½ç¦æ­¢é‡æ’åºï¼‰,ä¸ºäº†å…¼å®¹æ€§æˆ‘ä»¬åŠ ä¸Š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">volatile</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="n">singleton</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="nf">Singleton</span><span class="w"> </span><span class="p">(){}</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">singleton</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">Singleton</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">singleton</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">singleton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Singleton</span><span class="p">();</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">singleton</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><strong>é™æ€å†…éƒ¨ç±»</strong>ï¼šåˆ©ç”¨Javaçš„å†…éƒ¨ç±»ï¼Œå†è°ƒç”¨<code>getInstance()</code>æ–¹æ³•çš„æ—¶å€™ï¼Œç›´æ¥è¿”å›å†…éƒ¨ç±»çš„å®ä¾‹ã€‚ä»–ä¼šå†è°ƒç”¨æ–¹æ³•ä¹‹åï¼Œåˆ›å»ºå†…éƒ¨ç±»çš„å®ä¾‹å¯¹è±¡ã€‚å®ä¾‹çš„å”¯ä¸€æ€§å’Œåˆ›å»ºè¿‡ç¨‹çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œéƒ½æœ‰JVMæ¥ä¿è¯ã€‚è¿™ç§æ–¹æ³•æ—¢æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåˆèƒ½å¤Ÿåšå»¶è¿ŸåŠ è½½ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">InnerSingleton</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/** ç§æœ‰åŒ–æ„é€ å™¨ */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="nf">Singleton</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/** å¯¹å¤–æä¾›å…¬å…±çš„è®¿é—®æ–¹æ³• */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">SingletonHolder</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/** å†™ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œé‡Œé¢å®ä¾‹åŒ–å¤–éƒ¨ç±» */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SingletonHolder</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="n">INSTANCE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Singleton</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><strong>æšä¸¾</strong>ï¼šé€šè¿‡Javaæšä¸¾ç±»å‹æœ¬èº«çš„ç‰¹æ€§ï¼Œä¿è¯å®ä¾‹åˆ›å»ºçº¿ç¨‹çš„å®‰å…¨æ€§å’Œå®ä¾‹çš„å”¯ä¸€æ€§ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// ä½¿ç”¨æšä¸¾å®ç°å•ä¾‹æ¨¡å¼</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">INSTANCE</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å•ä¾‹ä¸­çš„æ–¹æ³•ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">doSomething</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å•ä¾‹æ–¹æ³•æ‰§è¡Œ&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ä½¿ç”¨æ–¹æ³•ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Singleton</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">.</span><span class="na">doSomething</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></div><p>ä¹Ÿå¯ä»¥ç”¨å•ä¾‹é¡¹ä½œä¸ºæšä¸¾çš„æˆå‘˜å˜é‡ï¼Œç´¯åŠ å™¨å¯ä»¥åƒä¸‹é¢è¿™æ ·ç¼–å†™ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">GlobalCounter</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">INSTANCE</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">AtomicLong</span><span class="w"> </span><span class="n">atomicLong</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AtomicLong</span><span class="p">(</span><span class="n">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">getNumber</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">atomicLong</span><span class="p">.</span><span class="na">incrementAndGet</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
</ol>
<p><strong>ã€å•ä¾‹æ¨¡å¼çš„å®‰å…¨é—®é¢˜ã€‘</strong></p>
<ol>
<li>
<p><strong>åå°„å…¥ä¾µ</strong>ï¼šå¦‚æœæƒ³è¦é˜»æ­¢å…¶ä»–äººæ„é€ å®ä¾‹ï¼Œä»…ä»…ç§æœ‰åŒ–æ„é€ å™¨è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åå°„æœºåˆ¶æ¥è·å–ç§æœ‰æ„é€ å™¨è¿›è¡Œæ„é€ ã€‚å¦‚æœè¦é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œå¯ä»¥å†æ„é€ å™¨å½“ä¸­è¿›è¡Œåˆ¤æ–­å®ä¾‹æ˜¯å¦å·²å­˜åœ¨ï¼Œé¿å…å¤šæ¬¡åˆ©ç”¨æ„é€ å™¨æ„é€ å®ä¾‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Singleton</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">volatile</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="n">singleton</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="nf">Singleton</span><span class="w"> </span><span class="p">(){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">singleton</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="s">&#34;å®ä¾‹ï¼šã€&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ã€‘å·²ç»å­˜åœ¨ï¼Œè¯¥å®ä¾‹åªå…è®¸å®ä¾‹åŒ–ä¸€æ¬¡&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">singleton</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">Singleton</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">singleton</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">singleton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Singleton</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">singleton</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// åˆ©ç”¨åå°„æœºåˆ¶æ¥å…¥ä¾µæ„é€ å®ä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">testReflect</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchMethodException</span><span class="p">,</span><span class="w"> </span><span class="n">InvocationTargetException</span><span class="p">,</span><span class="w"> </span><span class="n">InstantiationException</span><span class="p">,</span><span class="w"> </span><span class="n">IllegalAccessException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Class</span><span class="o">&lt;</span><span class="n">DclSingleton</span><span class="o">&gt;</span><span class="w"> </span><span class="n">clazz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DclSingleton</span><span class="p">.</span><span class="na">class</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Constructor</span><span class="o">&lt;</span><span class="n">DclSingleton</span><span class="o">&gt;</span><span class="w"> </span><span class="n">constructor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clazz</span><span class="p">.</span><span class="na">getDeclaredConstructor</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">constructor</span><span class="p">.</span><span class="na">setAccessible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DclSingleton</span><span class="p">.</span><span class="na">getInstance</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">constructor</span><span class="p">.</span><span class="na">newInstance</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;flag -&gt; {}&#34;</span><span class="p">,</span><span class="n">flag</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><strong>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</strong>ï¼šå¦‚æœå•ä¾‹å­˜åˆ°æ–‡ä»¶æµå½“ä¸­ï¼Œå†è¿›è¡Œååºåˆ—è¯ï¼Œä¹Ÿä¸æ˜¯åŒä¸€ä¸ªå®ä¾‹ã€‚ä½†æ˜¯å¯ä»¥ç”¨<code>readResolve()</code>çš„æ–¹æ³•ï¼Œå°†è¿”å›å€¼ä½œä¸ºååºåˆ—åŒ–çš„ç»“æœï¼Œè€Œä¸ä¼šå…‹éš†ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œä¿è¯jvmå½“ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">testSerialize</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IllegalAccessException</span><span class="p">,</span><span class="w"> </span><span class="n">NoSuchMethodException</span><span class="p">,</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// è·å–å•ä¾‹å¹¶åºåˆ—åŒ–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Singleton</span><span class="w"> </span><span class="n">singleton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Singleton</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">FileOutputStream</span><span class="w"> </span><span class="n">fout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="s">&#34;D://singleton.txt&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="n">fout</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">out</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">singleton</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å°†å®ä¾‹ååºåˆ—åŒ–å‡ºæ¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">FileInputStream</span><span class="w"> </span><span class="n">fin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">&#34;D://singleton.txt&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ObjectInputStream</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectInputStream</span><span class="p">(</span><span class="n">fin</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span><span class="p">.</span><span class="na">readObject</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;ä»–ä»¬æ˜¯åŒä¸€ä¸ªå®ä¾‹å—ï¼Ÿ{}&#34;</span><span class="p">,</span><span class="n">o</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">singleton</span><span class="p">);</span><span class="w"> </span><span class="c1">// å¦‚æœç›´æ¥è·å–ï¼Œååºåˆ—åŒ–åçš„ä¸æ˜¯åŒä¸€ä¸ªå®ä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æ·»åŠ readResolve()æ¥è§£å†³åºåˆ—åŒ–å’Œååºåˆ—åŒ–é—®é¢˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Singleton</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// çœç•¥å…¶ä»–çš„å†…å®¹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// éœ€è¦åŠ è¿™ä¹ˆä¸€ä¸ªæ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">readResolve</span><span class="p">(){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">singleton</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
</ol>
<p><strong>ã€ä¸ºä»€ä¹ˆè¦ç”¨å•ä¾‹æ¨¡å¼ã€‘</strong></p>
<ol>
<li>
<p><strong>ä¸ºäº†å…¨å±€å”¯ä¸€</strong>ï¼šç³»ç»Ÿä¸­å¦‚é…ç½®ç±»ã€å…¨å±€è®¡æ•°å™¨ç­‰ç±»å‹ï¼Œåº”è¯¥éƒ½éƒ½åªèƒ½ä¿å­˜ä¸€ä»½æ•°æ®ï¼Œä¸åº”è¯¥æœ‰å¤šä»½æ•°æ®ã€‚</p>
<ul>
<li>é…ç½®ç±»ï¼šç³»ç»Ÿä»…æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ŒåŠ è½½åˆ°å†…å­˜åæ˜ å°„æˆå”¯ä¸€çš„é…ç½®å®ä¾‹</li>
<li>å…¨å±€è®¡æ•°å™¨ï¼šç”¨äºæ•°æ®ç»Ÿè®¡ã€ç”Ÿæˆå…¨å±€é€’å¢<code>id</code> ç­‰åŠŸèƒ½ï¼Œå¿…é¡»è¦æ˜¯å”¯ä¸€çš„ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´ç»Ÿè®¡æ— æ•ˆã€<code>ID</code> é‡å¤ç­‰é—®é¢˜ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// å…¨å±€idç”Ÿæˆå™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">GlobalCounter</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">AtomicLong</span><span class="w"> </span><span class="n">atomicLong</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AtomicLong</span><span class="p">(</span><span class="n">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">GlobalCounter</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">GlobalCounter</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ç§æœ‰åŒ–æ— å‚æ„é€ å™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="nf">GlobalCounter</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">GlobalCounter</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">getId</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">atomicLong</span><span class="p">.</span><span class="na">incrementAndGet</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æŸ¥çœ‹å½“å‰çš„ç»Ÿè®¡æ•°é‡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">long</span><span class="w"> </span><span class="n">courrentNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GlobalCounter</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">getId</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><strong>å¤„ç†èµ„æºè®¿é—®å†²çª</strong>ï¼šå‡å¦‚éœ€è¦æ—¥å¿—è¾“å‡ºçš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨å•ä¾‹ié¢èµ„æºè®¿é—®å†²çª</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Logger</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">basePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;D://log/&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Logger</span><span class="p">();</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">FileWriter</span><span class="w"> </span><span class="n">writer</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="nf">Logger</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">File</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">basePath</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileWriter</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span><span class="w"> </span><span class="c1">//trueè¡¨ç¤ºè¿½åŠ å†™å…¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">(){</span><span class="w"> </span><span class="c1">//ç¡®ä¿å…¨å±€åªæœ‰ä¸€ä¸ªloggerå®ä¾‹å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">message</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setBasePath</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">basePath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">basePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basePath</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
</ol>
<p><strong>ã€å•ä¾‹æ¨¡å¼å­˜åœ¨çš„é—®é¢˜ã€‘</strong></p>
<ol>
<li><strong>æ— æ³•æ”¯æŒé¢å‘å¯¹è±¡ç¼–ç¨‹<code>OOP</code></strong>ï¼š <code>OOP</code> çš„ä¸‰å¤§ç‰¹æ€§æ˜¯<strong>å°è£…ã€ç»§æ‰¿ã€å¤šæ€</strong>ã€‚å•ä¾‹æŠŠæ„é€ å‡½æ•°ç§æœ‰åŒ–äº†ï¼Œä¸æ”¯æŒç»§æ‰¿å’Œå¤šæ€ã€‚æ‰€ä»¥æ— æ³•å¯¹å®ƒè¿›è¡Œæ‹“å±•ã€‚</li>
<li><strong>å¾ˆéš¾æ¨ªå‘æ‹“å±•</strong>ï¼šå•ä¾‹ç±»åªèƒ½æœ‰ä¸€ä¸ªå¯¹è±¡å®ä¾‹ï¼Œå¦‚æœåé¢éœ€è¦è¿›è¡Œæ‹“å±•ï¼Œåˆ›å»ºå¤šä¸ªå®ä¾‹ã€‚å¿…é¡»ä¿®æ”¹æºç ï¼Œæ— æ³•å‹å¥½æ‹“å±•ã€‚</li>
</ol>
<p><strong>ã€ä¸åŒä½œç”¨èŒƒå›´çš„å•ä¾‹æ¨¡å¼ã€‘</strong></p>
<ol>
<li>
<p>çº¿ç¨‹çº§åˆ«å•ä¾‹ï¼šå•ä¾‹ç±»å¯¹è±¡æ˜¯è¿›ç¨‹å”¯ä¸€çš„ï¼Œå¦‚æœæƒ³è¦çº¿ç¨‹å”¯ä¸€ã€‚åœ¨ä¸ä½¿ç”¨<code>ThreadLocal</code>çš„æ—¶å€™ï¼Œå¯ä»¥é‡‡ç”¨<code>ConCurrentHashMap</code> çš„æ–¹å¼ï¼Œç”¨çº¿ç¨‹<code>id</code>ä¸º<code>key</code>ï¼Œ å®ä¾‹ä¸º<code>value</code>ã€‚æ¯ä¸ªçº¿ç¨‹çš„å­˜å–éƒ½ä»å…±äº«çš„ <code>map</code> å½“ä¸­è¿›è¡Œæ“ä½œã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Connection</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ConcurrentHashMap</span><span class="o">&lt;</span><span class="n">Long</span><span class="p">,</span><span class="w"> </span><span class="n">Connection</span><span class="o">&gt;</span><span class="w"> </span><span class="n">instances</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConcurrentHashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="nf">Connection</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Connection</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Long</span><span class="w"> </span><span class="n">currentThreadId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getId</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">instances</span><span class="p">.</span><span class="na">putIfAbsent</span><span class="p">(</span><span class="n">currentThreadId</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Connection</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">instances</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">currentThreadId</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><strong>å®¹å™¨çº§åˆ«çš„å•ä¾‹</strong>ï¼šå°†å•ä¾‹çš„ä½œç”¨èŒƒå›´ç”±è¿›ç¨‹åˆ‡æ¢åˆ°ä¸€ä¸ªå®¹å™¨ï¼Œå¯èƒ½ä¼šæ›´åŠ æ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œå•ä¾‹å¯¹è±¡çš„ç®¡ç†ã€‚è¿™ä¹Ÿæ˜¯<code>Spring</code> çš„æ ¸å¿ƒæ€æƒ³ã€‚<code>Spring</code> æä¾›ä¸€ä¸ªå•ä¾‹å®¹å™¨ï¼Œç¡®ä¿ä¸€ä¸ªå®ä¾‹æ˜¯å®¹å™¨çº§åˆ«çš„å•ä¾‹ï¼Œå¹¶ä¸”åœ¨å®¹å™¨å¯åŠ¨æ—¶å®Œæˆåˆå§‹åŒ–ã€‚å…·ä½“ä¼˜åŠ¿å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ‰€æœ‰çš„<code>bean</code> éƒ½ä»¥å•ä¾‹çš„å½¢å¼å­˜æ”¾åœ¨å®¹å™¨ä¸­ï¼Œé¿å…å¤§é‡çš„å¯¹è±¡è¢«åˆ›å»ºï¼Œé€ æˆ<code>JVM</code> å†…å­˜æŠ–åŠ¨ä¸¥é‡ï¼Œé¢‘ç¹<code>GC</code>ã€‚</li>
<li>ç¨‹åºå¯åŠ¨æ—¶ï¼Œåˆå§‹åŒ–å•ä¾‹<code>bean</code>ï¼Œ æ»¡è¶³<code>fast-fail</code>ï¼Œå°†æ‰€æœ‰æ„å»ºè¿‡ç¨‹çš„å¼‚å¸¸æš´éœ²åœ¨å¯åŠ¨æ—¶ï¼Œè€Œéè¿è¡Œæ—¶ã€‚</li>
<li>ç¼“å­˜äº†æ‰€æœ‰å•ä¾‹<code>bean</code>ï¼Œå¯åŠ¨çš„è¿‡ç¨‹ç›¸å½“äºé¢„çƒ­çš„è¿‡ç¨‹ï¼Œè¿è¡Œæ—¶ä¸å¿…è¿›è¡Œå¯¹è±¡åˆ›å»ºï¼Œæ•ˆç‡æ›´é«˜ã€‚</li>
<li>å®¹å™¨ç®¡ç†<code>bean</code>çš„ç”Ÿå‘½å‘¨æœŸï¼Œç»“åˆä¾èµ–æ³¨å…¥ä½¿å¾—è§£è€¦æ›´åŠ å½»åº•ã€æ‰©å±•æ€§æ›´å¥½ã€‚</li>
</ul>
</li>
</ol>
<h2 id="2-ä»€ä¹ˆæ˜¯ç­–ç•¥æ¨¡å¼ä¸€èˆ¬ç”¨åœ¨ä»€ä¹ˆåœºæ™¯">2. ä»€ä¹ˆæ˜¯ç­–ç•¥æ¨¡å¼ï¼Ÿä¸€èˆ¬ç”¨åœ¨ä»€ä¹ˆåœºæ™¯ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#2-ä»€ä¹ˆæ˜¯ç­–ç•¥æ¨¡å¼ä¸€èˆ¬ç”¨åœ¨ä»€ä¹ˆåœºæ™¯">#</a></h2>
<p>ç­–ç•¥æ¨¡å¼æ˜¯è¡Œä¸ºè®¾è®¡æ¨¡å¼çš„ä¸€ç§ï¼Œé€šè¿‡å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•ç±»ã€‚å…è®¸åœ¨è¿è¡Œæ—¶åŠ¨æ€é€‰æ‹©ç®—æ³•ï¼Œä»è€Œå®ç°æ›´åŠ çµæ´»çš„ä»£ç ç»“æ„ã€‚è¯¥æ¨¡å¼ç”¨äºç»„ç»‡å’Œè°ƒç”¨è¿™äº›ç®—æ³•ï¼Œè®©ç¨‹åºç»“æ„å˜å¾—æ›´åŠ çµæ´»ï¼Œå…·æœ‰æ›´å¥½çš„ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚</p>
<p>ç­–ç•¥æ¨¡å¼ä¸€èˆ¬ç”¨äºå½“ä¸€ä¸ªåŠŸèƒ½å­˜åœ¨å¤šç§ç®—æ³•çš„æ—¶å€™ï¼Œéœ€è¦æ ¹æ®ä¸åŒçš„æƒ…å†µä½¿ç”¨ä¸åŒçš„è®¡ç®—ç®—æ³•(éƒ½å°è£…æˆç±»çš„)ã€‚è¿™æ ·å°±å¯ä»¥é¿å…åˆ©ç”¨å¤§é‡çš„<code>if-else</code> æˆ–è€… <code>switch-else</code></p>
<p><strong>ã€ä¸ºä»€ä¹ˆè¦ç”¨ç­–ç•¥æ¨¡å¼ã€‘</strong></p>
<ul>
<li><strong>é¿å…ç¨‹åºå­˜åœ¨åˆ¤æ–­æˆ–é€‰æ‹©åˆ†æ”¯è¯­å¥</strong>ï¼šå½“ç¨‹åºå­˜åœ¨å¤§é‡çš„ <code>if-else</code> æˆ–è€… <code>switch-else</code> åˆ¤æ–­è¯­å¥ï¼Œä»£ç å¯èƒ½å˜å¾—éš¾ä»¥ç»´æŠ¤</li>
<li><strong>é¿å…ç ´åç°æœ‰åŠŸèƒ½</strong>ï¼šå½“ç®—æ³•çš„å®ç°ç»å¸¸å˜æ›´æˆ–éœ€è¦æ‹“å±•çš„æ—¶å€™ï¼Œç›´æ¥ä¿®æ”¹ä»£ç å¯èƒ½ä¼šç ´åç°æœ‰åŠŸèƒ½ã€‚</li>
</ul>
<p><strong>ã€ç­–ç•¥æ¨¡å¼çš„åœºæ™¯ã€‘</strong></p>
<ul>
<li><strong>å¤šç§ç®—æ³•å¯äº’æ¢</strong>ï¼šéœ€è¦åŠ¨æ€é€‰æ‹©ç®—æ³•ï¼Œä¾‹å¦‚æ’åºç®—æ³•çš„é€‰æ‹©ã€‚æœ‰å¾ˆå¤šç§æ’åºç®—æ³•ï¼Œå¯ä»¥æŠŠä¸åŒçš„æ’åºæ–¹å¼å°è£…æˆä¸€ä¸ªç‹¬ç«‹çš„ç®—æ³•ç±» (å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºã€ç›´æ¥æ’å…¥æ’åºç­‰)</li>
<li><strong>é¿å…æ¡ä»¶è¯­å¥</strong>ï¼šé‡‡ç”¨ç­–ç•¥æ¨¡å¼æ›¿æ¢æ‰ä»£ç å½“ä¸­çš„å¤§é‡<code>if-else</code> æˆ– <code>switch</code> è¯­å¥</li>
<li><strong>ä¸ä¸Šä¸‹æ–‡ç‹¬ç«‹</strong>ï¼šå®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“å…·ä½“çš„å®ç°ç»†èŠ‚ï¼Œåªéœ€ä»¥æ¥æŠ½è±¡ç­–ç•¥ã€‚</li>
</ul>
<p><strong>ã€ç­–ç•¥æ¨¡å¼å…¸å‹åº”ç”¨åœºæ™¯ã€‘</strong></p>
<ul>
<li><strong>æ”¯ä»˜ç³»ç»Ÿ</strong>ï¼šæ”¯æŒå¤šç§æ”¯ä»˜æ–¹å¼ï¼Œæ¯”å¦‚å¾®ä¿¡ã€æ”¯ä»˜å®ã€ä¿¡ç”¨å¡</li>
<li><strong>æ•°æ®å‹ç¼©</strong>ï¼šæä¾›ä¸åŒçš„å‹ç¼©ç®—æ³•</li>
<li><strong>æ—¥å¿—ç­–ç•¥</strong>ï¼šæ ¹æ®æ—¥å¿—çº§åˆ«åŠ¨æ€é€‰æ‹©è®°å½•ç­–ç•¥</li>
</ul>
<p><strong>ã€ç­–ç•¥æ¨¡å¼çš„ç»„æˆã€‘</strong></p>
<ul>
<li><strong><code>Strategy</code> ç­–ç•¥</strong>ï¼šç”¨æ¥çº¦æŸä¸€ç³»åˆ—å…·ä½“çš„ç­–ç•¥ç®—æ³•ã€‚<code>Context</code> ä¸Šä¸‹æ–‡ä½¿ç”¨è¿™ä¸ªæ¥å£æ¥è°ƒç”¨å…·ä½“çš„ç­–ç•¥å®ç°å®šä¹‰çš„ç®—æ³•ã€‚å¦‚æœå¤šä¸ªç®—æ³•å…·æœ‰å…¬å…±åŠŸèƒ½çš„åŒ–ï¼ŒæŠŠ<code>Strategy</code> å®ç°ä¸ºæŠ½è±¡ç±»ï¼Œç„¶åæŠŠå¤šä¸ªç®—æ³•çš„åŠŸèƒ½å®ç°åˆ°<code>Stragy</code> é‡Œé¢ã€‚ (æ¯”å¦‚å¤šç§æ’åºç®—æ³•ï¼Œéƒ½æ”¾åœ¨ <code>Strategy</code> æŠ½è±¡ç±»é‡Œé¢)</li>
<li><strong><code>ConcreteStrategy</code> å…·ä½“ç­–ç•¥</strong>ï¼š å…·ä½“çš„ç­–ç•¥å®ç°ï¼Œè´Ÿè´£å®ç°<code>Strategy</code> ç­–ç•¥çš„æ¥å£ (å¤šç§æ’åºç®—æ³•çš„å…·ä½“å®ç°)</li>
<li><strong><code>Context</code> ä¸Šä¸‹æ–‡</strong>ï¼šä¸Šä¸‹æ–‡æ˜¯è´Ÿè´£å’Œå…·ä½“çš„ç­–ç•¥ç±»äº¤äº’ï¼Œé€šå¸¸ä¸Šä¸‹æ–‡ä¼šåƒæœ‰ä¸€ä¸ªçœŸæ­£çš„ç­–ç•¥å®ç° (å°±æ˜¯è°ƒç”¨å“ªä¸ªæ’åºæ–¹æ³•ï¼Œæ¯”å¦‚è¯´ <code>main</code> å‡½æ•°)</li>
</ul>
<p><img alt="ç­–ç•¥æ¨¡å¼çš„ç»„æˆ" loading="lazy" src="https://oss.swimmingliu.cn/f649bf1f-fb59-11ef-8f2a-c858c0c1deba"></p>
<h2 id="3-ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸€èˆ¬ç”¨åœ¨ä»€ä¹ˆåœºæ™¯">3. ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Ÿä¸€èˆ¬ç”¨åœ¨ä»€ä¹ˆåœºæ™¯ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#3-ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸€èˆ¬ç”¨åœ¨ä»€ä¹ˆåœºæ™¯">#</a></h2>
<p>æ¨¡æ¿æ–¹æ³•å°±æ˜¯åœ¨æŠ½è±¡ç±»é‡Œé¢å®šä¹‰å¥½ç®—æ³•çš„éª¨æ¶ï¼Œå…·ä½“æ­¥éª¤åœ¨å­ç±»å®ç°ã€‚</p>
<p><strong>ã€æ¨¡æ¿æ–¹æ³•ç‰¹ç‚¹ã€‘</strong></p>
<ol>
<li><strong>ç®—æ³•éª¨æ¶</strong>ï¼šåœ¨åŸºç±»ä¸­å®šä¹‰ä¸€ä¸ªç®—æ³•çš„å›ºå®šæ‰§è¡Œæ­¥éª¤ï¼Œå…·ä½“å®ç°æ­¥éª¤äº¤ç»™å­ç±»å®ç°</li>
<li><strong>å¤ç”¨ä»£ç </strong>ï¼šå­ç±»å¤ç”¨åŸºç±»ä¸­å®šä¹‰çš„å…¬å…±é€»è¾‘ï¼Œåªéœ€è¦å®ç°ç‰¹å®šçš„é€»è¾‘</li>
<li><strong>éµå¾ªå¼€é—­è§„åˆ™</strong>ï¼šæ¨¡æ¿æ–¹æ³•æ˜¯æ‰©å±•å¼€æ”¾ï¼Œä¿®æ”¹é—­åˆçš„</li>
</ol>
<p><strong>ã€å…¸å‹ä½¿ç”¨åœºæ™¯ã€‘</strong></p>
<ul>
<li><strong>æ•°æ®è¯·æ±‚å¤„ç†</strong>: è¯»å–æ•°æ®ã€å¤„ç†æ•°æ®ã€è¾“å‡ºç»“æœ</li>
<li><strong>Webè¯·æ±‚å¤„ç†</strong>ï¼šè§£æè¯·æ±‚ã€å¤„ç†é€»è¾‘ã€è¿”å›å“åº”</li>
<li><strong><code>String Template</code> å­—ç¬¦ä¸²æ¨¡æ¿</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;World&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">String</span><span class="w"> </span><span class="n">greeting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STR</span><span class="p">.</span><span class="s">&#34;Hello, \{name}!&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">greeting</span><span class="p">);</span><span class="w"> </span><span class="c1">// è¾“å‡º: Hello, World!</span><span class="w">
</span></span></span></code></pre></div><h2 id="4-è°ˆè°ˆä½ äº†è§£çš„æœ€å¸¸è§çš„å‡ ç§è®¾è®¡æ¨¡å¼è¯´è¯´ä»–ä»¬çš„åº”ç”¨åœºæ™¯">4. è°ˆè°ˆä½ äº†è§£çš„æœ€å¸¸è§çš„å‡ ç§è®¾è®¡æ¨¡å¼ï¼Œè¯´è¯´ä»–ä»¬çš„åº”ç”¨åœºæ™¯<a hidden class="anchor" aria-hidden="true" href="#4-è°ˆè°ˆä½ äº†è§£çš„æœ€å¸¸è§çš„å‡ ç§è®¾è®¡æ¨¡å¼è¯´è¯´ä»–ä»¬çš„åº”ç”¨åœºæ™¯">#</a></h2>
<p><strong>ã€å¸¸è§çš„è®¾è®¡æ¨¡å¼ã€‘</strong></p>
<ul>
<li><strong>å•ä¾‹æ¨¡å¼</strong>ï¼šä¿è¯ç³»ç»Ÿä¸­ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œæ¯”å¦‚å…¨å±€é…ç½®ã€å…¨å±€è®¡æ•°å™¨ã€æ•°æ®åº“è¿æ¥æ± </li>
<li><strong>ç­–ç•¥æ¨¡å¼</strong>ï¼šå°è£…ä¸€ç»„ç®—æ³•è®©ä»–ä»¬ä¹‹é—´èƒ½å¤Ÿç›¸äº’æ›¿ä»£ï¼Œé¿å…å¤§é‡çš„<code>if-else</code> å’Œ <code>switch-case</code> è¯­å¥ï¼Œæ¯”å¦‚ç”¨æˆ·é€‰æ‹©ä¸åŒçš„æ”¯ä»˜ç­–ç•¥ï¼Œæˆ–è€…è°ƒç”¨ä¸åŒçš„æ’åºç®—æ³•ã€‚</li>
<li><strong>æ¨¡æ¿æ¨¡å¼</strong>ï¼šæç‚¼æ ¸å¿ƒæµç¨‹å°è£…æˆä¸€ä¸ªæ–¹æ³•ï¼Œæ¯”å¦‚åƒæ”¯ä»˜é€»è¾‘(å‚æ•°æ ¡éªŒã€è°ƒèµ·æ”¯ä»˜æ¥å£ã€ä¿®æ”¹æ”¯ä»˜çŠ¶æ€)ï¼Œé™¤äº†è°ƒèµ·æ”¯ä»˜æ¥å£ä»¥å¤–ï¼Œå…¶ä»–çš„æµç¨‹åŸºæœ¬ä¸€è‡´ã€‚æ‰€ä»¥å¯ä»¥å°è£…æˆæ¨¡æ¿æ–¹æ³•ï¼Œç„¶åæŠŠè°ƒèµ·æ”¯ä»˜æ¥å£çš„æ“ä½œï¼Œåœ¨å…·ä½“å®ç°æ–¹æ³•å½“ä¸­é‡å†™è¯¥æ–¹æ³•ã€‚</li>
<li><strong>ç®€å•å·¥å‚æ¨¡å¼</strong>ï¼šè·å–ä¸åŒçš„å¯¹è±¡æ—¶å¯ä»¥ä½¿ç”¨ï¼Œå°†å¯¹è±¡çš„åˆ›å»ºé€»è¾‘æŠ½ç¦»å¤ç”¨ã€‚</li>
<li><strong>å¤–è§‚æ¨¡å¼</strong>ï¼šä¸ºå­ç³»ç»Ÿæä¾›ä¸€ç»„ç»Ÿä¸€æ¥å£ï¼Œéšè—å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œæ–¹ä¾¿å­ç³»ç»Ÿç›´æ¥è°ƒç”¨ï¼Œè€Œæ— éœ€å…³æ³¨å®ç°ç»†èŠ‚(æ¯”å¦‚é«˜å¾·å’Œç™¾åº¦çš„ <code>SDK</code>)</li>
<li><strong>ä»£ç†æ¨¡å¼</strong>ï¼šé€šè¿‡åˆ›å»ºä»£ç†å¯¹è±¡æ¥æ§åˆ¶å“¦å¯¹å®é™…å¯¹è±¡çš„è®¿é—®ï¼Œä¾‹å¦‚<code>Sping AOP</code>åˆ‡é¢ç¼–ç¨‹é‡‡ç”¨ä»£ç†æ¨¡å¼æ¥åŠ¨æ€ç”Ÿæˆå¢å¼ºç›®æ ‡å¯¹è±¡çš„ä»£ç† (é€šè¿‡ <code>JDK</code> åŠ¨æ€ä»£ç†æˆ–è€…<code>CGLIB</code>ä»£ç†) ã€‚<code>Sping AOP</code> é»˜è®¤ä¼˜å…ˆä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ã€‚å½“ç›®æ ‡ç±»æœªå®ç°æ¥å£æ—¶ï¼Œæ‰ä¼šåˆ‡æ¢ä¸º CGLIB åŠ¨æ€ä»£ç†ã€‚</li>
</ul>
<p><strong>ã€Springä¸­çš„è®¾è®¡æ¨¡å¼ã€‘</strong></p>
<p><img alt="Springä¸­çš„è®¾è®¡æ¨¡å¼" loading="lazy" src="https://oss.swimmingliu.cn/f6a094ff-fb59-11ef-b5d7-c858c0c1deba"></p>
<h2 id="5-ä½ è®¤ä¸ºå¥½çš„ä»£ç åº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„">5. ä½ è®¤ä¸ºå¥½çš„ä»£ç åº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#5-ä½ è®¤ä¸ºå¥½çš„ä»£ç åº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„">#</a></h2>
<p><strong>ã€é€šä¿—æ˜“æ‡‚çš„è®²ã€‘</strong></p>
<ul>
<li><strong>æ¸…æ™°æ˜“æ‡‚ï¼Œä¿æŒç®€æ´å’Œæ˜“è¯»æ€§</strong>ï¼šä»£ç ç®€æ´ã€ç›´è§‚ï¼Œå‡½æ•°å’Œå˜é‡å‘½åéƒ½æœ‰æ„ä¹‰ï¼Œå¯è¯»æ€§éå¸¸å¼ºï¼Œæœ‰åˆç†çš„æ³¨é‡Šã€‚</li>
<li><strong>é«˜å†…èšä½è€¦åˆ</strong>ï¼šé«˜å†…èšæ˜¯æŒ‡ä»£ç æ¨¡å—å†…éƒ¨åŠŸèƒ½é›†ä¸­ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰å•ä¸€èŒè´£ã€‚ä½è€¦åˆæŒ‡çš„æ˜¯ä¸åŒæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»å°½é‡æ¾æ•£ï¼Œä¿®æ”¹ä¸€ä¸ªæ¨¡å—çš„æ—¶å€™ï¼Œå…¶ä»–æ¨¡å—å—åˆ°çš„å½±å“æ¯”è¾ƒå°ã€‚</li>
<li><strong>å¯æµ‹è¯•</strong>ï¼šæ¯ä¸ªæ¨¡å—éƒ½è®¾è®¡ä¸ºç‹¬ç«‹çš„ã€å¯éªŒè¯çš„å•å…ƒï¼Œç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹çš„æ—¶å€™ï¼Œèƒ½å¤Ÿç¡®ä¿ä»£ç çš„æ­£ç¡®æ€§å¹¶ä¸”å‘ç°æ½œåœ¨é—®é¢˜ã€‚</li>
<li><strong>æ˜“äºæ‰©å±•ï¼Œéµå¾ªå¼€é—­åŸåˆ™</strong>ï¼šä»£ç å…·æœ‰ä¸€å®šçµæ´»æ€§ï¼Œèƒ½åœ¨ä¸ç ´åç°æœ‰åŠŸèƒ½çš„æƒ…å†µä¸‹ï¼Œæ–¹ä¾¿è¿›è¡Œæ‰©å±•å’Œä¿®æ”¹ã€‚</li>
<li><strong>ç¬¦åˆå›¢é˜Ÿè§„èŒƒ</strong>ï¼šä»£ç é£æ ¼å’Œå›¢é˜Ÿæ•´ä½“ä»£ç è§„èŒƒç»Ÿä¸€ï¼Œæœ‰åŠ©äºååŠ©å›¢é˜Ÿåä½œå’Œä»£ç å®¡æŸ¥ã€‚</li>
<li><strong>å‡å°‘ç¡¬ç¼–ç ã€é­”æ³•å€¼</strong>ï¼šå°½é‡é¿å…ç¡¬ç¼–ç å’Œé­”æ³•å€¼çš„ç°è±¡ï¼Œæ–¹ä¾¿åç»­è¿›è¡Œä¿®æ”¹ã€‚</li>
</ul>
<p><strong>ã€å¥½ä»£ç å…·å¤‡ä»¥ä¸‹ç‰¹æ€§ã€‘</strong></p>
<table>
  <thead>
      <tr>
          <th>è®¾è®¡åŸåˆ™</th>
          <th>ä»£ç ç‰¹æ€§</th>
          <th>ç»“æœ</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>å•ä¸€èŒè´£</td>
          <td>ç±»æˆ–æ¨¡å—èŒè´£å•ä¸€</td>
          <td>é™ä½ç±»çš„å¤æ‚åº¦ï¼Œå¢å¼ºå¯è¯»æ€§å’Œç»´æŠ¤æ€§</td>
      </tr>
      <tr>
          <td>å¼€é—­åŸåˆ™</td>
          <td>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</td>
          <td>æé«˜æ‰©å±•æ€§ï¼Œå‡å°‘å¯¹å·²æœ‰ä»£ç çš„ä¿®æ”¹</td>
      </tr>
      <tr>
          <td>é«˜å†…èšä½è€¦åˆ</td>
          <td>æ¨¡å—èŒè´£æ˜ç¡®ï¼Œä¾èµ–å…³ç³»æ¾æ•£</td>
          <td>å¢å¼ºä»£ç çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§</td>
      </tr>
      <tr>
          <td>æ¥å£éš”ç¦»åŸåˆ™</td>
          <td>æ¥å£å°ä¸”ä¸“ç”¨</td>
          <td>å‡å°‘æ— å…³å®ç°ä»£ç ï¼Œå¢å¼ºæ¥å£çš„çµæ´»æ€§</td>
      </tr>
      <tr>
          <td>ä¾èµ–å€’ç½®</td>
          <td>ä¾èµ–äºæŠ½è±¡è€Œéå…·ä½“å®ç°</td>
          <td>é™ä½æ¨¡å—é—´çš„è€¦åˆåº¦ï¼Œæé«˜ä»£ç çµæ´»æ€§</td>
      </tr>
      <tr>
          <td>åˆæˆå¤ç”¨åŸåˆ™</td>
          <td>ä¼˜å…ˆä½¿ç”¨ç»„åˆè€Œéç»§æ‰¿</td>
          <td>æé«˜çµæ´»æ€§ï¼Œé¿å…ç»§æ‰¿å¯¼è‡´çš„é«˜èšåˆ</td>
      </tr>
      <tr>
          <td>é‡Œæ°æ›¿æ¢åŸåˆ™</td>
          <td>å­ç±»å¯ä»¥æ— ç¼æ›¿æ¢çˆ¶ç±»</td>
          <td>ç¡®ä¿ç»§æ‰¿ä½“ç³»çš„æ­£ç¡®æ€§ï¼Œå¢å¼ºä»£ç çš„ç¨³å®šæ€§</td>
      </tr>
      <tr>
          <td>è¿ªç±³ç‰¹æ³•åˆ™</td>
          <td>å‡å°‘ç±»ä¹‹é—´çš„ä¾èµ–</td>
          <td>é™ä½è€¦åˆåº¦ï¼Œå¢å¼ºæ¨¡å—ç‹¬ç«‹æ€§</td>
      </tr>
  </tbody>
</table>
<h2 id="6-å·¥å‚æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«">6. å·¥å‚æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#6-å·¥å‚æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«">#</a></h2>
<p><strong>ã€å·¥å‚æ¨¡å¼ã€‘</strong></p>
<ul>
<li><strong>å¯¹è±¡</strong>ï¼šåˆ›å»ºä¸€ç§ç±»å‹çš„äº§å“å¯¹è±¡ï¼Œæ¯”å¦‚è®©googleåˆ›å»ºå®‰å“ç³»ç»Ÿï¼Œ ä¸åŒå“ç‰Œçš„æ‰‹æœºå‚å•†(å·¥å‚å­ç±»)å°±å¯ä»¥æ ¹æ®å®‰å“ç³»ç»Ÿå½“ä¸­çš„åŠŸèƒ½ï¼Œé‡å†™å‡ºå…¶ä»–çš„<code>os</code> ç³»ç»Ÿï¼Œæ¯”å¦‚é¸¿è’™ç³»ç»Ÿã€æ¾æ¹ƒç³»ç»Ÿç­‰ç­‰</li>
<li><strong>å·¥å‚ç»“æ„</strong>ï¼šæœ‰ä¸”åªæœ‰ä¸€ä¸ªæŠ½è±¡çš„å·¥å‚ç±»ï¼Œå®šä¹‰åˆ›å»ºäº§å“çš„æŠ½è±¡æ–¹æ³•ï¼Œç„¶åå…·ä½“çš„å·¥å‚å­ç±»å»å®ç°è¿™ä¸ªæ–¹æ³•æ¥å®é™…åˆ›å»ºå…·ä½“çš„äº§å“ã€‚æ¯”å¦‚ <code>android</code> ç³»ç»Ÿçš„æºç æ˜¯å¤§å®¶éƒ½å¯ä»¥çœ‹åˆ°çš„ï¼Œå…¶ä»–å‚å•†ä¹Ÿå¯ä»¥æ ¹æ®<code>android</code> ç³»ç»Ÿçš„è®¾è®¡ï¼Œé‡æ–°å®ç°éƒ¨åˆ†å‡½æ•°ï¼Œä¿®æ”¹æˆå…¶ä»–çš„åŠŸèƒ½ã€‚</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šå½“åˆ›å»ºè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæƒ³æŠŠå¯¹è±¡åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»æ—¶å¸¸ç”¨ï¼Œæ¯”å¦‚åˆ›å»ºæ•°æ®åº“è¿æ¥å¯¹è±¡ç­‰ç®€å•çš„å•ä¸€äº§å“åˆ›å»ºåˆ›å»ºé€‚ç”¨ã€‚</li>
</ul>
<p><strong>ã€æŠ½è±¡å·¥å‚æ¨¡å¼ã€‘</strong></p>
<ul>
<li><strong>å¯¹è±¡</strong>ï¼šç”¨äºåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³çš„äº§å“å¯¹è±¡ï¼Œæ¯”å¦‚åˆ›å»ºæ‰‹æœºçš„æ—¶å€™ï¼Œéœ€è¦è¿å¸¦åˆ›å»ºé…å¥—çš„å……ç”µå™¨ã€è€³æœºç­‰é…å¥—äº§å“</li>
<li><strong>å·¥å‚ç»“æ„</strong>ï¼šæŠ½è±¡å·¥å‚ç±»å®šä¹‰äº†å¤šä¸ªæŠ½è±¡åˆ›å»ºæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨äºåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³çš„äº§å“ã€‚æ›´å…·ä½“çš„å·¥å‚å­ç±»è¦å®ç°è¿™äº›æŠ½è±¡æ–¹æ³•ï¼Œæä¾›ä¸€æ•´å¥—çš„å…·ä½“äº§å“çš„åˆ›å»ºã€‚</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šå½“ç³»ç»Ÿè¦åˆ›å»ºå¤šä¸ªç›¸äº’ä¾èµ–æˆ–è€…å…³è”çš„å¯¹è±¡çš„æ—¶å€™ï¼Œç¡®ä¿è¿™äº›å¯¹è±¡æ­é…åˆç†ã€‚æ¯”å¦‚æ¸¸æˆå¼€å‘ä¸­åˆ›å»ºä¸åŒé£æ ¼(æ¯”å¦‚ç§‘æŠ€é£æ ¼ã€å¤é£)çš„è§’è‰²ã€æ­¦å™¨ã€åœºæ™¯ç­‰ä¸€æ•´å¥—ç›¸å…³çš„å…ƒç´ æ—¶ï¼Œå°±é€‚åˆç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// æŠ½è±¡äº§å“A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ProductA</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">use</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å…·ä½“äº§å“A1 -&gt; æ‰‹æœº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConcreteProductA1</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ProductA</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">use</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;Using ConcreteProductA1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å…·ä½“äº§å“A2 -&gt; ç”µè„‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConcreteProductA2</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ProductA</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">use</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;Using ConcreteProductA2&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æŠ½è±¡äº§å“B</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ProductB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">eat</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å…·ä½“äº§å“B1 -&gt; æ‰‹æœºå……ç”µçº¿</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConcreteProductB1</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ProductB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">eat</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;Eating ConcreteProductB1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å…·ä½“äº§å“B2 -&gt; ç”µè„‘å……ç”µçº¿</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConcreteProductB2</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ProductB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">eat</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;Eating ConcreteProductB2&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æŠ½è±¡å·¥å‚ -&gt; æŠŠä¸¤ä¸ªç›¸äº’å…³è”çš„æŠ½è±¡äº§å“ä¸€èµ·åˆ›å»º</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">AbstractFactory</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ProductA</span><span class="w"> </span><span class="nf">createProductA</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ProductB</span><span class="w"> </span><span class="nf">createProductB</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å…·ä½“å·¥å‚1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConcreteFactory1</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AbstractFactory</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ProductA</span><span class="w"> </span><span class="nf">createProductA</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConcreteProductA1</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ProductB</span><span class="w"> </span><span class="nf">createProductB</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConcreteProductB1</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å…·ä½“å·¥å‚2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConcreteFactory2</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AbstractFactory</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ProductA</span><span class="w"> </span><span class="nf">createProductA</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConcreteProductA2</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ProductB</span><span class="w"> </span><span class="nf">createProductB</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConcreteProductB2</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ä½¿ç”¨æŠ½è±¡å·¥å‚åˆ›å»ºäº§å“</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Client</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">AbstractFactory</span><span class="w"> </span><span class="n">factory1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConcreteFactory1</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ProductA</span><span class="w"> </span><span class="n">productA1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factory1</span><span class="p">.</span><span class="na">createProductA</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ProductB</span><span class="w"> </span><span class="n">productB1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factory1</span><span class="p">.</span><span class="na">createProductB</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">productA1</span><span class="p">.</span><span class="na">use</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">productB1</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">AbstractFactory</span><span class="w"> </span><span class="n">factory2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConcreteFactory2</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ProductA</span><span class="w"> </span><span class="n">productA2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factory2</span><span class="p">.</span><span class="na">createProductA</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ProductB</span><span class="w"> </span><span class="n">productB2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factory2</span><span class="p">.</span><span class="na">createProductB</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">productA2</span><span class="p">.</span><span class="na">use</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">productB2</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div>

  </div>



  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://swimmingliu.cn/tags/java/">Java</a></li>
      <li><a href="https://swimmingliu.cn/tags/design-mode/">Design Mode</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://swimmingliu.cn/posts/job/computer-networks-interview-questions/">
    <span class="title">Â« Prev</span>
    <br>
    <span>è®¡ç®—æœºç½‘ç»œé¢è¯•é¢˜ç¬”è®°</span>
  </a>
  <a class="next" href="https://swimmingliu.cn/posts/job/java-juc-interview-questions/">
    <span class="title">Next Â»</span>
    <br>
    <span>(JUC) Javaå¹¶å‘é¢è¯•é¢˜ç¬”è®°</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2023-2025 <a href="https://swimmingliu.cn/">SwimmingLiu&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
    <span>
        <a href="https://beian.miit.gov.cn/">æµ™ICPå¤‡2024056260å·</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
