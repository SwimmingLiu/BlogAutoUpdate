<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>JavaåŸºç¡€é¢˜é¢è¯•ç¬”è®° | SwimmingLiu&#39;s Blog</title>
<meta name="keywords" content="Java">
<meta name="description" content="1. åºåˆ—åŒ–å’Œååºåˆ—åŒ–
1.åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼šæŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµï¼Œç”¨äºå­˜å‚¨å’Œä¼ è¾“ï¼›è¯»å–å­—èŠ‚æµæ•°æ®ï¼Œé‡æ–°åˆ›å»ºå¯¹è±¡ã€‚
2.åºåˆ—åŒ–ä¸åŒ…æ‹¬é™æ€å¯¹è±¡ï¼šåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æœ¬è´¨æ˜¯è°ƒç”¨å¯¹è±¡çš„writeObjectå’ŒreadObjectæ–¹æ³•,æ¥å®ç°å°†å¯¹è±¡å†™å…¥è¾“å‡ºæµå’Œè¯»å–è¾“å…¥æµã€‚ä½†æ˜¯ï¼Œé™æ€å˜é‡ä¸å±äºå¯¹è±¡ï¼Œæ‰€ä»¥è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•å°±æ²¡æ³•å„¿è®©é™æ€å˜é‡å‚ä¸ã€‚
2. ä»€ä¹ˆæ˜¯ä¸å¯å˜ç±»ï¼Ÿ
1.ä¸å¯å˜ç±»ï¼šåˆå§‹åŒ–ä¹‹åï¼Œå°±ä¸èƒ½ä¿®æ”¹çš„ç±»ã€‚
2.ä¿®é¥°æ–¹æ³•ï¼šfinal å’Œ private ä¿®é¥°æ‰€æœ‰ç±»å’Œå˜é‡
3.ä¸å¯ä¿®æ”¹ï¼šä¸æš´éœ²setæ–¹æ³•ï¼Œåªèƒ½é€šè¿‡é‡æ–°åˆ›å»ºå¯¹è±¡æ›¿ä»£ä¿®æ”¹åŠŸèƒ½(Stringçš„replaceæ–¹æ³•)
4.ä¼˜ç¼ºç‚¹ï¼š
ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œç¼“å­˜å‹å¥½
ç¼ºç‚¹ï¼šé¢‘ç¹æ‹¼æ¥å’Œä¿®æ”¹ä¼šæµªè´¹èµ„æº
3. Exceptionå’ŒErroråŒºåˆ«?
1.Exceptionå’ŒErrorå®šä¹‰åŒºåˆ«ï¼šExceptionæ˜¯å¯å¤„ç†ç¨‹åºå¼‚å¸¸ï¼ŒErroræ˜¯ç³»ç»Ÿçº§ä¸å¯å›å¤é”™è¯¯
2.try-catchå»ºè®®ï¼š
1.èŒƒå›´èƒ½å°åˆ™å°
2.Exceptionæœ€å¥½è¦å†™æ¸…æ¥šå…·ä½“æ˜¯å“ªä¸€ä¸ªException(IOException)
3.nullå€¼ç­‰èƒ½ç”¨ifåˆ¤æ–­çš„ï¼Œä¸è¦ç”¨try-catch,å› ä¸ºå¼‚å¸¸æ¯”æ¡ä»¶è¯­å¥ä½æ•ˆ
4.finallyä¸è¦ç›´æ¥returnå’Œå¤„ç†è¿”å›å€¼

4. Java ä¸­çš„ hashCode å’Œ equals æ–¹æ³•ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ
1ã€equals() å’Œ hashCode() çš„å…³ç³»

å¦‚æœä¸¤ä¸ªå¯¹è±¡euqals() ä¸º trueï¼Œ åˆ™å…¶ hashCode()ä¸€å®šç›¸åŒ
å¦‚æœä¸¤ä¸ªå¯¹è±¡hashCode() ç›¸åŒï¼Œå…¶equals()ç»“æœä¸ä¸€å®šä¸ºtrue

2ã€ä¸ºä»€ä¹ˆé‡å†™equals()ä¹‹åï¼Œä¸€å®šè¦é‡å†™hashCode()
å½“é‡å†™equals() ä¹‹åï¼Œé€šå¸¸æ˜¯é‡æ–°å®šä¹‰äº†ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰çš„é€»è¾‘ã€‚å¦‚æœä¸é‡å†™hashCode()æ–¹æ³•ï¼Œ åˆ™åœ¨æ•£åˆ—é›†åˆï¼ˆHashMap å’Œ HashSetï¼‰ä¸­ï¼Œå¯èƒ½æ— æ³•æ­£ç¡®å­˜å‚¨å’Œæ£€ç´¢ï¼Œå› ä¸ºä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡å¯èƒ½æœ‰ä¸åŒçš„hashå€¼ã€‚

ä¾‹å¦‚ï¼Œä¸‹æ–¹Personç±»é‡å†™äº†equals() æ–¹æ³•ï¼Œä½†æ˜¯æ²¡æœ‰é‡æ–°hashCode()
public class Person {
private String name;
private int age;

@Override
public boolean equals(Object obj) {
  if (this == obj) return true;
  if (obj == null || getClass() != obj.getClass()) return false;
  Person person = (Person) obj;
  return age == person.age &amp;&amp; Objects.equals(name, person.name);
}
}
åˆ›å»ºç›¸åŒçš„å¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ°HashSetä¸­">
<meta name="author" content="SwimmingLiu">
<link rel="canonical" href="https://swimmingliu.cn/posts/job/java-basic-interview-questions/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6ecbb0040febd20e47edd88a662c19f1ea945bf7427774b86594271d18f88faf.css" integrity="sha256-bsuwBA/r0g5H7diKZiwZ8eqUW/dCd3S4ZZQnHRj4j68=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="apple-touch-icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="mask-icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://swimmingliu.cn/posts/job/java-basic-interview-questions/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            
            
            delimiters: [
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false },
                { left: '\\(', right: '\\)', display: false },
                { left: '\\[', right: '\\]', display: true }
            ],
            
            throwOnError: false
        });
    });
</script>

<meta property="og:url" content="https://swimmingliu.cn/posts/job/java-basic-interview-questions/">
  <meta property="og:site_name" content="SwimmingLiu&#39;s Blog">
  <meta property="og:title" content="JavaåŸºç¡€é¢˜é¢è¯•ç¬”è®°">
  <meta property="og:description" content="1. åºåˆ—åŒ–å’Œååºåˆ—åŒ– 1.åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼šæŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµï¼Œç”¨äºå­˜å‚¨å’Œä¼ è¾“ï¼›è¯»å–å­—èŠ‚æµæ•°æ®ï¼Œé‡æ–°åˆ›å»ºå¯¹è±¡ã€‚ 2.åºåˆ—åŒ–ä¸åŒ…æ‹¬é™æ€å¯¹è±¡ï¼šåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æœ¬è´¨æ˜¯è°ƒç”¨å¯¹è±¡çš„writeObjectå’ŒreadObjectæ–¹æ³•,æ¥å®ç°å°†å¯¹è±¡å†™å…¥è¾“å‡ºæµå’Œè¯»å–è¾“å…¥æµã€‚ä½†æ˜¯ï¼Œé™æ€å˜é‡ä¸å±äºå¯¹è±¡ï¼Œæ‰€ä»¥è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•å°±æ²¡æ³•å„¿è®©é™æ€å˜é‡å‚ä¸ã€‚
2. ä»€ä¹ˆæ˜¯ä¸å¯å˜ç±»ï¼Ÿ 1.ä¸å¯å˜ç±»ï¼šåˆå§‹åŒ–ä¹‹åï¼Œå°±ä¸èƒ½ä¿®æ”¹çš„ç±»ã€‚ 2.ä¿®é¥°æ–¹æ³•ï¼šfinal å’Œ private ä¿®é¥°æ‰€æœ‰ç±»å’Œå˜é‡ 3.ä¸å¯ä¿®æ”¹ï¼šä¸æš´éœ²setæ–¹æ³•ï¼Œåªèƒ½é€šè¿‡é‡æ–°åˆ›å»ºå¯¹è±¡æ›¿ä»£ä¿®æ”¹åŠŸèƒ½(Stringçš„replaceæ–¹æ³•) 4.ä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œç¼“å­˜å‹å¥½ ç¼ºç‚¹ï¼šé¢‘ç¹æ‹¼æ¥å’Œä¿®æ”¹ä¼šæµªè´¹èµ„æº
3. Exceptionå’ŒErroråŒºåˆ«? 1.Exceptionå’ŒErrorå®šä¹‰åŒºåˆ«ï¼šExceptionæ˜¯å¯å¤„ç†ç¨‹åºå¼‚å¸¸ï¼ŒErroræ˜¯ç³»ç»Ÿçº§ä¸å¯å›å¤é”™è¯¯ 2.try-catchå»ºè®®ï¼š 1.èŒƒå›´èƒ½å°åˆ™å° 2.Exceptionæœ€å¥½è¦å†™æ¸…æ¥šå…·ä½“æ˜¯å“ªä¸€ä¸ªException(IOException) 3.nullå€¼ç­‰èƒ½ç”¨ifåˆ¤æ–­çš„ï¼Œä¸è¦ç”¨try-catch,å› ä¸ºå¼‚å¸¸æ¯”æ¡ä»¶è¯­å¥ä½æ•ˆ 4.finallyä¸è¦ç›´æ¥returnå’Œå¤„ç†è¿”å›å€¼
4. Java ä¸­çš„ hashCode å’Œ equals æ–¹æ³•ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ 1ã€equals() å’Œ hashCode() çš„å…³ç³»
å¦‚æœä¸¤ä¸ªå¯¹è±¡euqals() ä¸º trueï¼Œ åˆ™å…¶ hashCode()ä¸€å®šç›¸åŒ å¦‚æœä¸¤ä¸ªå¯¹è±¡hashCode() ç›¸åŒï¼Œå…¶equals()ç»“æœä¸ä¸€å®šä¸ºtrue 2ã€ä¸ºä»€ä¹ˆé‡å†™equals()ä¹‹åï¼Œä¸€å®šè¦é‡å†™hashCode()
å½“é‡å†™equals() ä¹‹åï¼Œé€šå¸¸æ˜¯é‡æ–°å®šä¹‰äº†ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰çš„é€»è¾‘ã€‚å¦‚æœä¸é‡å†™hashCode()æ–¹æ³•ï¼Œ åˆ™åœ¨æ•£åˆ—é›†åˆï¼ˆHashMap å’Œ HashSetï¼‰ä¸­ï¼Œå¯èƒ½æ— æ³•æ­£ç¡®å­˜å‚¨å’Œæ£€ç´¢ï¼Œå› ä¸ºä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡å¯èƒ½æœ‰ä¸åŒçš„hashå€¼ã€‚
ä¾‹å¦‚ï¼Œä¸‹æ–¹Personç±»é‡å†™äº†equals() æ–¹æ³•ï¼Œä½†æ˜¯æ²¡æœ‰é‡æ–°hashCode()
public class Person { private String name; private int age; @Override public boolean equals(Object obj) { if (this == obj) return true; if (obj == null || getClass() != obj.getClass()) return false; Person person = (Person) obj; return age == person.age &amp;&amp; Objects.equals(name, person.name); } } åˆ›å»ºç›¸åŒçš„å¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ°HashSetä¸­">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-02-19T15:18:58+08:00">
    <meta property="article:modified_time" content="2025-02-19T15:18:58+08:00">
    <meta property="article:tag" content="Java">
      <meta property="og:image" content="https://swimmingliu.cn/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://swimmingliu.cn/papermod-cover.png">
<meta name="twitter:title" content="JavaåŸºç¡€é¢˜é¢è¯•ç¬”è®°">
<meta name="twitter:description" content="1. åºåˆ—åŒ–å’Œååºåˆ—åŒ–
1.åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼šæŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµï¼Œç”¨äºå­˜å‚¨å’Œä¼ è¾“ï¼›è¯»å–å­—èŠ‚æµæ•°æ®ï¼Œé‡æ–°åˆ›å»ºå¯¹è±¡ã€‚
2.åºåˆ—åŒ–ä¸åŒ…æ‹¬é™æ€å¯¹è±¡ï¼šåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æœ¬è´¨æ˜¯è°ƒç”¨å¯¹è±¡çš„writeObjectå’ŒreadObjectæ–¹æ³•,æ¥å®ç°å°†å¯¹è±¡å†™å…¥è¾“å‡ºæµå’Œè¯»å–è¾“å…¥æµã€‚ä½†æ˜¯ï¼Œé™æ€å˜é‡ä¸å±äºå¯¹è±¡ï¼Œæ‰€ä»¥è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•å°±æ²¡æ³•å„¿è®©é™æ€å˜é‡å‚ä¸ã€‚
2. ä»€ä¹ˆæ˜¯ä¸å¯å˜ç±»ï¼Ÿ
1.ä¸å¯å˜ç±»ï¼šåˆå§‹åŒ–ä¹‹åï¼Œå°±ä¸èƒ½ä¿®æ”¹çš„ç±»ã€‚
2.ä¿®é¥°æ–¹æ³•ï¼šfinal å’Œ private ä¿®é¥°æ‰€æœ‰ç±»å’Œå˜é‡
3.ä¸å¯ä¿®æ”¹ï¼šä¸æš´éœ²setæ–¹æ³•ï¼Œåªèƒ½é€šè¿‡é‡æ–°åˆ›å»ºå¯¹è±¡æ›¿ä»£ä¿®æ”¹åŠŸèƒ½(Stringçš„replaceæ–¹æ³•)
4.ä¼˜ç¼ºç‚¹ï¼š
ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œç¼“å­˜å‹å¥½
ç¼ºç‚¹ï¼šé¢‘ç¹æ‹¼æ¥å’Œä¿®æ”¹ä¼šæµªè´¹èµ„æº
3. Exceptionå’ŒErroråŒºåˆ«?
1.Exceptionå’ŒErrorå®šä¹‰åŒºåˆ«ï¼šExceptionæ˜¯å¯å¤„ç†ç¨‹åºå¼‚å¸¸ï¼ŒErroræ˜¯ç³»ç»Ÿçº§ä¸å¯å›å¤é”™è¯¯
2.try-catchå»ºè®®ï¼š
1.èŒƒå›´èƒ½å°åˆ™å°
2.Exceptionæœ€å¥½è¦å†™æ¸…æ¥šå…·ä½“æ˜¯å“ªä¸€ä¸ªException(IOException)
3.nullå€¼ç­‰èƒ½ç”¨ifåˆ¤æ–­çš„ï¼Œä¸è¦ç”¨try-catch,å› ä¸ºå¼‚å¸¸æ¯”æ¡ä»¶è¯­å¥ä½æ•ˆ
4.finallyä¸è¦ç›´æ¥returnå’Œå¤„ç†è¿”å›å€¼

4. Java ä¸­çš„ hashCode å’Œ equals æ–¹æ³•ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ
1ã€equals() å’Œ hashCode() çš„å…³ç³»

å¦‚æœä¸¤ä¸ªå¯¹è±¡euqals() ä¸º trueï¼Œ åˆ™å…¶ hashCode()ä¸€å®šç›¸åŒ
å¦‚æœä¸¤ä¸ªå¯¹è±¡hashCode() ç›¸åŒï¼Œå…¶equals()ç»“æœä¸ä¸€å®šä¸ºtrue

2ã€ä¸ºä»€ä¹ˆé‡å†™equals()ä¹‹åï¼Œä¸€å®šè¦é‡å†™hashCode()
å½“é‡å†™equals() ä¹‹åï¼Œé€šå¸¸æ˜¯é‡æ–°å®šä¹‰äº†ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰çš„é€»è¾‘ã€‚å¦‚æœä¸é‡å†™hashCode()æ–¹æ³•ï¼Œ åˆ™åœ¨æ•£åˆ—é›†åˆï¼ˆHashMap å’Œ HashSetï¼‰ä¸­ï¼Œå¯èƒ½æ— æ³•æ­£ç¡®å­˜å‚¨å’Œæ£€ç´¢ï¼Œå› ä¸ºä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡å¯èƒ½æœ‰ä¸åŒçš„hashå€¼ã€‚

ä¾‹å¦‚ï¼Œä¸‹æ–¹Personç±»é‡å†™äº†equals() æ–¹æ³•ï¼Œä½†æ˜¯æ²¡æœ‰é‡æ–°hashCode()
public class Person {
private String name;
private int age;

@Override
public boolean equals(Object obj) {
  if (this == obj) return true;
  if (obj == null || getClass() != obj.getClass()) return false;
  Person person = (Person) obj;
  return age == person.age &amp;&amp; Objects.equals(name, person.name);
}
}
åˆ›å»ºç›¸åŒçš„å¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ°HashSetä¸­">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "ğŸ“š Posts",
      "item": "https://swimmingliu.cn/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ’» Job",
      "item": "https://swimmingliu.cn/posts/job/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "JavaåŸºç¡€é¢˜é¢è¯•ç¬”è®°",
      "item": "https://swimmingliu.cn/posts/job/java-basic-interview-questions/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "JavaåŸºç¡€é¢˜é¢è¯•ç¬”è®°",
  "name": "JavaåŸºç¡€é¢˜é¢è¯•ç¬”è®°",
  "description": "1. åºåˆ—åŒ–å’Œååºåˆ—åŒ– 1.åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼šæŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµï¼Œç”¨äºå­˜å‚¨å’Œä¼ è¾“ï¼›è¯»å–å­—èŠ‚æµæ•°æ®ï¼Œé‡æ–°åˆ›å»ºå¯¹è±¡ã€‚ 2.åºåˆ—åŒ–ä¸åŒ…æ‹¬é™æ€å¯¹è±¡ï¼šåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æœ¬è´¨æ˜¯è°ƒç”¨å¯¹è±¡çš„writeObjectå’ŒreadObjectæ–¹æ³•,æ¥å®ç°å°†å¯¹è±¡å†™å…¥è¾“å‡ºæµå’Œè¯»å–è¾“å…¥æµã€‚ä½†æ˜¯ï¼Œé™æ€å˜é‡ä¸å±äºå¯¹è±¡ï¼Œæ‰€ä»¥è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•å°±æ²¡æ³•å„¿è®©é™æ€å˜é‡å‚ä¸ã€‚\n2. ä»€ä¹ˆæ˜¯ä¸å¯å˜ç±»ï¼Ÿ 1.ä¸å¯å˜ç±»ï¼šåˆå§‹åŒ–ä¹‹åï¼Œå°±ä¸èƒ½ä¿®æ”¹çš„ç±»ã€‚ 2.ä¿®é¥°æ–¹æ³•ï¼šfinal å’Œ private ä¿®é¥°æ‰€æœ‰ç±»å’Œå˜é‡ 3.ä¸å¯ä¿®æ”¹ï¼šä¸æš´éœ²setæ–¹æ³•ï¼Œåªèƒ½é€šè¿‡é‡æ–°åˆ›å»ºå¯¹è±¡æ›¿ä»£ä¿®æ”¹åŠŸèƒ½(Stringçš„replaceæ–¹æ³•) 4.ä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œç¼“å­˜å‹å¥½ ç¼ºç‚¹ï¼šé¢‘ç¹æ‹¼æ¥å’Œä¿®æ”¹ä¼šæµªè´¹èµ„æº\n3. Exceptionå’ŒErroråŒºåˆ«? 1.Exceptionå’ŒErrorå®šä¹‰åŒºåˆ«ï¼šExceptionæ˜¯å¯å¤„ç†ç¨‹åºå¼‚å¸¸ï¼ŒErroræ˜¯ç³»ç»Ÿçº§ä¸å¯å›å¤é”™è¯¯ 2.try-catchå»ºè®®ï¼š 1.èŒƒå›´èƒ½å°åˆ™å° 2.Exceptionæœ€å¥½è¦å†™æ¸…æ¥šå…·ä½“æ˜¯å“ªä¸€ä¸ªException(IOException) 3.nullå€¼ç­‰èƒ½ç”¨ifåˆ¤æ–­çš„ï¼Œä¸è¦ç”¨try-catch,å› ä¸ºå¼‚å¸¸æ¯”æ¡ä»¶è¯­å¥ä½æ•ˆ 4.finallyä¸è¦ç›´æ¥returnå’Œå¤„ç†è¿”å›å€¼\n4. Java ä¸­çš„ hashCode å’Œ equals æ–¹æ³•ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ 1ã€equals() å’Œ hashCode() çš„å…³ç³»\nå¦‚æœä¸¤ä¸ªå¯¹è±¡euqals() ä¸º trueï¼Œ åˆ™å…¶ hashCode()ä¸€å®šç›¸åŒ å¦‚æœä¸¤ä¸ªå¯¹è±¡hashCode() ç›¸åŒï¼Œå…¶equals()ç»“æœä¸ä¸€å®šä¸ºtrue 2ã€ä¸ºä»€ä¹ˆé‡å†™equals()ä¹‹åï¼Œä¸€å®šè¦é‡å†™hashCode()\nå½“é‡å†™equals() ä¹‹åï¼Œé€šå¸¸æ˜¯é‡æ–°å®šä¹‰äº†ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰çš„é€»è¾‘ã€‚å¦‚æœä¸é‡å†™hashCode()æ–¹æ³•ï¼Œ åˆ™åœ¨æ•£åˆ—é›†åˆï¼ˆHashMap å’Œ HashSetï¼‰ä¸­ï¼Œå¯èƒ½æ— æ³•æ­£ç¡®å­˜å‚¨å’Œæ£€ç´¢ï¼Œå› ä¸ºä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡å¯èƒ½æœ‰ä¸åŒçš„hashå€¼ã€‚\nä¾‹å¦‚ï¼Œä¸‹æ–¹Personç±»é‡å†™äº†equals() æ–¹æ³•ï¼Œä½†æ˜¯æ²¡æœ‰é‡æ–°hashCode()\npublic class Person { private String name; private int age; @Override public boolean equals(Object obj) { if (this == obj) return true; if (obj == null || getClass() != obj.getClass()) return false; Person person = (Person) obj; return age == person.age \u0026amp;\u0026amp; Objects.equals(name, person.name); } } åˆ›å»ºç›¸åŒçš„å¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ°HashSetä¸­\n",
  "keywords": [
    "Java"
  ],
  "articleBody": "1. åºåˆ—åŒ–å’Œååºåˆ—åŒ– 1.åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼šæŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµï¼Œç”¨äºå­˜å‚¨å’Œä¼ è¾“ï¼›è¯»å–å­—èŠ‚æµæ•°æ®ï¼Œé‡æ–°åˆ›å»ºå¯¹è±¡ã€‚ 2.åºåˆ—åŒ–ä¸åŒ…æ‹¬é™æ€å¯¹è±¡ï¼šåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æœ¬è´¨æ˜¯è°ƒç”¨å¯¹è±¡çš„writeObjectå’ŒreadObjectæ–¹æ³•,æ¥å®ç°å°†å¯¹è±¡å†™å…¥è¾“å‡ºæµå’Œè¯»å–è¾“å…¥æµã€‚ä½†æ˜¯ï¼Œé™æ€å˜é‡ä¸å±äºå¯¹è±¡ï¼Œæ‰€ä»¥è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•å°±æ²¡æ³•å„¿è®©é™æ€å˜é‡å‚ä¸ã€‚\n2. ä»€ä¹ˆæ˜¯ä¸å¯å˜ç±»ï¼Ÿ 1.ä¸å¯å˜ç±»ï¼šåˆå§‹åŒ–ä¹‹åï¼Œå°±ä¸èƒ½ä¿®æ”¹çš„ç±»ã€‚ 2.ä¿®é¥°æ–¹æ³•ï¼šfinal å’Œ private ä¿®é¥°æ‰€æœ‰ç±»å’Œå˜é‡ 3.ä¸å¯ä¿®æ”¹ï¼šä¸æš´éœ²setæ–¹æ³•ï¼Œåªèƒ½é€šè¿‡é‡æ–°åˆ›å»ºå¯¹è±¡æ›¿ä»£ä¿®æ”¹åŠŸèƒ½(Stringçš„replaceæ–¹æ³•) 4.ä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œç¼“å­˜å‹å¥½ ç¼ºç‚¹ï¼šé¢‘ç¹æ‹¼æ¥å’Œä¿®æ”¹ä¼šæµªè´¹èµ„æº\n3. Exceptionå’ŒErroråŒºåˆ«? 1.Exceptionå’ŒErrorå®šä¹‰åŒºåˆ«ï¼šExceptionæ˜¯å¯å¤„ç†ç¨‹åºå¼‚å¸¸ï¼ŒErroræ˜¯ç³»ç»Ÿçº§ä¸å¯å›å¤é”™è¯¯ 2.try-catchå»ºè®®ï¼š 1.èŒƒå›´èƒ½å°åˆ™å° 2.Exceptionæœ€å¥½è¦å†™æ¸…æ¥šå…·ä½“æ˜¯å“ªä¸€ä¸ªException(IOException) 3.nullå€¼ç­‰èƒ½ç”¨ifåˆ¤æ–­çš„ï¼Œä¸è¦ç”¨try-catch,å› ä¸ºå¼‚å¸¸æ¯”æ¡ä»¶è¯­å¥ä½æ•ˆ 4.finallyä¸è¦ç›´æ¥returnå’Œå¤„ç†è¿”å›å€¼\n4. Java ä¸­çš„ hashCode å’Œ equals æ–¹æ³•ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ 1ã€equals() å’Œ hashCode() çš„å…³ç³»\nå¦‚æœä¸¤ä¸ªå¯¹è±¡euqals() ä¸º trueï¼Œ åˆ™å…¶ hashCode()ä¸€å®šç›¸åŒ å¦‚æœä¸¤ä¸ªå¯¹è±¡hashCode() ç›¸åŒï¼Œå…¶equals()ç»“æœä¸ä¸€å®šä¸ºtrue 2ã€ä¸ºä»€ä¹ˆé‡å†™equals()ä¹‹åï¼Œä¸€å®šè¦é‡å†™hashCode()\nå½“é‡å†™equals() ä¹‹åï¼Œé€šå¸¸æ˜¯é‡æ–°å®šä¹‰äº†ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰çš„é€»è¾‘ã€‚å¦‚æœä¸é‡å†™hashCode()æ–¹æ³•ï¼Œ åˆ™åœ¨æ•£åˆ—é›†åˆï¼ˆHashMap å’Œ HashSetï¼‰ä¸­ï¼Œå¯èƒ½æ— æ³•æ­£ç¡®å­˜å‚¨å’Œæ£€ç´¢ï¼Œå› ä¸ºä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡å¯èƒ½æœ‰ä¸åŒçš„hashå€¼ã€‚\nä¾‹å¦‚ï¼Œä¸‹æ–¹Personç±»é‡å†™äº†equals() æ–¹æ³•ï¼Œä½†æ˜¯æ²¡æœ‰é‡æ–°hashCode()\npublic class Person { private String name; private int age; @Override public boolean equals(Object obj) { if (this == obj) return true; if (obj == null || getClass() != obj.getClass()) return false; Person person = (Person) obj; return age == person.age \u0026\u0026 Objects.equals(name, person.name); } } åˆ›å»ºç›¸åŒçš„å¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ°HashSetä¸­\nPerson p1 = new Person(\"Alice\", 25); Person p2 = new Person(\"Alice\", 25); Set\u003cPerson\u003e set = new HashSet\u003c\u003e(); set.add(p1); set.add(p2); ç”±äºhashCode() æ²¡æœ‰é‡å†™ï¼Œæ‰€æœ‰ä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡å¯èƒ½æœ‰ä¸åŒçš„æ•£åˆ—ç ï¼Œå¯¼è‡´é›†åˆå½“ä¸­æœ‰ä¸¤ä¸ªç›¸åŒçš„å…ƒç´ \nå¦‚ä½•é‡å†™hashCode()?\nåªéœ€è¦è®©å…¶hashå€¼ï¼Œé‡‡ç”¨equals()å½“ä¸­ç›¸åŒçš„åˆ¤æ–­æ¡ä»¶ç”Ÿæˆåˆç†çš„æ•£åˆ—å€¼å³å¯\n@Override public int hashCode() { return Objects.hash(name, age); } 5. æ¥å£å’ŒæŠ½è±¡ç±»æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ ç‰¹æ€§ æ¥å£ æŠ½è±¡ç±» è®¾è®¡è§’åº¦ è‡ªä¸Šè€Œä¸‹ï¼Œå…ˆå®šä¹‰å¥½æˆ‘ä»¬éœ€è¦çš„æ–¹æ³•ï¼Œç„¶ååœ¨å…·ä½“çš„ç±»å½“ä¸­ï¼Œå®ç°è¯¥æ¥å£çš„æ–¹æ³• è‡ªä¸‹è€Œä¸Šï¼Œå†™äº†å¾ˆå¤šç±»ä¹‹åï¼Œå‘ç°ä»–ä»¬æœ‰å…±æ€§ï¼Œå¯ä»¥æŠŠä»£ç å¤ç”¨ã€‚å› æ­¤å°è£…æˆä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå‡å°‘ä»£ç å†—ä½™ æ–¹æ³•å®ç° æ‰€æœ‰æ–¹æ³•é»˜è®¤æ˜¯ public å’Œ abstract ä¿®é¥° (JDK 8 ä¹‹åå¯ä»¥è®¾ç½®defaultæ–¹æ³•æˆ–è€…é™æ€æ–¹æ³•)ï¼Œæ¥å£ç±»å¯ä»¥æ˜¯ç©ºçš„ (Serializable åºåˆ—åŒ–æ¥å£) å¯ä»¥åŒ…å«abstract æŠ½è±¡æ–¹æ³• (æ— å®ç°) å’Œ å…·ä½“æ–¹æ³•(æœ‰å®ç°)ï¼Œè‡³å°‘åŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³• æ„é€ å‡½æ•°å’Œæˆå‘˜å˜é‡ æ¥å£ä¸èƒ½åŒ…å«æ„é€ å‡½æ•°ï¼Œæ‰€æœ‰æˆå‘˜å˜é‡é»˜è®¤ä¸º public static final å¸¸é‡ æŠ½è±¡ç±»å¯ä»¥åŒ…å«æ„é€ å‡½æ•°ï¼Œæˆå‘˜å˜é‡å¯ä»¥æœ‰ä¸åŒçš„ä¿®é¥°ç¬¦ï¼Œä¸ä¸€å®šæ˜¯å¸¸é‡ å¤šç»§æ‰¿ ä¸€ä¸ªç±»åªèƒ½å®ç°å¤šä¸ªæ¥å£ æŠ½è±¡ç±»åªèƒ½å•ç»§æ‰¿ ã€æ³¨æ„ã€‘\næ¥å£å’ŒæŠ½è±¡ç±»æ˜¯ä¸å¯ä»¥è¢«å®ä¾‹åŒ–çš„ï¼Œåªèƒ½ç”¨æ¥å®ç°æˆ–è€…ç»§æ‰¿ã€‚\nJDK 9 ä¹‹åï¼Œæ¥å£å¯ä»¥å®šä¹‰ç§æœ‰æ–¹æ³•ï¼Œç”¨äºdefault æ–¹æ³•çš„å†…éƒ¨é€»è¾‘å¤ç”¨\n// æ”¯ä»˜æ¥å£ interface PaymentInterface { // æ”¯ä»˜æ–¹æ³• void pay(double amount); // é€šçŸ¥æ”¯ä»˜çŠ¶æ€ void notifyPaymentStatus(String status); // ç§æœ‰æ–¹æ³•ï¼Œç”¨äºæ£€æŸ¥æ”¯ä»˜é‡‘é¢æ˜¯å¦åˆæ³• private boolean isAmountValid(double amount) { return amount \u003e 0; } // default æ–¹æ³•ï¼ŒåŒ…å«äº†å¯¹ç§æœ‰æ–¹æ³•çš„è°ƒç”¨ default void performPayment(double amount) { if (isAmountValid(amount)) { pay(amount); } else { System.out.println(\"Invalid payment amount\"); } } } æ¥å£å½“ä¸­çš„ default æ–¹æ³•ï¼Œå®ç°å¯¹è±¡å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œé‡å†™ã€‚static æ–¹æ³•åªèƒ½é€šè¿‡æ¥å£åè°ƒç”¨\n6. JDK åŠ¨æ€ä»£ç†å’Œ CGLIB åŠ¨æ€ä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ JDK åŠ¨æ€ä»£ç†ï¼šåŸºäºåå°„æœºåˆ¶å’Œæ¥å£ï¼Œè¦æ±‚æ‰€æœ‰ä»£ç†ç±»éƒ½å¿…é¡»å®ç°æŸä¸ªæ¥å£ (ç›®æ ‡å¯¹è±¡è‡³å°‘å®ç°ä¸€ä¸ªæ¥å£) CGLIBï¼šåŸºäº ASM å­—èŠ‚ç ç”Ÿæˆå·¥å…·ï¼Œé€šè¿‡ç»§æ‰¿çš„æ–¹å¼ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»æ¥å®ç°ä»£ç†ï¼Œæ‰€ä»¥è¦æ³¨æ„ final æ–¹æ³• ï¼ˆå­ç±»å¯ä»¥ç»§æ‰¿å¹¶ä½¿ç”¨çˆ¶ç±»çš„ final æ–¹æ³•ï¼Œä½†ä¸èƒ½é‡å†™ï¼ˆOverrideï¼‰è¯¥æ–¹æ³•ï¼‰ ç‰¹æ€§ JDK åŠ¨æ€ä»£ç† CGLIB åº•å±‚å®ç° æ¥å£ + åå°„ï¼Œé€šè¿‡åå°„è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ¥å£æ–¹æ³• ç”Ÿæˆå­ç±»çš„å­—èŠ‚ç  + é‡å†™è¢«ä»£ç†ç±»çš„æ–¹æ³• ä»£ç†å¯¹è±¡ å¿…é¡»å®ç°æ¥å£ ä¸éœ€è¦å®ç°æ¥å£ æ€§èƒ½ åˆ›å»ºä»£ç†å¼€é”€å°ï¼Œæ–¹æ³•è°ƒç”¨å¼€é”€å¤§ æ–¹æ³•è°ƒç”¨å¼€é”€å°ï¼Œåˆ›å»ºä»£ç†å¼€é”€å¤§ (éœ€è¦ç”Ÿæˆå­ç±»çš„å­—èŠ‚ç ) é™åˆ¶ ä¸èƒ½ä»£ç†æ²¡æœ‰æ¥å£çš„ç±» ä¸èƒ½ä»£ç† final ç±» å’Œ final æ–¹æ³• ä½¿ç”¨åœºæ™¯ éœ€è¦å®ç°æ¥å£çš„ç±» æ²¡æœ‰æ¥å£çš„ç±» Spring AOP é»˜è®¤æ–¹å¼ AOP é»˜è®¤é‡‡ç”¨JDKåŠ¨æ€ä»£ç† ç›®æ ‡ç±»æ²¡æœ‰æ¥å£çš„æ—¶å€™ï¼Œé‡‡ç”¨ CGLIB ã€æ³¨æ„ã€‘åœ¨ä¸åŒçš„jdkç‰ˆæœ¬ä¸‹ï¼ŒJDK åŠ¨æ€ä»£ç† å’Œ CGLIB çš„æ€§èƒ½éƒ½ä¸ä¸€æ · (å¯å‚è€ƒ CGLIBä¸JDKåŠ¨æ€ä»£ç†çš„è¿è¡Œæ€§èƒ½æ¯”è¾ƒ)\nJDK 1.6ï¼šè¿è¡Œæ¬¡æ•°å°‘çš„æƒ…å†µä¸‹ï¼ŒJDKåŠ¨æ€ä»£ç†å’ŒCGLIB åŸºæœ¬æ²¡å·®ï¼Œç”šè‡³JDKåŠ¨æ€ä»£ç†æ›´å¿«ã€‚å½“æ¬¡æ•°å¢åŠ ä¹‹åï¼ŒCGLIB ä¼šç¨å¾®å¿«ä¸€äº› JDK 1.7: åŸºæœ¬éƒ½æ˜¯ JDKåŠ¨æ€ä»£ç†æ¯”è¾ƒå¿«ï¼Œè¿è¡Œæ¬¡æ•°è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ŒJDKåŠ¨æ€ä»£ç†æ¯”CGLIB å¿« 30% å·¦å³ã€‚å½“æ¬¡æ•°å¢åŠ ä¹‹åï¼ŒJDKåŠ¨æ€ä»£ç†æ¯”CGLIB å¿«äº†æ¥è¿‘ä¸€å€ JDK 1.8ï¼šå’Œ JDK 1.7 è¡¨ç°åŸºæœ¬ä¸€è‡´ ã€JDK åŠ¨æ€ä»£ç†è¯¦è§£ã€‘\nJDK åŠ¨æ€ä»£ç†æ˜¯é€šè¿‡åå°„æœºåˆ¶ï¼Œæ¥å®ç°ä»£ç†æ¥å£ä¸­çš„æ–¹æ³•çš„ã€‚é€šè¿‡ java.lang.reflect.Proxy ç±» å’Œ InvocationHandler æ¥å£æ¥å®ç°ä»£ç†ï¼Œ ä»£ç†å¯¹è±¡åªä»£ç†æ¥å£ä¸­çš„æ–¹æ³•ã€‚å½“è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•çš„æ—¶å€™ï¼Œä»£ç†ç±»ä¼šæ‹¦æˆªæ–¹æ³•è°ƒç”¨ï¼Œç„¶åé€šè¿‡ InvocationHandler.invoke() æ–¹æ³•æ‰§è¡Œé¢å¤–çš„é€»è¾‘ã€‚ (AOP åˆ‡é¢ç¼–ç¨‹çš„åŸç†)\nä¾‹å¦‚ï¼Œä¸‹é¢ä»£ç ä¸­ï¼ŒDataQuery æ˜¯æ¥å£ï¼Œ DatabaseDataQuery å®ç°è¯¥æ¥å£ã€‚JDK åŠ¨æ€ä»£ç†è¦æ±‚è¢«ä»£ç†å¯¹è±¡è‡³å°‘å®ç°ä¸€ä¸ªæ¥å£ï¼Œä»¥ä¾¿ä»£ç†ç±»é€šè¿‡æ¥å£æš´éœ²ä»£ç†è¡Œä¸ºã€‚ é€šè¿‡ Proxy.newProxyInstance() åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œéœ€è¦ä¸‰ä¸ªå‚æ•°ï¼š\nç±»åŠ è½½å™¨ï¼šThread.currentThread().getContextClassLoader()ï¼Œ ç”¨äºåŠ è½½ä»£ç†ç±» æ¥å£åˆ—è¡¨ï¼šnew Class[]{xxx.class}ï¼Œ æŒ‡å®šä»£ç†ç±»åº”è¯¥å®ç°çš„æ¥å£, é‡Œé¢å­˜æ”¾æ¥å£çš„ class è°ƒç”¨å¤„ç†å™¨ InvocationHandlerï¼šä»£ç†å¯¹è±¡çš„å®é™…é€»è¾‘æ˜¯ç”¨å®ç°è¿™ä¸ªInvocationHandleræ¥å£çš„ç±»æ¥æ™šæ¥æˆçš„ï¼Œæ¯”å¦‚CacheInvocationHandler æ‹¦æˆªä»£ç†æ–¹æ³•ï¼Œè°ƒç”¨å¹¶æ·»åŠ é¢å¤–é€»è¾‘ã€‚åº•å±‚çš„å®ç°é€»è¾‘å…¶å®å°±æ˜¯åå°„æœºåˆ¶ã€‚ // æ¥å£ public interface DataQuery { String query(String queryKey); String queryAll(String queryKey); } // ç›®æ ‡å®ç°ç±» public class DatabaseDataQuery implements DataQuery { @Override public String query(String queryKey) { // ä»–ä¼šä½¿ç”¨æ•°æ®æºä»æ•°æ®åº“æŸ¥è¯¢æ•°æ®å¾ˆæ…¢ System.out.println(\"æ­£åœ¨ä»æ•°æ®åº“æŸ¥è¯¢æ•°æ®\"); return \"result\"; } @Override public String queryAll(String queryKey) { // ä»–ä¼šä½¿ç”¨æ•°æ®æºä»æ•°æ®åº“æŸ¥è¯¢æ•°æ®å¾ˆæ…¢ System.out.println(\"æ­£åœ¨ä»æ•°æ®åº“æŸ¥è¯¢æ•°æ®\"); return \"all result\"; } } // è°ƒç”¨å¤„ç†å™¨ï¼šç”¨äºæ‹¦æˆªæ–¹æ³• public class CacheInvocationHandler implements InvocationHandler { private HashMap\u003cString,String\u003e cache = new LinkedHashMap\u003c\u003e(256); private DataQuery databaseDataQuery; public CacheInvocationHandler(DatabaseDataQuery databaseDataQuery) { this.databaseDataQuery = databaseDataQuery; } public CacheInvocationHandler() { this.databaseDataQuery = new DatabaseDataQuery(); } @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { // 1ã€åˆ¤æ–­æ˜¯å“ªä¸€ä¸ªæ–¹æ³• String result = null; if(\"query\".equals(method.getName())){ // 2ã€æŸ¥è¯¢ç¼“å­˜ï¼Œå‘½ä¸­ç›´æ¥è¿”å› result = cache.get(args[0].toString()); if(result != null){ System.out.println(\"æ•°æ®ä»ç¼“å­˜é‡è·å–ã€‚\"); return result; } // 3ã€æœªå‘½ä¸­ï¼ŒæŸ¥æ•°æ®åº“ï¼ˆéœ€è¦ä»£ç†å®ä¾‹ï¼‰ result = (String) method.invoke(databaseDataQuery, args); // 4ã€å¦‚æœæŸ¥è¯¢åˆ°äº†,è¿›è¡Œå‘¢ç¼“å­˜ cache.put(args[0].toString(),result); return result; } // å½“å…¶ä»–çš„æ–¹æ³•è¢«è°ƒç”¨ï¼Œä¸å¸Œæœ›è¢«å¹²é¢„ï¼Œç›´æ¥è°ƒç”¨åŸç”Ÿçš„æ–¹æ³• return method.invoke(databaseDataQuery,args); } } // æµ‹è¯•ç±»ï¼šå¦‚ä½•ä½¿ç”¨JDKåŠ¨æ€ä»£ç† public class Main { public static void main(String[] args) { // jdkæä¾›çš„ä»£ç†å®ç°ï¼Œä¸»è¦æ˜¯ä½¿ç”¨Proxyç±»æ¥å®Œæˆ // 1ã€classLoaderï¼šè¢«ä»£ç†ç±»çš„ç±»åŠ è½½å™¨ï¼Œç”¨äºåŠ è½½ä»£ç†ç±» ClassLoader contextClassLoader = Thread.currentThread().getContextClassLoader(); // 2ã€ä»£ç†ç±»éœ€è¦å®ç°çš„æ¥å£æ•°ç»„ Class[] classes = new Class[]{DataQuery.class}; // 3ã€InvocationHandler CacheInvocationHandler cacheInvocationHandler = new CacheInvocationHandler(); DataQuery dataQuery = (DataQuery) Proxy.newProxyInstance(contextClassLoader, classes, cacheInvocationHandler); // äº‹å®ä¸Šè°ƒç”¨queryæ–¹æ³•çš„ä½¿ç”¨ï¼Œä»–æ˜¯è°ƒç”¨äº†invoke String result = dataQuery.query(\"key1\"); System.out.println(result); System.out.println(\"--------------------\"); result = dataQuery.query(\"key1\"); System.out.println(result); System.out.println(\"--------------------\"); result = dataQuery.query(\"key2\"); System.out.println(result); System.out.println(\"++++++++++++++++++++++++++++++++++++\"); // äº‹å®ä¸Šè°ƒç”¨queryAllæ–¹æ³•çš„ä½¿ç”¨ï¼Œä»–æ˜¯è°ƒç”¨äº†invoke result = dataQuery.queryAll(\"key1\"); System.out.println(result); System.out.println(\"--------------------\"); result = dataQuery.queryAll(\"key1\"); System.out.println(result); System.out.println(\"--------------------\"); result = dataQuery.queryAll(\"key2\"); System.out.println(result); System.out.println(\"--------------------\"); } } ã€CGLIB åŠ¨æ€ä»£ç†è¯¦è§£ã€‘\nCGLIB (Code Generation Library) ä»£ç ç”Ÿæˆåº“ æ˜¯åŸºäºå­—èŠ‚ç æ“ä½œçš„ï¼Œå®ƒå¯ä»¥ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»ï¼Œå¹¶ä¸”é‡å†™ç›®æ ‡ç±»çš„æ–¹æ³•æ¥å®ç°ä»£ç†ã€‚é€šè¿‡ç»§æ‰¿æ–¹å¼æ‹¦æˆªæ‰€æœ‰é final æ–¹æ³•çš„è°ƒç”¨ã€‚ CGLIB ä½¿ç”¨çš„æ˜¯ ASM å­—èŠ‚ç ç”Ÿæˆæ¡†æ¶ï¼Œç”Ÿæˆçš„æ˜¯å­—èŠ‚ç çº§åˆ«çš„ä»£ç†ç±»ã€‚æ€§èƒ½ç›¸å¯¹è¾ƒå¥½ï¼Œä½†æ˜¯ç”Ÿæˆä»£ç†ç±»çš„å¼€é”€æ¯” JDK åŠ¨æ€ä»£ç† ç¨å¾®å¤§ä¸€äº›ã€‚\nMain ç±»å½“ä¸­ï¼Œæ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œè¿™å°±æ˜¯ CGLIB çš„ä¼˜åŠ¿ä¹‹ä¸€ï¼Œä¸éœ€è¦å®ç°ä»»ä½•æ¥å£ã€‚ CGLIB é€šè¿‡ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»æ¥å®ç°ä»£ç†ã€‚CGLIB é€šè¿‡ Enhancer ç±»æ¥åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œéœ€è¦é…ç½®çˆ¶ç±»å’Œæ‹¦æˆªå™¨ã€‚\nçˆ¶ç±»ï¼šenhancer.setSuperclass(DatabaseDataQuery.class) ï¼Œé…ç½®ç›®æ ‡ç±»ä½œä¸ºçˆ¶ç±» æ‹¦æˆªå™¨ï¼šenhancer.setCallback(new CacheMethodInterceptor()); ï¼Œé…ç½®æ‹¦æˆªå™¨ï¼Œæ‹¦æˆªæ‰€æœ‰é final æ–¹æ³•çš„è°ƒç”¨ï¼Œå’ŒInvocationHandler å·®ä¸å¤šï¼Œå¯ä»¥æ’å…¥é¢å¤–çš„é€»è¾‘ã€‚ // æ‹¦æˆªå™¨ï¼šç”¨äºæ‹¦æˆªæ–¹æ³• public class CacheMethodInterceptor implements MethodInterceptor { private HashMap\u003cString,String\u003e cache = new HashMap\u003c\u003e(); private DatabaseDataQuery databaseDataQuery; public CacheMethodInterceptor( ) { this.databaseDataQuery = new DatabaseDataQuery(); }; @Override public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable { // 1ã€åˆ¤æ–­æ˜¯å“ªä¸€ä¸ªæ–¹æ³• String result = null; if(\"query\".equals(method.getName())){ // 2ã€æŸ¥è¯¢ç¼“å­˜ï¼Œå‘½ä¸­ç›´æ¥è¿”å› result = cache.get(args[0].toString()); if(result != null){ System.out.println(\"æ•°æ®ä»ç¼“å­˜é‡è·å–ã€‚\"); return result; } // 3ã€æœªå‘½ä¸­ï¼ŒæŸ¥æ•°æ®åº“ï¼ˆéœ€è¦ä»£ç†å®ä¾‹ï¼‰ result = (String) method.invoke(databaseDataQuery, args); // 4ã€å¦‚æœæŸ¥è¯¢åˆ°äº†,è¿›è¡Œå‘¢ç¼“å­˜ cache.put(args[0].toString(),result); return result; } return method.invoke(databaseDataQuery,args); } } // æµ‹è¯•ç±»ï¼šå¦‚ä½•ä½¿ç”¨CGLIBè¿›è¡ŒåŠ¨æ€ä»£ç† public class Main { public static void main(String[] args) { //cglibé€šè¿‡Enhancerå®ç° Enhancer enhancer = new Enhancer(); //è®¾ç½®çˆ¶ç±» enhancer.setSuperclass(DatabaseDataQuery.class); //è®¾ç½®ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œç”¨æ¥æ‹¦æˆªæ–¹æ³• enhancer.setCallback(new CacheMethodInterceptor()); //åˆ›å»ºä»£ç†ç±»ï¼Œå…¶å®å°±æ˜¯ç›®æ ‡ç±»çš„å­ç±» DatabaseDataQuery databaseDataQuery = (DatabaseDataQuery) enhancer.create(); databaseDataQuery.query(\"Key1\"); databaseDataQuery.query(\"Key1\"); databaseDataQuery.query(\"Key2\"); } } 7. ä½ ä½¿ç”¨è¿‡ Java çš„åå°„æœºåˆ¶å—ï¼Ÿå¦‚ä½•åº”ç”¨åå°„ï¼Ÿ åå°„æœºåˆ¶å®šä¹‰ï¼šJava çš„åå°„æœºåˆ¶æ˜¯æŒ‡åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œè·å–ç±»çš„ç»“æ„ä¿¡æ¯ (æ¯”å¦‚æ–¹æ³•ã€å­—æ®µã€æ„å»ºå‡½æ•°) ï¼Œç„¶åè·å–æ“ä½œå¯¹è±¡çš„ä¸€ç§æœºåˆ¶ã€‚åå°„æœºåˆ¶å¯ä»¥åœ¨è¿è¡Œçš„æ—¶å€™ï¼ŒåŠ¨æ€åˆ›å»ºå¯¹è±¡ã€è°ƒç”¨æ–¹æ³•ã€è®¿é—®å­—æ®µï¼Œä¸éœ€è¦åœ¨ç¼–è¯‘çš„æ—¶å€™çŸ¥é“è¿™äº›ä¿¡æ¯ã€‚åå°„çš„æ ¸å¿ƒç±»åŒ…æ‹¬ Classã€Constuctorã€Methodã€Filed\nåå°„æœºåˆ¶ä½œç”¨ï¼š\nåŠ¨æ€è·å–ç±»ä¿¡æ¯ï¼šåŒ…æ‹¬ç±»åã€åŒ…åã€çˆ¶ç±»ç­‰ï¼Œä¸éœ€è¦åœ¨ç¼–è¯‘çš„æ—¶å€™çŸ¥é“ç±»çš„ä¿¡æ¯ åŠ¨æ€åˆ›å»ºå¯¹è±¡ï¼šå¯ä»¥é€šè¿‡ Class ç±»æˆ–è€… Constructor å¯¹è±¡çš„ newInstance() åŠ¨æ€åˆ›å»ºå¯¹è±¡ï¼Œä¸éœ€è¦åœ¨ç¼–è¯‘çš„æ—¶å€™çŸ¥é“å¯¹è±¡çš„ç±»å‹ åŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼šé€šè¿‡ Method ç±»çš„ invoke() æ–¹æ³•å®ç° è®¿é—®å’Œä¿®æ”¹å¯¹è±¡çš„å­—æ®µå€¼ï¼šé€šè¿‡ Filed.set() ç›´æ¥ä¿®æ”¹å¯¹è±¡çš„å€¼ï¼Œå’Œé€šè¿‡SetAccessible(true) ç»•è¿‡è®¿é—®é™åˆ¶ åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯ï¼š ä¸€èˆ¬çš„ä¸šåŠ¡ç¼–ç ç”¨ä¸åˆ°åå°„æœºåˆ¶ï¼Œä½†æ˜¯åœ¨æ¡†æ¶ä¸Šä¼šç”¨åˆ°åå°„æœºåˆ¶ã€‚å› ä¸ºå†™æ¡†æ¶çš„æ—¶å€™ï¼Œå¾ˆå¤šåœºæ™¯æ˜¯å¾ˆçµæ´»çš„ï¼Œä¸èƒ½ç¡®å®šç›®æ ‡å¯¹è±¡çš„ç±»å‹ï¼Œåªèƒ½é€šè¿‡åå°„åŠ¨æ€è·å–å¯¹è±¡ä¿¡æ¯ã€‚æ¯”å¦‚ Spring ä½¿ç”¨åå°„æœºåˆ¶æ¥è¯»å–å’Œè§£æé…ç½®æ–‡ä»¶ï¼Œä»è€Œå®ç° DI ä¾èµ–æ³¨å…¥å’Œ AOP åˆ‡é¢ç¼–ç¨‹ç­‰åŠŸèƒ½ã€‚\nDI ä¾èµ–æ³¨å…¥çš„å…·ä½“å®ç°ï¼Œå‡å¦‚å¯¹æŒ‡å®šç±»åŠ ä¸Š @Service æ³¨è§£ï¼Œä¸‹é¢æ˜¯å…·ä½“çš„å®ç°è¿‡ç¨‹ï¼š\nSpring åœ¨å®¹å™¨å¯åŠ¨åˆå§‹åŒ–çš„æ—¶å€™, å°†æ‰€æœ‰å¸¦æœ‰@Serviceã€@Componentç­‰æ³¨è§£çš„ç±»ï¼Œæ”¾å…¥å®¹å™¨å½“ä¸­ï¼Œæ³¨å†Œä¸ºBean Spring å®¹å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šå°†å¸¦æœ‰@Autowired æ³¨è§£çš„ç±»è¿›è¡Œæ ‡è®°ï¼Œç„¶åä½¿ç”¨åå°„æœºåˆ¶å°†æ‰€æœ‰çš„å­—æ®µã€æ–¹æ³•ã€æ„é€ å™¨è¿›è¡Œæ³¨å…¥ åå°„çš„ä½¿ç”¨æ–¹æ³•ï¼š\nè·å– Class å¯¹è±¡\nClass\u003c?\u003e clazz = Class.forName(\"com.swimmingliu.MyClass\"); // æˆ–è€… Class\u003c?\u003e clazz = MyClass.class; // æˆ–è€… Class\u003c?\u003e clazz = obj.getClass(); åˆ›å»ºå¯¹è±¡ ï¼šä¸€èˆ¬éƒ½é‡‡ç”¨ Constructor æ¥æ„é€ å¯¹è±¡\nObject obj = clazz.newInstance(); // å·²è¿‡æ—¶ Constructor\u003c?\u003e constructor = clazz.getConstructor(); Object obj = constructor.newInstance(); è®¿é—®å­—æ®µï¼šå¯ä»¥è®©ç§æœ‰å¯¹è±¡å¯è§ï¼Œè€Œä¸”èƒ½å¤Ÿè®¾ç½®å®ƒçš„å€¼\nField field = clazz.getField(\"name\"); // å‡è®¾ private String name; field.setAccessible(true); // å…è®¸è®¿é—® private å­—æ®µ Object value = field.get(obj); field.set(obj, newValue); è°ƒç”¨æ–¹æ³•ï¼š\nMethod method = clazz.getMethod(\"myMethod\", String.class); Object result = method.invoke(obj, \"param\"); ",
  "wordCount" : "795",
  "inLanguage": "en",
  "image": "https://swimmingliu.cn/papermod-cover.png","datePublished": "2025-02-19T15:18:58+08:00",
  "dateModified": "2025-02-19T15:18:58+08:00",
  "author":[{
    "@type": "Person",
    "name": "SwimmingLiu"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://swimmingliu.cn/posts/job/java-basic-interview-questions/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "SwimmingLiu's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://swimmingliu.cn/images/swimmingliu_icon.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://swimmingliu.cn/" accesskey="h" title="ğ“¢ğ”€ğ“²ğ“¶ğ“¶ğ“²ğ“·ğ“°ğ“›ğ“²ğ“¾&#39;ğ“¼ ğ“‘ğ“µğ“¸ğ“° (Alt + H)">
                <img src="https://swimmingliu.cn/images/swimmingliu_icon.png" alt="" aria-label="logo"
                    height="30">ğ“¢ğ”€ğ“²ğ“¶ğ“¶ğ“²ğ“·ğ“°ğ“›ğ“²ğ“¾&#39;ğ“¼ ğ“‘ğ“µğ“¸ğ“°</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://swimmingliu.cn/index.html" title="ğŸ¡ Home">
                    <span>ğŸ¡ Home</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/search/" title="ğŸ” Search">
                    <span>ğŸ” Search</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/posts/" title="ğŸ—’ï¸ Posts">
                    <span>ğŸ—’ï¸ Posts</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/archives/" title="ğŸ“ƒ Archive">
                    <span>ğŸ“ƒ Archive</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/tags/" title="ğŸ“‘ Tags">
                    <span>ğŸ“‘ Tags</span>
                </a>
            </li>
            <li>
                <a href="https://bento.me/swimmingliu" title="ğŸ‘¨ğŸ»â€ğŸ“ About Me">
                    <span>ğŸ‘¨ğŸ»â€ğŸ“ About Me</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://www.emojisearch.app/" title="Emoji">
                    <span>Emoji</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://swimmingliu.cn/">Home</a>&nbsp;Â»&nbsp;<a href="https://swimmingliu.cn/posts/">ğŸ“š Posts</a>&nbsp;Â»&nbsp;<a href="https://swimmingliu.cn/posts/job/">ğŸ’» Job</a></div>
    <h1 class="post-title entry-hint-parent">
      JavaåŸºç¡€é¢˜é¢è¯•ç¬”è®°
    </h1>
    <div class="post-meta"><span title='2025-02-19 15:18:58 +0800 CST'>February 19, 2025</span>&nbsp;Â·&nbsp;4 min&nbsp;Â·&nbsp;SwimmingLiu

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#1-%e5%ba%8f%e5%88%97%e5%8c%96%e5%92%8c%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96" aria-label="1. åºåˆ—åŒ–å’Œååºåˆ—åŒ–">1. åºåˆ—åŒ–å’Œååºåˆ—åŒ–</a></li>
                <li>
                    <a href="#2-%e4%bb%80%e4%b9%88%e6%98%af%e4%b8%8d%e5%8f%af%e5%8f%98%e7%b1%bb" aria-label="2. ä»€ä¹ˆæ˜¯ä¸å¯å˜ç±»ï¼Ÿ">2. ä»€ä¹ˆæ˜¯ä¸å¯å˜ç±»ï¼Ÿ</a></li>
                <li>
                    <a href="#3-exception%e5%92%8cerror%e5%8c%ba%e5%88%ab" aria-label="3. Exceptionå’ŒErroråŒºåˆ«?">3. Exceptionå’ŒErroråŒºåˆ«?</a></li>
                <li>
                    <a href="#4-java-%e4%b8%ad%e7%9a%84-hashcode-%e5%92%8c-equals-%e6%96%b9%e6%b3%95%e4%b9%8b%e9%97%b4%e6%9c%89%e4%bb%80%e4%b9%88%e5%85%b3%e7%b3%bb" aria-label="4. Java ä¸­çš„ hashCode å’Œ equals æ–¹æ³•ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ">4. Java ä¸­çš„ hashCode å’Œ equals æ–¹æ³•ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</a></li>
                <li>
                    <a href="#5-%e6%8e%a5%e5%8f%a3%e5%92%8c%e6%8a%bd%e8%b1%a1%e7%b1%bb%e6%9c%89%e4%bb%80%e4%b9%88%e5%8c%ba%e5%88%ab" aria-label="5. æ¥å£å’ŒæŠ½è±¡ç±»æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ">5. æ¥å£å’ŒæŠ½è±¡ç±»æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></li>
                <li>
                    <a href="#6-jdk-%e5%8a%a8%e6%80%81%e4%bb%a3%e7%90%86%e5%92%8c-cglib-%e5%8a%a8%e6%80%81%e4%bb%a3%e7%90%86%e6%9c%89%e4%bb%80%e4%b9%88%e5%8c%ba%e5%88%ab" aria-label="6. JDK åŠ¨æ€ä»£ç†å’Œ CGLIB åŠ¨æ€ä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ">6. JDK åŠ¨æ€ä»£ç†å’Œ CGLIB åŠ¨æ€ä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></li>
                <li>
                    <a href="#7-%e4%bd%a0%e4%bd%bf%e7%94%a8%e8%bf%87-java-%e7%9a%84%e5%8f%8d%e5%b0%84%e6%9c%ba%e5%88%b6%e5%90%97%e5%a6%82%e4%bd%95%e5%ba%94%e7%94%a8%e5%8f%8d%e5%b0%84" aria-label="7. ä½ ä½¿ç”¨è¿‡ Java çš„åå°„æœºåˆ¶å—ï¼Ÿå¦‚ä½•åº”ç”¨åå°„ï¼Ÿ">7. ä½ ä½¿ç”¨è¿‡ Java çš„åå°„æœºåˆ¶å—ï¼Ÿå¦‚ä½•åº”ç”¨åå°„ï¼Ÿ</a>
                </li>
            </ul>
        </div>
    </details>
</div>
  <div class="post-content"><h2 id="1-åºåˆ—åŒ–å’Œååºåˆ—åŒ–">1. åºåˆ—åŒ–å’Œååºåˆ—åŒ–<a hidden class="anchor" aria-hidden="true" href="#1-åºåˆ—åŒ–å’Œååºåˆ—åŒ–">#</a></h2>
<p>1.åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼šæŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµï¼Œç”¨äºå­˜å‚¨å’Œä¼ è¾“ï¼›è¯»å–å­—èŠ‚æµæ•°æ®ï¼Œé‡æ–°åˆ›å»ºå¯¹è±¡ã€‚
2.åºåˆ—åŒ–ä¸åŒ…æ‹¬é™æ€å¯¹è±¡ï¼šåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æœ¬è´¨æ˜¯è°ƒç”¨å¯¹è±¡çš„<code>writeObject</code>å’Œ<code>readObject</code>æ–¹æ³•,æ¥å®ç°å°†å¯¹è±¡å†™å…¥è¾“å‡ºæµå’Œè¯»å–è¾“å…¥æµã€‚ä½†æ˜¯ï¼Œé™æ€å˜é‡ä¸å±äºå¯¹è±¡ï¼Œæ‰€ä»¥è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•å°±æ²¡æ³•å„¿è®©é™æ€å˜é‡å‚ä¸ã€‚</p>
<h2 id="2-ä»€ä¹ˆæ˜¯ä¸å¯å˜ç±»">2. ä»€ä¹ˆæ˜¯ä¸å¯å˜ç±»ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#2-ä»€ä¹ˆæ˜¯ä¸å¯å˜ç±»">#</a></h2>
<p>1.ä¸å¯å˜ç±»ï¼šåˆå§‹åŒ–ä¹‹åï¼Œå°±ä¸èƒ½ä¿®æ”¹çš„ç±»ã€‚
2.ä¿®é¥°æ–¹æ³•ï¼šfinal å’Œ private ä¿®é¥°æ‰€æœ‰ç±»å’Œå˜é‡
3.ä¸å¯ä¿®æ”¹ï¼šä¸æš´éœ²setæ–¹æ³•ï¼Œåªèƒ½é€šè¿‡é‡æ–°åˆ›å»ºå¯¹è±¡æ›¿ä»£ä¿®æ”¹åŠŸèƒ½(<code>String</code>çš„replaceæ–¹æ³•)
4.ä¼˜ç¼ºç‚¹ï¼š
ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œç¼“å­˜å‹å¥½
ç¼ºç‚¹ï¼šé¢‘ç¹æ‹¼æ¥å’Œä¿®æ”¹ä¼šæµªè´¹èµ„æº</p>
<h2 id="3-exceptionå’ŒerroråŒºåˆ«">3. Exceptionå’ŒErroråŒºåˆ«?<a hidden class="anchor" aria-hidden="true" href="#3-exceptionå’ŒerroråŒºåˆ«">#</a></h2>
<p>1.Exceptionå’ŒErrorå®šä¹‰åŒºåˆ«ï¼šExceptionæ˜¯å¯å¤„ç†ç¨‹åºå¼‚å¸¸ï¼ŒErroræ˜¯ç³»ç»Ÿçº§ä¸å¯å›å¤é”™è¯¯
2.try-catchå»ºè®®ï¼š
1.èŒƒå›´èƒ½å°åˆ™å°
2.Exceptionæœ€å¥½è¦å†™æ¸…æ¥šå…·ä½“æ˜¯å“ªä¸€ä¸ªException(IOException)
3.nullå€¼ç­‰èƒ½ç”¨ifåˆ¤æ–­çš„ï¼Œä¸è¦ç”¨try-catch,å› ä¸ºå¼‚å¸¸æ¯”æ¡ä»¶è¯­å¥ä½æ•ˆ
4.finallyä¸è¦ç›´æ¥returnå’Œå¤„ç†è¿”å›å€¼</p>
<p><img alt="Exceptionå’ŒErroråŒºåˆ«" loading="lazy" src="https://oss.swimmingliu.cn/946b73cc-ef5d-11ef-95ab-c858c0c1deba"></p>
<h2 id="4-java-ä¸­çš„-hashcode-å’Œ-equals-æ–¹æ³•ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»">4. Java ä¸­çš„ hashCode å’Œ equals æ–¹æ³•ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#4-java-ä¸­çš„-hashcode-å’Œ-equals-æ–¹æ³•ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»">#</a></h2>
<p>1ã€<code>equals()</code> å’Œ <code>hashCode()</code> çš„å…³ç³»</p>
<ul>
<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡<code>euqals()</code> ä¸º <code>true</code>ï¼Œ åˆ™å…¶ <code>hashCode()</code>ä¸€å®šç›¸åŒ</li>
<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡<code>hashCode()</code> ç›¸åŒï¼Œå…¶<code>equals()</code>ç»“æœä¸ä¸€å®šä¸º<code>true</code></li>
</ul>
<p>2ã€ä¸ºä»€ä¹ˆé‡å†™<code>equals()</code>ä¹‹åï¼Œä¸€å®šè¦é‡å†™<code>hashCode()</code></p>
<p>å½“é‡å†™<code>equals()</code> ä¹‹åï¼Œé€šå¸¸æ˜¯é‡æ–°å®šä¹‰äº†ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰çš„é€»è¾‘ã€‚å¦‚æœä¸é‡å†™<code>hashCode()</code>æ–¹æ³•ï¼Œ åˆ™åœ¨æ•£åˆ—é›†åˆï¼ˆ<code>HashMap</code> å’Œ <code>HashSet</code>ï¼‰ä¸­ï¼Œå¯èƒ½æ— æ³•æ­£ç¡®å­˜å‚¨å’Œæ£€ç´¢ï¼Œå› ä¸ºä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡å¯èƒ½æœ‰ä¸åŒçš„<code>hash</code>å€¼ã€‚</p>
<blockquote>
<p>ä¾‹å¦‚ï¼Œä¸‹æ–¹Personç±»é‡å†™äº†<code>equals()</code> æ–¹æ³•ï¼Œä½†æ˜¯æ²¡æœ‰é‡æ–°<code>hashCode()</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Java" data-lang="Java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Person</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">equals</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">getClass</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="na">getClass</span><span class="p">())</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">Person</span><span class="w"> </span><span class="n">person</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Person</span><span class="p">)</span><span class="w"> </span><span class="n">obj</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="na">age</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">Objects</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="na">name</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>åˆ›å»ºç›¸åŒçš„å¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ°<code>HashSet</code>ä¸­</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Person</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Person</span><span class="p">(</span><span class="s">&#34;Alice&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">25</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Person</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Person</span><span class="p">(</span><span class="s">&#34;Alice&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">25</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashSet</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">set</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">p1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">set</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">p2</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>ç”±äº<code>hashCode</code>() æ²¡æœ‰é‡å†™ï¼Œæ‰€æœ‰ä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡å¯èƒ½æœ‰ä¸åŒçš„æ•£åˆ—ç ï¼Œå¯¼è‡´é›†åˆå½“ä¸­æœ‰ä¸¤ä¸ªç›¸åŒçš„å…ƒç´ </p>
<p>å¦‚ä½•é‡å†™<code>hashCode()</code>?</p>
<p>åªéœ€è¦è®©å…¶hashå€¼ï¼Œé‡‡ç”¨<code>equals()</code>å½“ä¸­ç›¸åŒçš„åˆ¤æ–­æ¡ä»¶ç”Ÿæˆåˆç†çš„æ•£åˆ—å€¼å³å¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">hashCode</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">return</span><span class="w"> </span><span class="n">Objects</span><span class="p">.</span><span class="na">hash</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></blockquote>
<h2 id="5-æ¥å£å’ŒæŠ½è±¡ç±»æœ‰ä»€ä¹ˆåŒºåˆ«">5. æ¥å£å’ŒæŠ½è±¡ç±»æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#5-æ¥å£å’ŒæŠ½è±¡ç±»æœ‰ä»€ä¹ˆåŒºåˆ«">#</a></h2>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>æ¥å£</th>
          <th>æŠ½è±¡ç±»</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>è®¾è®¡è§’åº¦</strong></td>
          <td>è‡ªä¸Šè€Œä¸‹ï¼Œå…ˆå®šä¹‰å¥½æˆ‘ä»¬éœ€è¦çš„æ–¹æ³•ï¼Œç„¶ååœ¨å…·ä½“çš„ç±»å½“ä¸­ï¼Œå®ç°è¯¥æ¥å£çš„æ–¹æ³•</td>
          <td>è‡ªä¸‹è€Œä¸Šï¼Œå†™äº†å¾ˆå¤šç±»ä¹‹åï¼Œå‘ç°ä»–ä»¬æœ‰å…±æ€§ï¼Œå¯ä»¥æŠŠä»£ç å¤ç”¨ã€‚å› æ­¤å°è£…æˆä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå‡å°‘ä»£ç å†—ä½™</td>
      </tr>
      <tr>
          <td><strong>æ–¹æ³•å®ç°</strong></td>
          <td>æ‰€æœ‰æ–¹æ³•é»˜è®¤æ˜¯ <code>public</code> å’Œ <code>abstract</code> ä¿®é¥° (<code>JDK 8</code> ä¹‹åå¯ä»¥è®¾ç½®<code>default</code>æ–¹æ³•æˆ–è€…é™æ€æ–¹æ³•)ï¼Œæ¥å£ç±»å¯ä»¥æ˜¯ç©ºçš„ (<code>Serializable</code> åºåˆ—åŒ–æ¥å£)</td>
          <td>å¯ä»¥åŒ…å«<code>abstract</code> æŠ½è±¡æ–¹æ³• (æ— å®ç°) å’Œ å…·ä½“æ–¹æ³•(æœ‰å®ç°)ï¼Œè‡³å°‘åŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•</td>
      </tr>
      <tr>
          <td><strong>æ„é€ å‡½æ•°å’Œæˆå‘˜å˜é‡</strong></td>
          <td>æ¥å£ä¸èƒ½åŒ…å«æ„é€ å‡½æ•°ï¼Œæ‰€æœ‰æˆå‘˜å˜é‡é»˜è®¤ä¸º <code>public static final</code> å¸¸é‡</td>
          <td>æŠ½è±¡ç±»å¯ä»¥åŒ…å«æ„é€ å‡½æ•°ï¼Œæˆå‘˜å˜é‡å¯ä»¥æœ‰ä¸åŒçš„ä¿®é¥°ç¬¦ï¼Œä¸ä¸€å®šæ˜¯å¸¸é‡</td>
      </tr>
      <tr>
          <td><strong>å¤šç»§æ‰¿</strong></td>
          <td>ä¸€ä¸ªç±»åªèƒ½å®ç°å¤šä¸ªæ¥å£</td>
          <td>æŠ½è±¡ç±»åªèƒ½å•ç»§æ‰¿</td>
      </tr>
  </tbody>
</table>
<p><strong>ã€æ³¨æ„ã€‘</strong></p>
<ol>
<li>
<p>æ¥å£å’ŒæŠ½è±¡ç±»æ˜¯ä¸å¯ä»¥è¢«å®ä¾‹åŒ–çš„ï¼Œåªèƒ½ç”¨æ¥å®ç°æˆ–è€…ç»§æ‰¿ã€‚</p>
</li>
<li>
<p><code>JDK 9</code> ä¹‹åï¼Œæ¥å£å¯ä»¥å®šä¹‰ç§æœ‰æ–¹æ³•ï¼Œç”¨äº<code>default</code> æ–¹æ³•çš„å†…éƒ¨é€»è¾‘å¤ç”¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// æ”¯ä»˜æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">interface</span> <span class="nc">PaymentInterface</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æ”¯ä»˜æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">pay</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">amount</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// é€šçŸ¥æ”¯ä»˜çŠ¶æ€</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">notifyPaymentStatus</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">status</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ç§æœ‰æ–¹æ³•ï¼Œç”¨äºæ£€æŸ¥æ”¯ä»˜é‡‘é¢æ˜¯å¦åˆæ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isAmountValid</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// default æ–¹æ³•ï¼ŒåŒ…å«äº†å¯¹ç§æœ‰æ–¹æ³•çš„è°ƒç”¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">performPayment</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isAmountValid</span><span class="p">(</span><span class="n">amount</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">pay</span><span class="p">(</span><span class="n">amount</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;Invalid payment amount&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>æ¥å£å½“ä¸­çš„ <code>default</code> æ–¹æ³•ï¼Œå®ç°å¯¹è±¡å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œé‡å†™ã€‚<code>static</code> æ–¹æ³•åªèƒ½é€šè¿‡æ¥å£åè°ƒç”¨</p>
</li>
</ol>
<h2 id="6-jdk-åŠ¨æ€ä»£ç†å’Œ-cglib-åŠ¨æ€ä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«">6. JDK åŠ¨æ€ä»£ç†å’Œ CGLIB åŠ¨æ€ä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#6-jdk-åŠ¨æ€ä»£ç†å’Œ-cglib-åŠ¨æ€ä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«">#</a></h2>
<ul>
<li><strong>JDK åŠ¨æ€ä»£ç†</strong>ï¼šåŸºäºåå°„æœºåˆ¶å’Œæ¥å£ï¼Œè¦æ±‚æ‰€æœ‰ä»£ç†ç±»éƒ½å¿…é¡»å®ç°æŸä¸ªæ¥å£ (ç›®æ ‡å¯¹è±¡è‡³å°‘å®ç°ä¸€ä¸ªæ¥å£)</li>
<li><strong>CGLIB</strong>ï¼šåŸºäº <code>ASM</code> å­—èŠ‚ç ç”Ÿæˆå·¥å…·ï¼Œé€šè¿‡ç»§æ‰¿çš„æ–¹å¼ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»æ¥å®ç°ä»£ç†ï¼Œæ‰€ä»¥è¦æ³¨æ„ <code>final</code> æ–¹æ³• ï¼ˆå­ç±»å¯ä»¥ç»§æ‰¿å¹¶ä½¿ç”¨çˆ¶ç±»çš„ <code>final</code> æ–¹æ³•ï¼Œä½†ä¸èƒ½é‡å†™ï¼ˆOverrideï¼‰è¯¥æ–¹æ³•ï¼‰</li>
</ul>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>JDK åŠ¨æ€ä»£ç†</th>
          <th>CGLIB</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>åº•å±‚å®ç°</strong></td>
          <td>æ¥å£ + åå°„ï¼Œé€šè¿‡åå°„è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ¥å£æ–¹æ³•</td>
          <td>ç”Ÿæˆå­ç±»çš„å­—èŠ‚ç  + é‡å†™è¢«ä»£ç†ç±»çš„æ–¹æ³•</td>
      </tr>
      <tr>
          <td><strong>ä»£ç†å¯¹è±¡</strong></td>
          <td>å¿…é¡»å®ç°æ¥å£</td>
          <td>ä¸éœ€è¦å®ç°æ¥å£</td>
      </tr>
      <tr>
          <td><strong>æ€§èƒ½</strong></td>
          <td>åˆ›å»ºä»£ç†å¼€é”€å°ï¼Œæ–¹æ³•è°ƒç”¨å¼€é”€å¤§</td>
          <td>æ–¹æ³•è°ƒç”¨å¼€é”€å°ï¼Œåˆ›å»ºä»£ç†å¼€é”€å¤§ (éœ€è¦ç”Ÿæˆå­ç±»çš„å­—èŠ‚ç )</td>
      </tr>
      <tr>
          <td><strong>é™åˆ¶</strong></td>
          <td>ä¸èƒ½ä»£ç†æ²¡æœ‰æ¥å£çš„ç±»</td>
          <td>ä¸èƒ½ä»£ç† <code>final</code> ç±» å’Œ <code>final</code> æ–¹æ³•</td>
      </tr>
      <tr>
          <td><strong>ä½¿ç”¨åœºæ™¯</strong></td>
          <td>éœ€è¦å®ç°æ¥å£çš„ç±»</td>
          <td>æ²¡æœ‰æ¥å£çš„ç±»</td>
      </tr>
      <tr>
          <td>Spring AOP é»˜è®¤æ–¹å¼</td>
          <td>AOP é»˜è®¤é‡‡ç”¨JDKåŠ¨æ€ä»£ç†</td>
          <td>ç›®æ ‡ç±»æ²¡æœ‰æ¥å£çš„æ—¶å€™ï¼Œé‡‡ç”¨ <code>CGLIB</code></td>
      </tr>
  </tbody>
</table>
<p>ã€æ³¨æ„ã€‘åœ¨ä¸åŒçš„<code>jdk</code>ç‰ˆæœ¬ä¸‹ï¼Œ<code>JDK</code> åŠ¨æ€ä»£ç† å’Œ <code>CGLIB</code> çš„æ€§èƒ½éƒ½ä¸ä¸€æ · (å¯å‚è€ƒ <a href="https://www.cnblogs.com/haiq/p/4304615.html">CGLIBä¸JDKåŠ¨æ€ä»£ç†çš„è¿è¡Œæ€§èƒ½æ¯”è¾ƒ</a>)</p>
<blockquote>
<ul>
<li>JDK 1.6ï¼šè¿è¡Œæ¬¡æ•°å°‘çš„æƒ…å†µä¸‹ï¼Œ<code>JDK</code>åŠ¨æ€ä»£ç†å’Œ<code>CGLIB</code> åŸºæœ¬æ²¡å·®ï¼Œç”šè‡³<code>JDK</code>åŠ¨æ€ä»£ç†æ›´å¿«ã€‚å½“æ¬¡æ•°å¢åŠ ä¹‹åï¼Œ<code>CGLIB</code> ä¼šç¨å¾®å¿«ä¸€äº›</li>
<li>JDK 1.7: åŸºæœ¬éƒ½æ˜¯ <code>JDK</code>åŠ¨æ€ä»£ç†æ¯”è¾ƒå¿«ï¼Œè¿è¡Œæ¬¡æ•°è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œ<code>JDK</code>åŠ¨æ€ä»£ç†æ¯”<code>CGLIB</code> å¿« <code>30%</code> å·¦å³ã€‚å½“æ¬¡æ•°å¢åŠ ä¹‹åï¼Œ<code>JDK</code>åŠ¨æ€ä»£ç†æ¯”<code>CGLIB</code> å¿«äº†æ¥è¿‘ä¸€å€</li>
<li>JDK 1.8ï¼šå’Œ <code>JDK 1.7</code> è¡¨ç°åŸºæœ¬ä¸€è‡´</li>
</ul>
</blockquote>
<p><strong>ã€JDK åŠ¨æ€ä»£ç†è¯¦è§£ã€‘</strong></p>
<p><code>JDK</code> åŠ¨æ€ä»£ç†æ˜¯é€šè¿‡åå°„æœºåˆ¶ï¼Œæ¥å®ç°ä»£ç†æ¥å£ä¸­çš„æ–¹æ³•çš„ã€‚é€šè¿‡ <code>java.lang.reflect.Proxy</code> ç±» å’Œ <code>InvocationHandler</code> æ¥å£æ¥å®ç°ä»£ç†ï¼Œ ä»£ç†å¯¹è±¡åªä»£ç†æ¥å£ä¸­çš„æ–¹æ³•ã€‚å½“è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•çš„æ—¶å€™ï¼Œä»£ç†ç±»ä¼šæ‹¦æˆªæ–¹æ³•è°ƒç”¨ï¼Œç„¶åé€šè¿‡ <code>InvocationHandler.invoke()</code> æ–¹æ³•æ‰§è¡Œé¢å¤–çš„é€»è¾‘ã€‚ (<code>AOP</code> åˆ‡é¢ç¼–ç¨‹çš„åŸç†)</p>
<p><img alt="JDKåŠ¨æ€ä»£ç†ç»“æ„å›¾" loading="lazy" src="https://oss.swimmingliu.cn/bd651ce8-0332-11f0-951a-c858c0c1debd"></p>
<p>ä¾‹å¦‚ï¼Œä¸‹é¢ä»£ç ä¸­ï¼Œ<code>DataQuery</code> æ˜¯æ¥å£ï¼Œ <code>DatabaseDataQuery</code> å®ç°è¯¥æ¥å£ã€‚<code>JDK</code> åŠ¨æ€ä»£ç†è¦æ±‚è¢«ä»£ç†å¯¹è±¡è‡³å°‘å®ç°ä¸€ä¸ªæ¥å£ï¼Œä»¥ä¾¿ä»£ç†ç±»é€šè¿‡æ¥å£æš´éœ²ä»£ç†è¡Œä¸ºã€‚
é€šè¿‡ <code>Proxy.newProxyInstance()</code> åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œéœ€è¦ä¸‰ä¸ªå‚æ•°ï¼š</p>
<ul>
<li><strong>ç±»åŠ è½½å™¨</strong>ï¼š<code>Thread.currentThread().getContextClassLoader()</code>ï¼Œ ç”¨äºåŠ è½½ä»£ç†ç±»</li>
<li><strong>æ¥å£åˆ—è¡¨</strong>ï¼š<code>new Class[]{xxx.class}</code>ï¼Œ æŒ‡å®šä»£ç†ç±»åº”è¯¥å®ç°çš„æ¥å£, é‡Œé¢å­˜æ”¾æ¥å£çš„ <code>class</code></li>
<li><strong>è°ƒç”¨å¤„ç†å™¨</strong> <code>InvocationHandler</code>ï¼šä»£ç†å¯¹è±¡çš„å®é™…é€»è¾‘æ˜¯ç”¨å®ç°è¿™ä¸ª<code>InvocationHandler</code>æ¥å£çš„ç±»æ¥æ™šæ¥æˆçš„ï¼Œæ¯”å¦‚<code>CacheInvocationHandler</code> æ‹¦æˆªä»£ç†æ–¹æ³•ï¼Œè°ƒç”¨å¹¶æ·»åŠ é¢å¤–é€»è¾‘ã€‚åº•å±‚çš„å®ç°é€»è¾‘å…¶å®å°±æ˜¯åå°„æœºåˆ¶ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">DataQuery</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">queryKey</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">queryAll</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">queryKey</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ç›®æ ‡å®ç°ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DatabaseDataQuery</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">DataQuery</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">queryKey</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ä»–ä¼šä½¿ç”¨æ•°æ®æºä»æ•°æ®åº“æŸ¥è¯¢æ•°æ®å¾ˆæ…¢</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ­£åœ¨ä»æ•°æ®åº“æŸ¥è¯¢æ•°æ®&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;result&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">queryAll</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">queryKey</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ä»–ä¼šä½¿ç”¨æ•°æ®æºä»æ•°æ®åº“æŸ¥è¯¢æ•°æ®å¾ˆæ…¢</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ­£åœ¨ä»æ•°æ®åº“æŸ¥è¯¢æ•°æ®&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;all result&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// è°ƒç”¨å¤„ç†å™¨ï¼šç”¨äºæ‹¦æˆªæ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CacheInvocationHandler</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">InvocationHandler</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedHashMap</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">256</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">DataQuery</span><span class="w"> </span><span class="n">databaseDataQuery</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">CacheInvocationHandler</span><span class="p">(</span><span class="n">DatabaseDataQuery</span><span class="w"> </span><span class="n">databaseDataQuery</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">databaseDataQuery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">databaseDataQuery</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">CacheInvocationHandler</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">databaseDataQuery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DatabaseDataQuery</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">proxy</span><span class="p">,</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 1ã€åˆ¤æ–­æ˜¯å“ªä¸€ä¸ªæ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="s">&#34;query&#34;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">method</span><span class="p">.</span><span class="na">getName</span><span class="p">())){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 2ã€æŸ¥è¯¢ç¼“å­˜ï¼Œå‘½ä¸­ç›´æ¥è¿”å›</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cache</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ•°æ®ä»ç¼“å­˜é‡è·å–ã€‚&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 3ã€æœªå‘½ä¸­ï¼ŒæŸ¥æ•°æ®åº“ï¼ˆéœ€è¦ä»£ç†å®ä¾‹ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">databaseDataQuery</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 4ã€å¦‚æœæŸ¥è¯¢åˆ°äº†,è¿›è¡Œå‘¢ç¼“å­˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">cache</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span><span class="n">result</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å½“å…¶ä»–çš„æ–¹æ³•è¢«è°ƒç”¨ï¼Œä¸å¸Œæœ›è¢«å¹²é¢„ï¼Œç›´æ¥è°ƒç”¨åŸç”Ÿçš„æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">databaseDataQuery</span><span class="p">,</span><span class="n">args</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æµ‹è¯•ç±»ï¼šå¦‚ä½•ä½¿ç”¨JDKåŠ¨æ€ä»£ç†</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Main</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// jdkæä¾›çš„ä»£ç†å®ç°ï¼Œä¸»è¦æ˜¯ä½¿ç”¨Proxyç±»æ¥å®Œæˆ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 1ã€classLoaderï¼šè¢«ä»£ç†ç±»çš„ç±»åŠ è½½å™¨ï¼Œç”¨äºåŠ è½½ä»£ç†ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ClassLoader</span><span class="w"> </span><span class="n">contextClassLoader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getContextClassLoader</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 2ã€ä»£ç†ç±»éœ€è¦å®ç°çš„æ¥å£æ•°ç»„</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Class</span><span class="o">[]</span><span class="w"> </span><span class="n">classes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Class</span><span class="o">[]</span><span class="p">{</span><span class="n">DataQuery</span><span class="p">.</span><span class="na">class</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 3ã€InvocationHandler</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">CacheInvocationHandler</span><span class="w"> </span><span class="n">cacheInvocationHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CacheInvocationHandler</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">DataQuery</span><span class="w"> </span><span class="n">dataQuery</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">DataQuery</span><span class="p">)</span><span class="w"> </span><span class="n">Proxy</span><span class="p">.</span><span class="na">newProxyInstance</span><span class="p">(</span><span class="n">contextClassLoader</span><span class="p">,</span><span class="w"> </span><span class="n">classes</span><span class="p">,</span><span class="w"> </span><span class="n">cacheInvocationHandler</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// äº‹å®ä¸Šè°ƒç”¨queryæ–¹æ³•çš„ä½¿ç”¨ï¼Œä»–æ˜¯è°ƒç”¨äº†invoke</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataQuery</span><span class="p">.</span><span class="na">query</span><span class="p">(</span><span class="s">&#34;key1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;--------------------&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataQuery</span><span class="p">.</span><span class="na">query</span><span class="p">(</span><span class="s">&#34;key1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;--------------------&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataQuery</span><span class="p">.</span><span class="na">query</span><span class="p">(</span><span class="s">&#34;key2&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;++++++++++++++++++++++++++++++++++++&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// äº‹å®ä¸Šè°ƒç”¨queryAllæ–¹æ³•çš„ä½¿ç”¨ï¼Œä»–æ˜¯è°ƒç”¨äº†invoke</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataQuery</span><span class="p">.</span><span class="na">queryAll</span><span class="p">(</span><span class="s">&#34;key1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;--------------------&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataQuery</span><span class="p">.</span><span class="na">queryAll</span><span class="p">(</span><span class="s">&#34;key1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;--------------------&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataQuery</span><span class="p">.</span><span class="na">queryAll</span><span class="p">(</span><span class="s">&#34;key2&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;--------------------&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><strong>ã€CGLIB åŠ¨æ€ä»£ç†è¯¦è§£ã€‘</strong></p>
<p><code>CGLIB</code> (Code Generation Library) ä»£ç ç”Ÿæˆåº“ æ˜¯åŸºäºå­—èŠ‚ç æ“ä½œçš„ï¼Œå®ƒå¯ä»¥ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»ï¼Œå¹¶ä¸”é‡å†™ç›®æ ‡ç±»çš„æ–¹æ³•æ¥å®ç°ä»£ç†ã€‚é€šè¿‡ç»§æ‰¿æ–¹å¼æ‹¦æˆªæ‰€æœ‰é <code>final</code> æ–¹æ³•çš„è°ƒç”¨ã€‚ <code>CGLIB</code> ä½¿ç”¨çš„æ˜¯ <code>ASM</code> å­—èŠ‚ç ç”Ÿæˆæ¡†æ¶ï¼Œç”Ÿæˆçš„æ˜¯å­—èŠ‚ç çº§åˆ«çš„ä»£ç†ç±»ã€‚æ€§èƒ½ç›¸å¯¹è¾ƒå¥½ï¼Œä½†æ˜¯ç”Ÿæˆä»£ç†ç±»çš„å¼€é”€æ¯” <code>JDK</code> åŠ¨æ€ä»£ç† ç¨å¾®å¤§ä¸€äº›ã€‚</p>
<p><img alt="CGLIBåŠ¨æ€ä»£ç†ç±»ç»“æ„å›¾" loading="lazy" src="https://oss.swimmingliu.cn/bf8d4fef-0332-11f0-b046-c858c0c1debd"></p>
<p><code>Main</code> ç±»å½“ä¸­ï¼Œæ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œè¿™å°±æ˜¯ <code>CGLIB</code> çš„ä¼˜åŠ¿ä¹‹ä¸€ï¼Œä¸éœ€è¦å®ç°ä»»ä½•æ¥å£ã€‚ <code>CGLIB</code> é€šè¿‡ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»æ¥å®ç°ä»£ç†ã€‚<code>CGLIB</code> é€šè¿‡ <code>Enhancer</code> ç±»æ¥åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œéœ€è¦é…ç½®çˆ¶ç±»å’Œæ‹¦æˆªå™¨ã€‚</p>
<ul>
<li><strong>çˆ¶ç±»</strong>ï¼š<code>enhancer.setSuperclass(DatabaseDataQuery.class)</code> ï¼Œé…ç½®ç›®æ ‡ç±»ä½œä¸ºçˆ¶ç±»</li>
<li><strong>æ‹¦æˆªå™¨</strong>ï¼š<code>enhancer.setCallback(new CacheMethodInterceptor());</code> ï¼Œé…ç½®æ‹¦æˆªå™¨ï¼Œæ‹¦æˆªæ‰€æœ‰é <code>final</code> æ–¹æ³•çš„è°ƒç”¨ï¼Œå’Œ<code>InvocationHandler</code> å·®ä¸å¤šï¼Œå¯ä»¥æ’å…¥é¢å¤–çš„é€»è¾‘ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// æ‹¦æˆªå™¨ï¼šç”¨äºæ‹¦æˆªæ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CacheMethodInterceptor</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">MethodInterceptor</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">DatabaseDataQuery</span><span class="w"> </span><span class="n">databaseDataQuery</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">CacheMethodInterceptor</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">databaseDataQuery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DatabaseDataQuery</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">intercept</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">MethodProxy</span><span class="w"> </span><span class="n">proxy</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 1ã€åˆ¤æ–­æ˜¯å“ªä¸€ä¸ªæ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="s">&#34;query&#34;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">method</span><span class="p">.</span><span class="na">getName</span><span class="p">())){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 2ã€æŸ¥è¯¢ç¼“å­˜ï¼Œå‘½ä¸­ç›´æ¥è¿”å›</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cache</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ•°æ®ä»ç¼“å­˜é‡è·å–ã€‚&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 3ã€æœªå‘½ä¸­ï¼ŒæŸ¥æ•°æ®åº“ï¼ˆéœ€è¦ä»£ç†å®ä¾‹ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">databaseDataQuery</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 4ã€å¦‚æœæŸ¥è¯¢åˆ°äº†,è¿›è¡Œå‘¢ç¼“å­˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">cache</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span><span class="n">result</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">databaseDataQuery</span><span class="p">,</span><span class="n">args</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æµ‹è¯•ç±»ï¼šå¦‚ä½•ä½¿ç”¨CGLIBè¿›è¡ŒåŠ¨æ€ä»£ç†</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Main</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//cglibé€šè¿‡Enhancerå®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Enhancer</span><span class="w"> </span><span class="n">enhancer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Enhancer</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//è®¾ç½®çˆ¶ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">enhancer</span><span class="p">.</span><span class="na">setSuperclass</span><span class="p">(</span><span class="n">DatabaseDataQuery</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//è®¾ç½®ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œç”¨æ¥æ‹¦æˆªæ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">enhancer</span><span class="p">.</span><span class="na">setCallback</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CacheMethodInterceptor</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//åˆ›å»ºä»£ç†ç±»ï¼Œå…¶å®å°±æ˜¯ç›®æ ‡ç±»çš„å­ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">DatabaseDataQuery</span><span class="w"> </span><span class="n">databaseDataQuery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">DatabaseDataQuery</span><span class="p">)</span><span class="w"> </span><span class="n">enhancer</span><span class="p">.</span><span class="na">create</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">databaseDataQuery</span><span class="p">.</span><span class="na">query</span><span class="p">(</span><span class="s">&#34;Key1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">databaseDataQuery</span><span class="p">.</span><span class="na">query</span><span class="p">(</span><span class="s">&#34;Key1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">databaseDataQuery</span><span class="p">.</span><span class="na">query</span><span class="p">(</span><span class="s">&#34;Key2&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="7-ä½ ä½¿ç”¨è¿‡-java-çš„åå°„æœºåˆ¶å—å¦‚ä½•åº”ç”¨åå°„">7. ä½ ä½¿ç”¨è¿‡ Java çš„åå°„æœºåˆ¶å—ï¼Ÿå¦‚ä½•åº”ç”¨åå°„ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#7-ä½ ä½¿ç”¨è¿‡-java-çš„åå°„æœºåˆ¶å—å¦‚ä½•åº”ç”¨åå°„">#</a></h2>
<ul>
<li>
<p><strong>åå°„æœºåˆ¶å®šä¹‰</strong>ï¼šJava çš„åå°„æœºåˆ¶æ˜¯æŒ‡åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œè·å–ç±»çš„ç»“æ„ä¿¡æ¯ (æ¯”å¦‚æ–¹æ³•ã€å­—æ®µã€æ„å»ºå‡½æ•°) ï¼Œç„¶åè·å–æ“ä½œå¯¹è±¡çš„ä¸€ç§æœºåˆ¶ã€‚åå°„æœºåˆ¶å¯ä»¥åœ¨è¿è¡Œçš„æ—¶å€™ï¼ŒåŠ¨æ€åˆ›å»ºå¯¹è±¡ã€è°ƒç”¨æ–¹æ³•ã€è®¿é—®å­—æ®µï¼Œä¸éœ€è¦åœ¨ç¼–è¯‘çš„æ—¶å€™çŸ¥é“è¿™äº›ä¿¡æ¯ã€‚åå°„çš„æ ¸å¿ƒç±»åŒ…æ‹¬ <code>Class</code>ã€<code>Constuctor</code>ã€<code>Method</code>ã€<code>Filed</code></p>
</li>
<li>
<p><strong>åå°„æœºåˆ¶ä½œç”¨</strong>ï¼š</p>
<ul>
<li><strong>åŠ¨æ€è·å–ç±»ä¿¡æ¯</strong>ï¼šåŒ…æ‹¬ç±»åã€åŒ…åã€çˆ¶ç±»ç­‰ï¼Œä¸éœ€è¦åœ¨ç¼–è¯‘çš„æ—¶å€™çŸ¥é“ç±»çš„ä¿¡æ¯</li>
<li><strong>åŠ¨æ€åˆ›å»ºå¯¹è±¡</strong>ï¼šå¯ä»¥é€šè¿‡ <code>Class</code> ç±»æˆ–è€… <code>Constructor</code> å¯¹è±¡çš„ <code>newInstance()</code> åŠ¨æ€åˆ›å»ºå¯¹è±¡ï¼Œä¸éœ€è¦åœ¨ç¼–è¯‘çš„æ—¶å€™çŸ¥é“å¯¹è±¡çš„ç±»å‹</li>
<li><strong>åŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•</strong>ï¼šé€šè¿‡ <code>Method</code> ç±»çš„ <code>invoke()</code> æ–¹æ³•å®ç°</li>
<li><strong>è®¿é—®å’Œä¿®æ”¹å¯¹è±¡çš„å­—æ®µå€¼</strong>ï¼šé€šè¿‡ <code>Filed.set()</code> ç›´æ¥ä¿®æ”¹å¯¹è±¡çš„å€¼ï¼Œå’Œé€šè¿‡<code>SetAccessible(true)</code> ç»•è¿‡è®¿é—®é™åˆ¶</li>
</ul>
</li>
<li>
<p><strong>åå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯</strong>ï¼š ä¸€èˆ¬çš„ä¸šåŠ¡ç¼–ç ç”¨ä¸åˆ°åå°„æœºåˆ¶ï¼Œä½†æ˜¯åœ¨æ¡†æ¶ä¸Šä¼šç”¨åˆ°åå°„æœºåˆ¶ã€‚å› ä¸ºå†™æ¡†æ¶çš„æ—¶å€™ï¼Œå¾ˆå¤šåœºæ™¯æ˜¯å¾ˆçµæ´»çš„ï¼Œä¸èƒ½ç¡®å®šç›®æ ‡å¯¹è±¡çš„ç±»å‹ï¼Œåªèƒ½é€šè¿‡åå°„åŠ¨æ€è·å–å¯¹è±¡ä¿¡æ¯ã€‚æ¯”å¦‚ <code>Spring</code> ä½¿ç”¨åå°„æœºåˆ¶æ¥è¯»å–å’Œè§£æé…ç½®æ–‡ä»¶ï¼Œä»è€Œå®ç° <code>DI</code> ä¾èµ–æ³¨å…¥å’Œ <code>AOP</code> åˆ‡é¢ç¼–ç¨‹ç­‰åŠŸèƒ½ã€‚</p>
<p><code>DI</code> ä¾èµ–æ³¨å…¥çš„å…·ä½“å®ç°ï¼Œå‡å¦‚å¯¹æŒ‡å®šç±»åŠ ä¸Š <code>@Service</code> æ³¨è§£ï¼Œä¸‹é¢æ˜¯å…·ä½“çš„å®ç°è¿‡ç¨‹ï¼š</p>
<ol>
<li><code>Spring</code> åœ¨å®¹å™¨å¯åŠ¨åˆå§‹åŒ–çš„æ—¶å€™, å°†æ‰€æœ‰å¸¦æœ‰<code>@Service</code>ã€<code>@Component</code>ç­‰æ³¨è§£çš„ç±»ï¼Œæ”¾å…¥å®¹å™¨å½“ä¸­ï¼Œæ³¨å†Œä¸º<code>Bean</code></li>
<li><code>Spring</code> å®¹å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šå°†å¸¦æœ‰<code>@Autowired</code> æ³¨è§£çš„ç±»è¿›è¡Œæ ‡è®°ï¼Œç„¶åä½¿ç”¨åå°„æœºåˆ¶å°†æ‰€æœ‰çš„å­—æ®µã€æ–¹æ³•ã€æ„é€ å™¨è¿›è¡Œæ³¨å…¥</li>
</ol>
</li>
<li>
<p><strong>åå°„çš„ä½¿ç”¨æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>
<p><strong>è·å– <code>Class</code> å¯¹è±¡</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">clazz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="s">&#34;com.swimmingliu.MyClass&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æˆ–è€…</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">clazz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyClass</span><span class="p">.</span><span class="na">class</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æˆ–è€…</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">clazz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="na">getClass</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><strong>åˆ›å»ºå¯¹è±¡</strong> ï¼šä¸€èˆ¬éƒ½é‡‡ç”¨ <code>Constructor</code> æ¥æ„é€ å¯¹è±¡</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clazz</span><span class="p">.</span><span class="na">newInstance</span><span class="p">();</span><span class="w"> </span><span class="c1">// å·²è¿‡æ—¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Constructor</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">constructor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clazz</span><span class="p">.</span><span class="na">getConstructor</span><span class="p">();</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">constructor</span><span class="p">.</span><span class="na">newInstance</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><strong>è®¿é—®å­—æ®µ</strong>ï¼šå¯ä»¥è®©ç§æœ‰å¯¹è±¡å¯è§ï¼Œè€Œä¸”èƒ½å¤Ÿè®¾ç½®å®ƒçš„å€¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Field</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clazz</span><span class="p">.</span><span class="na">getField</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">);</span><span class="w"> </span><span class="c1">// å‡è®¾ private String name;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">field</span><span class="p">.</span><span class="na">setAccessible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w"> </span><span class="c1">// å…è®¸è®¿é—® private å­—æ®µ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Object</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">field</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">field</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">newValue</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><strong>è°ƒç”¨æ–¹æ³•</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Method</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clazz</span><span class="p">.</span><span class="na">getMethod</span><span class="p">(</span><span class="s">&#34;myMethod&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Object</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;param&#34;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div></li>
</ul>
</li>
</ul>


  </div>



  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://swimmingliu.cn/tags/java/">Java</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://swimmingliu.cn/posts/job/java-set-interview-questions/">
    <span class="title">Â« Prev</span>
    <br>
    <span>Javaé›†åˆé¢è¯•é¢˜ç¬”è®°</span>
  </a>
  <a class="next" href="https://swimmingliu.cn/posts/job/mysql-interview-questions/">
    <span class="title">Next Â»</span>
    <br>
    <span>MySQLé¢è¯•é¢˜ç¬”è®°</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2023-2025 <a href="https://swimmingliu.cn/">SwimmingLiu&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
    <span>
        <a href="https://beian.miit.gov.cn/">æµ™ICPå¤‡2024056260å·</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
